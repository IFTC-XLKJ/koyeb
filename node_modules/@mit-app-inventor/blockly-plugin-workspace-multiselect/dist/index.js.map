{"version":3,"file":"index.js","mappings":"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","sources":["webpack://@mit-app-inventor/blockly-plugin-workspace-multiselect/webpack/universalModuleDefinition","webpack://@mit-app-inventor/blockly-plugin-workspace-multiselect/./node_modules/dragselect/dist/DragSelect.js","webpack://@mit-app-inventor/blockly-plugin-workspace-multiselect/external umd {\"root\":\"Blockly\",\"commonjs\":\"blockly/core\",\"commonjs2\":\"blockly/core\",\"amd\":\"blockly/core\"}","webpack://@mit-app-inventor/blockly-plugin-workspace-multiselect/webpack/bootstrap","webpack://@mit-app-inventor/blockly-plugin-workspace-multiselect/webpack/runtime/compat get default export","webpack://@mit-app-inventor/blockly-plugin-workspace-multiselect/webpack/runtime/define property getters","webpack://@mit-app-inventor/blockly-plugin-workspace-multiselect/webpack/runtime/hasOwnProperty shorthand","webpack://@mit-app-inventor/blockly-plugin-workspace-multiselect/webpack/runtime/make namespace object","webpack://@mit-app-inventor/blockly-plugin-workspace-multiselect/./src/global.js","webpack://@mit-app-inventor/blockly-plugin-workspace-multiselect/./src/multiselect_draggable.js","webpack://@mit-app-inventor/blockly-plugin-workspace-multiselect/./src/multiselect_contextmenu.js","webpack://@mit-app-inventor/blockly-plugin-workspace-multiselect/./src/multiselect_shortcut.js","webpack://@mit-app-inventor/blockly-plugin-workspace-multiselect/./src/multiselect_controls.js","webpack://@mit-app-inventor/blockly-plugin-workspace-multiselect/./src/multiselect.js"],"sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"blockly/core\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"blockly/core\"], factory);\n\telse {\n\t\tvar a = typeof exports === 'object' ? factory(require(\"blockly/core\")) : factory(root[\"Blockly\"]);\n\t\tfor(var i in a) (typeof exports === 'object' ? exports : root)[i] = a[i];\n\t}\n})(this, (__WEBPACK_EXTERNAL_MODULE__370__) => {\nreturn ","/***\n\n ~~~ Version 2.7.4 ~~~\n\n ******************************************\n\n    ____                   _____      __          __ \n   / __ \\_________ _____ _/ ___/___  / /__  _____/ /_\n  / / / / ___/ __ `/ __ `/\\__ \\/ _ \\/ / _ \\/ ___/ __/\n / /_/ / /  / /_/ / /_/ /___/ /  __/ /  __/ /__/ /_  \n/_____/_/   \\__,_/\\__, //____/\\___/_/\\___/\\___/\\__/  \n               /____/                              \n\n ******************************************\n \n {*} {*} STAR THIS PLUGIN ON GITHUB {*} {*}\n\n https://github.com/ThibaultJanBeyer/DragSelect\n Please give it a like, this is what makes me happy :-)\n Thank You\n\n {*} {*} STAR THIS PLUGIN ON GITHUB {*} {*}\n\n ******************************************\n ********* The MIT License (MIT) **********\n ******************************************\n Created 2017 by ThibaultJanBeyer\n web: http://www.DragSelect.com/\n github: https://github.com/ThibaultJanBeyer/DragSelect\n\n*/\n(function (global, factory) {\n  typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\n  typeof define === 'function' && define.amd ? define(factory) :\n  (global = typeof globalThis !== 'undefined' ? globalThis : global || self, global.DragSelect = factory());\n})(this, (function () { 'use strict';\n\n  function _iterableToArrayLimit(arr, i) {\n    var _i = null == arr ? null : \"undefined\" != typeof Symbol && arr[Symbol.iterator] || arr[\"@@iterator\"];\n    if (null != _i) {\n      var _s,\n        _e,\n        _x,\n        _r,\n        _arr = [],\n        _n = !0,\n        _d = !1;\n      try {\n        if (_x = (_i = _i.call(arr)).next, 0 === i) {\n          if (Object(_i) !== _i) return;\n          _n = !1;\n        } else for (; !(_n = (_s = _x.call(_i)).done) && (_arr.push(_s.value), _arr.length !== i); _n = !0);\n      } catch (err) {\n        _d = !0, _e = err;\n      } finally {\n        try {\n          if (!_n && null != _i.return && (_r = _i.return(), Object(_r) !== _r)) return;\n        } finally {\n          if (_d) throw _e;\n        }\n      }\n      return _arr;\n    }\n  }\n  function ownKeys(object, enumerableOnly) {\n    var keys = Object.keys(object);\n    if (Object.getOwnPropertySymbols) {\n      var symbols = Object.getOwnPropertySymbols(object);\n      enumerableOnly && (symbols = symbols.filter(function (sym) {\n        return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n      })), keys.push.apply(keys, symbols);\n    }\n    return keys;\n  }\n  function _objectSpread2(target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = null != arguments[i] ? arguments[i] : {};\n      i % 2 ? ownKeys(Object(source), !0).forEach(function (key) {\n        _defineProperty(target, key, source[key]);\n      }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) {\n        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n      });\n    }\n    return target;\n  }\n  function _classCallCheck(instance, Constructor) {\n    if (!(instance instanceof Constructor)) {\n      throw new TypeError(\"Cannot call a class as a function\");\n    }\n  }\n  function _defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, _toPropertyKey(descriptor.key), descriptor);\n    }\n  }\n  function _createClass(Constructor, protoProps, staticProps) {\n    if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n    if (staticProps) _defineProperties(Constructor, staticProps);\n    Object.defineProperty(Constructor, \"prototype\", {\n      writable: false\n    });\n    return Constructor;\n  }\n  function _defineProperty(obj, key, value) {\n    key = _toPropertyKey(key);\n    if (key in obj) {\n      Object.defineProperty(obj, key, {\n        value: value,\n        enumerable: true,\n        configurable: true,\n        writable: true\n      });\n    } else {\n      obj[key] = value;\n    }\n    return obj;\n  }\n  function _inherits(subClass, superClass) {\n    if (typeof superClass !== \"function\" && superClass !== null) {\n      throw new TypeError(\"Super expression must either be null or a function\");\n    }\n    subClass.prototype = Object.create(superClass && superClass.prototype, {\n      constructor: {\n        value: subClass,\n        writable: true,\n        configurable: true\n      }\n    });\n    Object.defineProperty(subClass, \"prototype\", {\n      writable: false\n    });\n    if (superClass) _setPrototypeOf(subClass, superClass);\n  }\n  function _getPrototypeOf(o) {\n    _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function _getPrototypeOf(o) {\n      return o.__proto__ || Object.getPrototypeOf(o);\n    };\n    return _getPrototypeOf(o);\n  }\n  function _setPrototypeOf(o, p) {\n    _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) {\n      o.__proto__ = p;\n      return o;\n    };\n    return _setPrototypeOf(o, p);\n  }\n  function _isNativeReflectConstruct() {\n    if (typeof Reflect === \"undefined\" || !Reflect.construct) return false;\n    if (Reflect.construct.sham) return false;\n    if (typeof Proxy === \"function\") return true;\n    try {\n      Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {}));\n      return true;\n    } catch (e) {\n      return false;\n    }\n  }\n  function _construct(Parent, args, Class) {\n    if (_isNativeReflectConstruct()) {\n      _construct = Reflect.construct.bind();\n    } else {\n      _construct = function _construct(Parent, args, Class) {\n        var a = [null];\n        a.push.apply(a, args);\n        var Constructor = Function.bind.apply(Parent, a);\n        var instance = new Constructor();\n        if (Class) _setPrototypeOf(instance, Class.prototype);\n        return instance;\n      };\n    }\n    return _construct.apply(null, arguments);\n  }\n  function _isNativeFunction(fn) {\n    return Function.toString.call(fn).indexOf(\"[native code]\") !== -1;\n  }\n  function _wrapNativeSuper(Class) {\n    var _cache = typeof Map === \"function\" ? new Map() : undefined;\n    _wrapNativeSuper = function _wrapNativeSuper(Class) {\n      if (Class === null || !_isNativeFunction(Class)) return Class;\n      if (typeof Class !== \"function\") {\n        throw new TypeError(\"Super expression must either be null or a function\");\n      }\n      if (typeof _cache !== \"undefined\") {\n        if (_cache.has(Class)) return _cache.get(Class);\n        _cache.set(Class, Wrapper);\n      }\n      function Wrapper() {\n        return _construct(Class, arguments, _getPrototypeOf(this).constructor);\n      }\n      Wrapper.prototype = Object.create(Class.prototype, {\n        constructor: {\n          value: Wrapper,\n          enumerable: false,\n          writable: true,\n          configurable: true\n        }\n      });\n      return _setPrototypeOf(Wrapper, Class);\n    };\n    return _wrapNativeSuper(Class);\n  }\n  function _assertThisInitialized(self) {\n    if (self === void 0) {\n      throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n    }\n    return self;\n  }\n  function _possibleConstructorReturn(self, call) {\n    if (call && (typeof call === \"object\" || typeof call === \"function\")) {\n      return call;\n    } else if (call !== void 0) {\n      throw new TypeError(\"Derived constructors may only return object or undefined\");\n    }\n    return _assertThisInitialized(self);\n  }\n  function _createSuper(Derived) {\n    var hasNativeReflectConstruct = _isNativeReflectConstruct();\n    return function _createSuperInternal() {\n      var Super = _getPrototypeOf(Derived),\n        result;\n      if (hasNativeReflectConstruct) {\n        var NewTarget = _getPrototypeOf(this).constructor;\n        result = Reflect.construct(Super, arguments, NewTarget);\n      } else {\n        result = Super.apply(this, arguments);\n      }\n      return _possibleConstructorReturn(this, result);\n    };\n  }\n  function _superPropBase(object, property) {\n    while (!Object.prototype.hasOwnProperty.call(object, property)) {\n      object = _getPrototypeOf(object);\n      if (object === null) break;\n    }\n    return object;\n  }\n  function _get() {\n    if (typeof Reflect !== \"undefined\" && Reflect.get) {\n      _get = Reflect.get.bind();\n    } else {\n      _get = function _get(target, property, receiver) {\n        var base = _superPropBase(target, property);\n        if (!base) return;\n        var desc = Object.getOwnPropertyDescriptor(base, property);\n        if (desc.get) {\n          return desc.get.call(arguments.length < 3 ? target : receiver);\n        }\n        return desc.value;\n      };\n    }\n    return _get.apply(this, arguments);\n  }\n  function _slicedToArray(arr, i) {\n    return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest();\n  }\n  function _toConsumableArray(arr) {\n    return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread();\n  }\n  function _arrayWithoutHoles(arr) {\n    if (Array.isArray(arr)) return _arrayLikeToArray(arr);\n  }\n  function _arrayWithHoles(arr) {\n    if (Array.isArray(arr)) return arr;\n  }\n  function _iterableToArray(iter) {\n    if (typeof Symbol !== \"undefined\" && iter[Symbol.iterator] != null || iter[\"@@iterator\"] != null) return Array.from(iter);\n  }\n  function _unsupportedIterableToArray(o, minLen) {\n    if (!o) return;\n    if (typeof o === \"string\") return _arrayLikeToArray(o, minLen);\n    var n = Object.prototype.toString.call(o).slice(8, -1);\n    if (n === \"Object\" && o.constructor) n = o.constructor.name;\n    if (n === \"Map\" || n === \"Set\") return Array.from(o);\n    if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);\n  }\n  function _arrayLikeToArray(arr, len) {\n    if (len == null || len > arr.length) len = arr.length;\n    for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n    return arr2;\n  }\n  function _nonIterableSpread() {\n    throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n  }\n  function _nonIterableRest() {\n    throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n  }\n  function _createForOfIteratorHelper(o, allowArrayLike) {\n    var it = typeof Symbol !== \"undefined\" && o[Symbol.iterator] || o[\"@@iterator\"];\n    if (!it) {\n      if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") {\n        if (it) o = it;\n        var i = 0;\n        var F = function () {};\n        return {\n          s: F,\n          n: function () {\n            if (i >= o.length) return {\n              done: true\n            };\n            return {\n              done: false,\n              value: o[i++]\n            };\n          },\n          e: function (e) {\n            throw e;\n          },\n          f: F\n        };\n      }\n      throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n    }\n    var normalCompletion = true,\n      didErr = false,\n      err;\n    return {\n      s: function () {\n        it = it.call(o);\n      },\n      n: function () {\n        var step = it.next();\n        normalCompletion = step.done;\n        return step;\n      },\n      e: function (e) {\n        didErr = true;\n        err = e;\n      },\n      f: function () {\n        try {\n          if (!normalCompletion && it.return != null) it.return();\n        } finally {\n          if (didErr) throw err;\n        }\n      }\n    };\n  }\n  function _toPrimitive(input, hint) {\n    if (typeof input !== \"object\" || input === null) return input;\n    var prim = input[Symbol.toPrimitive];\n    if (prim !== undefined) {\n      var res = prim.call(input, hint || \"default\");\n      if (typeof res !== \"object\") return res;\n      throw new TypeError(\"@@toPrimitive must return a primitive value.\");\n    }\n    return (hint === \"string\" ? String : Number)(input);\n  }\n  function _toPropertyKey(arg) {\n    var key = _toPrimitive(arg, \"string\");\n    return typeof key === \"symbol\" ? key : String(key);\n  }\n\n  /**\n   * The Settings to be passed to the Class\n   * @typedef {Object} Settings\n   * @property {HTMLElement|SVGElement|Document} [area=document] area in which you can drag. If not provided it will be the whole document\n   * @property {DSInputElements} [selectables=[]] the elements that can be selected\n   * @property {number} [autoScrollSpeed=5] Speed in which the area scrolls while selecting (if available). Unit is pixel per movement.\n   * @property {Vect2} [overflowTolerance={x:25,y:25}] Tolerance for autoScroll (how close one has to be near an edges for autoScroll to start)\n   * @property {number} [zoom=1] Zoom scale factor (in case of using CSS style transform: scale() which messes with real positions). Unit scale zoom.\n   * @property {boolean} [customStyles=false] if set to true, no styles (except for position absolute) will be applied by default\n   * @property {boolean} [multiSelectMode=false] Add newly selected elements to the selection instead of replacing them\n   * @property {boolean} [multiSelectToggling=true] Whether or not to toggle already active elements while multi-selecting\n   * @property {DSMultiSelectKeys} [multiSelectKeys=['Control', 'Shift', 'Meta']] Keys that allows switching to the multi-select mode (see the multiSelectMode option). Any key value is possible ([see MDN docs](https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key)). Note that the best support is given for <kbd>Control</kbd>, <kbd>Shift</kbd> and <kbd>Meta</kbd>. Provide an empty array `[]` if you want to turn off the functionality.\n   * @property {HTMLElement} [selector=HTMLElement] the square that will draw the selection\n   * @property {number} [selectionThreshold=0] how much % of the element has to be selected to be considered selected (0 = just touching, 1 = inside the selection)\n   * @property {boolean} [draggability=true] When a user is dragging on an already selected element, the selection is dragged.\n   * @property {boolean} [immediateDrag=true] Whether an element is draggable from the start or needs to be selected first\n   * @property {boolean} [keyboardDrag=true] Whether or not the user can drag with the keyboard (we don't recommend disabling it)\n   * @property {DSDragKeys} [dragKeys={up:['ArrowUp'],down:['ArrowDown'],left:['ArrowLeft'],righ:['ArrowRight']}] The keys available to drag element using the keyboard.\n   * @property {number} [keyboardDragSpeed=10] The speed at which elements are dragged using the keyboard. In pixels per keydown.\n   * @property {boolean} [useTransform=true] Whether to use hardware accelerated css transforms when dragging or top/left instead\n   * @property {number} [refreshMemoryRate=80] Refresh rate on memoization, higher numbers mean better performance but more lag if elements are moving, lower numbers mean less lag but worse performance. If none of your DOMNodes are moving, you can set it to a very high number to increase performance. Value in milliseconds.\n   * @property {DSInputDropZone[]} [dropZones=[]] one or more drop-elements: where the selectables can be dropped into\n   * @property {number} [dropInsideThreshold=1] how much % of the item has to be inside the dropzone to be considered inside (0 = barely touching, 1 = completely inside)\n   * @property {number} [dropTargetThreshold=0] how much % of the zone does the pointer has to be in to be considered a target (0 = anywhere in the zone, max: 0.5 = has to point at the center of the zone)\n   * @property {boolean} [usePointerEvents=false] Whether to use Pointer Events to replace traditional Mouse or Touch Events. Useful for tools like Google Blockly.\n   * @property {string} [hoverClass=ds-hover] the class assigned to the mouse hovered items\n   * @property {string} [selectableClass=ds-selectable] the class assigned to the elements that can be selected\n   * @property {string} [selectedClass=ds-selected] the class assigned to the selected items\n   * @property {string} [selectorClass=ds-selector] the class assigned to the square selector helper\n   * @property {string} [selectorAreaClass=ds-selector-area] the class assigned to the square in which the selector resides. By default it's invisible\n   * @property {string} [droppedTargetClass=ds-dropped-target] on an item corresponding the target dropzone. This is also the prefix for ds-dropped-target-${zone.id}\n   * @property {string} [droppedInsideClass=ds-dropped-inside] on an item that is within its dropzone bounds after a drop. This is also the prefix for ds-dropped-inside-${zone.id}\n   * @property {string} [droppableClass=ds-droppable] on element that can be dropped into at least one container. This is also the prefix for ds-droppable-${zone.id}\n   * @property {string} [dropZoneClass=ds-dropzone] on each dropZone\n   * @property {string} [dropZoneReadyClass=ds-dropzone-ready] on corresponding dropZone when element is dragged\n   * @property {string} [dropZoneTargetClass=ds-dropzone-target] on dropZone that has elements from any successful target drop\n   * @property {string} [dropZoneInsideClass=ds-dropzone-inside] on dropZone that has elements inside after any drop\n   * @property {boolean} [dragAsBlock=false] whether to drag multiple elements as a single block or as individual items\n   */\n\n  /**\n   * The Object that is passed back to any callback method\n   * @typedef {Object} CallbackObject\n   * @property {Array<HTMLElement|SVGElement|any>} [items] The items currently selected\n   * @property {MouseEvent|TouchEvent|PointerEvent|KeyboardEvent|Event} [event] The respective event object\n   * @property {HTMLElement|SVGElement|any} [item] The single item currently interacted with\n   * @property {boolean} [isDragging] Whether the interaction is a drag or a select\n   * @property {boolean} [isDraggingKeyboard] Whether or not the drag interaction is via keyboard\n   * @property {string} [key] Pressed key (lowercase)\n   * @property {Settings} [settings] the settings being updates/manipulated/passed, also holds the previous value. i.e. updating selectorClass will publish { settings: { selectorClass: 'newVal', 'selectorClass:pre': 'oldVal' } }\n   * @property {Array.<'top'|'bottom'|'left'|'right'|undefined>} [scroll_directions]\n   * @property {number} [scroll_multiplier]\n   * @property {DSDropZone} [dropTarget] The dropZone element that the element was dropped into (or the mouse is currently hovering over)\n   */\n  /**\n   * @typedef {function} DSCallback\n   * @param {CallbackObject} data\n   */\n\n  /**\n   * @typedef {Object} DSInputDropZone\n   * @property {string} id can be any unique identifier of type string\n   * @property {DSElement} element is the dropzone itself\n   * @property {DSInputElements} [droppables] the elements that can be dropped into that zone. This is optional, by default it will be all selectables\n   */\n  /**\n   * @typedef {Object} DSDropZone\n   * @property {string} id\n   * @property {DSElement} element\n   * @property {DSElements} droppables\n   * @property {DSElements} [itemsDropped] the items related to the target zone\n   * @property {DSElements} [itemsInside] the items that are within the targets bounds\n   */\n\n  /** @typedef {{x: number, y: number}} Vect2 */\n  /** @typedef {{x:number,y:number,w:number,h:number,r:number,b:number}} DSElementPos */\n  /** @typedef {Array.<'top'|'bottom'|'left'|'right'|undefined>} DSEdges */\n\n  /** @typedef {HTMLElement|SVGElement|Document} DSArea area within which you can drag */\n  /** @typedef {HTMLElement} DSSelectorArea area in which you can drag */\n  /** @typedef {Array.<HTMLElement|SVGElement> | HTMLElement | SVGElement} DSInputElements the elements that can be selected */\n  /** @typedef {Array.<HTMLElement|SVGElement>} DSElements the elements that can be selected */\n  /** @typedef {HTMLElement|SVGElement} DSElement a single element that can be selected */\n  /** @typedef {MouseEvent|TouchEvent|PointerEvent} DSEvent en event from a touch or mouse interaction */\n  /** @typedef {Array.<'Shift'|'Control'|'Meta'|string>} DSMultiSelectKeys An array of keys that allows switching to the multi-select mode */\n\n  /** @typedef {'dragmove'|'autoscroll'|'dragstart'|'elementselect'|'elementunselect'|'callback'} DSEventNames */\n  /** @typedef {'Interaction:init'|'Interaction:start'|'Interaction:end'|'Interaction:update'|'Area:modified'|'Area:scroll'|'PointerStore:updated'|'Selected:added'|'Selected:removed'|'Selectable:click'|'Selectable:added'|'Selectable:removed'|'Selectable:pointer'|'KeyStore:down'|'KeyStore:up'} DSInternalEventNames */\n  /** @typedef {'Interaction:init:pre'|'Interaction:start:pre'|'Interaction:end:pre'|'Interaction:update:pre'|'Area:modified:pre'|'Area:scroll:pre'|'PointerStore:updated:pre'|'Selected:added:pre'|'Selected:removed:pre'|'Selectable:click:pre'|'Selectable:added:pre'|'Selectable:removed:pre'|'Selectable:pointer:pre'|'KeyStore:down:pre'|'KeyStore:up:pre'} DSInternalEventNamesPre */\n  // @todo: update to typescript for complex defs like `Settings:updated:${string}` | `Settings:updated:${string}:pre`\n  /** @typedef {'Settings:updated'|'Settings:updated:pre'|'Settings:updated:*'|'Settings:updated:*:pre'} DSInternalSettingEvents */\n  /** @typedef {DSEventNames|DSInternalEventNames|DSInternalEventNamesPre|DSInternalSettingEvents} DSCallbackNames the name of the callback */\n\n  /** @typedef {{top:number,left:number,bottom:number,right:number,width:number,height:number}} DSBoundingRect */\n  /** @typedef {{up:string[],down:string[],left:string[],right:string[]}} DSDragKeys */\n\n  /**\n   * @callback DSModificationCallback\n   * @param {*} event\n   */\n\n  // @ts-check\n\n  /**\n   * @param {Vect2} v1\n   * @param {'+'|'-'|'*'|'/'} operator\n   * @param {Vect2} v2\n   * @return {Vect2}\n   */\n  var calc = function calc(_ref, operator, _ref2) {\n    var x1 = _ref.x,\n      y1 = _ref.y;\n    var x2 = _ref2.x,\n      y2 = _ref2.y;\n    var calculations = {\n      '+': {\n        x: x1 + x2,\n        y: y1 + y2\n      },\n      '-': {\n        x: x1 - x2,\n        y: y1 - y2\n      },\n      '*': {\n        x: x1 * x2,\n        y: y1 * y2\n      },\n      '/': {\n        x: x1 / x2,\n        y: y1 / y2\n      }\n    };\n    return calculations[operator];\n  };\n\n  /**\n   * @param {{left:number,top:number}} rect\n   * @returns {Vect2}\n   */\n  var rect2vect = function rect2vect(rect) {\n    return {\n      x: rect.left,\n      y: rect.top\n    };\n  };\n  /**\n   * @param {Vect2} vect\n   * @param {number} dimension\n   * @returns {DSBoundingRect}\n   */\n  var vect2rect = function vect2rect(vect) {\n    var dimension = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n    return {\n      left: vect.x,\n      top: vect.y,\n      right: vect.x,\n      bottom: vect.y,\n      width: dimension,\n      height: dimension\n    };\n  };\n  /**\n   * @param {number} n\n   * @returns {Vect2}\n   */\n  var num2vect = function num2vect(n) {\n    return {\n      x: n,\n      y: n\n    };\n  };\n\n  // @ts-check\n\n  /**\n   * Removes event-listeners from the DOMNode\n   * @typedef {()=>void} DSCleanup\n   */\n\n  /**\n   * Adds event-listeners to a DOMNode\n   * @param {DSArea[]} nodes\n   * @param {DSModificationCallback} cb\n   * @return {{observer:MutationObserver,callback:DSModificationCallback,cleanup:DSCleanup}}\n   */\n  var addModificationObservers = (function (nodes, cb) {\n    var callback = cb;\n    window.addEventListener('resize', callback);\n    window.addEventListener('scroll', callback);\n    var observer = new MutationObserver(callback);\n    nodes.forEach(function (el, i) {\n      observer.observe(el, {\n        childList: i !== 0,\n        attributes: true\n      });\n    });\n\n    /**\n     * Removes all observers\n     */\n    var cleanup = function cleanup() {\n      return removeModificationObservers(observer, callback);\n    };\n    return {\n      observer: observer,\n      callback: callback,\n      cleanup: cleanup\n    };\n  });\n\n  // @ts-check\n\n  /**\n   * Checks whether the area can scroll or not\n   * @param {DSArea} area\n   * @return {boolean} scroll X/Y\n   */\n  var canScroll = (function (area) {\n    var scroll = getCurrentScroll(area);\n    if (scroll.x || scroll.y) return true;\n    if (area instanceof Document) {\n      if (area.body) return !!(area.body.scrollTop = 1);\n      return !!(area.documentElement.scrollTop = 1);\n    }\n    return !!(area.scrollTop = 1);\n  });\n\n  // @ts-check\n\n  /**\n   * Creates the SelectorArea\n   * @return {HTMLDivElement}\n   */\n  var createSelectorAreaElement = (function () {\n    var node = document.createElement('div');\n    node.style.position = 'fixed';\n    node.style.overflow = 'hidden';\n    node.style.pointerEvents = 'none';\n    node.style.zIndex = '999999999999999999';\n    return node;\n  });\n\n  // @ts-check\n\n  /**\n   * Create the selector node\n   * @param {boolean} customStyles\n   * @return {HTMLElement}\n   */\n  var createSelectorElement = (function (customStyles) {\n    var selector = document.createElement('div');\n    selector.style.position = 'absolute';\n    if (!customStyles) {\n      selector.style.background = 'rgba(0, 175, 255, 0.2)';\n      selector.style.border = '1px solid rgba(0, 175, 255, 0.8)';\n      selector.style.display = 'none';\n      selector.style.pointerEvents = 'none'; // fix for issue #8 (ie11+)\n    }\n\n    return selector;\n  });\n\n  // @ts-check\n\n  /**\n   * Returns a function, that, as long as it continues to be invoked, will not\n   * be triggered. The function will be called after it stops being called for\n   * `wait` milliseconds. All credits to [Trey Huffine]{@link https://levelup.gitconnected.com/debounce-in-javascript-improve-your-applications-performance-5b01855e086}\n   * @param {*} func\n   * @param {number} wait\n   * @returns {DSModificationCallback}\n   */\n  var debounce = (function (func, wait) {\n    var timeout;\n\n    // This is the function that is returned and will be executed many times\n    // We spread (...args) to capture any number of parameters we want to pass\n    return function () {\n      for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n        args[_key] = arguments[_key];\n      }\n      // The callback function to be executed after\n      // the debounce time has elapsed\n      var later = function later() {\n        // null timeout to indicate the debounce ended\n        timeout = null;\n\n        // Execute the callback\n        func.apply(void 0, args);\n      };\n      // This will reset the waiting every function execution.\n      // This is the step that prevents the function from\n      // being executed because it will never reach the\n      // inside of the previous setTimeout\n      clearTimeout(timeout);\n\n      // Restart the debounce waiting period.\n      // setTimeout returns a truthy value (it differs in web vs Node)\n      timeout = setTimeout(later, wait);\n    };\n  });\n\n  // @ts-check\n  var documentScroll = (function () {\n    var _document$body, _document$documentEle, _document$body2, _document$documentEle2;\n    return {\n      y: ((_document$body = document.body) === null || _document$body === void 0 ? void 0 : _document$body.scrollTop) || ((_document$documentEle = document.documentElement) === null || _document$documentEle === void 0 ? void 0 : _document$documentEle.scrollTop) || 0,\n      x: ((_document$body2 = document.body) === null || _document$body2 === void 0 ? void 0 : _document$body2.scrollLeft) || ((_document$documentEle2 = document.documentElement) === null || _document$documentEle2 === void 0 ? void 0 : _document$documentEle2.scrollLeft) || 0\n    };\n  });\n\n  /**\n   * @param {DSElement|DSArea} node\n   * @returns {DSElements}\n   */\n  var getAllParentNodes = (function (node) {\n    var traverse = function traverse(toWatch) {\n      var _toWatch$index;\n      var index = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n      var parent = (_toWatch$index = toWatch[index]) === null || _toWatch$index === void 0 ? void 0 : _toWatch$index.parentNode;\n      if (parent) {\n        toWatch.push(parent);\n        index++;\n        return traverse(toWatch, index);\n      }\n      return toWatch;\n    };\n    return traverse([node]);\n  });\n\n  // @ts-check\n  /**\n   * Returns the top/left/bottom/right/width/height\n   * values of an area. If area is document then everything\n   * except the sizes will be nulled.\n   * @param {DSArea} area\n   * @param {number} zoom\n   * @returns {DSBoundingRect}\n   */\n  var getAreaRect = (function (area, zoom) {\n    if (area instanceof Document) return {\n      top: 0,\n      left: 0,\n      bottom: 0,\n      right: 0,\n      width: window.innerWidth,\n      height: window.innerHeight\n    };\n    var rect = area.getBoundingClientRect();\n    return {\n      top: rect.top,\n      left: rect.left,\n      bottom: rect.bottom,\n      right: rect.right,\n      width: (area.clientWidth || rect.width) * zoom,\n      height: (area.clientHeight || rect.height) * zoom\n    };\n  });\n\n  // @ts-check\n  /**\n   * Returns the compound bounding rect of multiple elements.\n   * @param {DSElements} elements\n   * @param {SelectableSet} SelectableSet\n   * @returns {DSBoundingRect}\n   */\n  var getBoundingClientRect = (function (elements, SelectableSet) {\n    var rect = {\n      top: Number.POSITIVE_INFINITY,\n      left: Number.POSITIVE_INFINITY,\n      bottom: Number.NEGATIVE_INFINITY,\n      right: Number.NEGATIVE_INFINITY,\n      width: Number.NEGATIVE_INFINITY,\n      height: Number.NEGATIVE_INFINITY\n    };\n    toArray(elements).forEach(function (element) {\n      var elementRect = SelectableSet.getRect(element);\n      rect.top = Math.min(rect.top, elementRect.top);\n      rect.left = Math.min(rect.left, elementRect.left);\n      rect.bottom = Math.max(rect.bottom, elementRect.bottom);\n      rect.right = Math.max(rect.right, elementRect.right);\n    });\n    rect.height = rect.bottom - rect.top;\n    rect.width = rect.right - rect.left;\n    return rect;\n  });\n\n  // @ts-check\n\n  /**\n   * @param {DSArea} [area]\n   * @return {Vect2} scroll X/Y\n   */\n  var getCurrentScroll = (function (area) {\n    if (!area || area instanceof Document) return documentScroll();\n    return {\n      x: area.scrollLeft >= 0 ? area.scrollLeft : documentScroll().x,\n      y: area.scrollTop >= 0 ? area.scrollTop : documentScroll().y\n    };\n  });\n\n  // @ts-check\n\n  /**\n   * Returns the edges that an element is overflowing\n   * @param {Object} p\n   * @param {DSBoundingRect} p.elementRect\n   * @param {DSBoundingRect} p.containerRect\n   * @param {Vect2} [p.tolerance]\n   * @returns {DSEdges}\n   */\n  var getOverflowEdges = (function (_ref) {\n    var elementRect = _ref.elementRect,\n      containerRect = _ref.containerRect,\n      _ref$tolerance = _ref.tolerance,\n      tolerance = _ref$tolerance === void 0 ? {\n        x: 0,\n        y: 0\n      } : _ref$tolerance;\n    var edges = [];\n    if (elementRect.top - tolerance.y < containerRect.top) edges.push('top');\n    if (elementRect.left - tolerance.x < containerRect.left) edges.push('left');\n    if (elementRect.bottom + tolerance.y > containerRect.bottom) edges.push('bottom');\n    if (elementRect.right + tolerance.y > containerRect.right) edges.push('right');\n    return (/** @type {DSEdges} */edges\n    );\n  });\n\n  // @ts-check\n\n  /**\n   * Returns cursor x, y position based on event object\n   * @param {Object} p\n   * @param {MouseEvent|Touch|PointerEvent} p.event\n   * @return {Vect2} cursor X/Y position\n   */\n  var getPointerPos = (function (_ref) {\n    var event = _ref.event;\n    return {\n      x: event.clientX,\n      y: event.clientY\n    };\n  });\n\n  // @ts-check\n  /**\n   * Reliably returns the exact x,y,w,h positions of the selector element\n   * @param {{ scrollAmount:Vect2, initialPointerPos:Vect2, pointerPos:Vect2 }} p\n   * @returns {{left:number,top:number,width:number,height:number}}\n   */\n  var getSelectorPosition = (function (_ref) {\n    var scrollAmount = _ref.scrollAmount,\n      initialPointerPos = _ref.initialPointerPos,\n      pointerPos = _ref.pointerPos;\n    /** check for direction\n     *\n     * This is quite complicated, so also quite complicated to explain. Lemme’ try:\n     *\n     * Problem #1:\n     * Sadly in HTML we can not have negative sizes.\n     * so if we want to scale our element 10px to the right then it is easy,\n     * we just have to add +10px to the width. But if we want to scale the element\n     * -10px to the left then things become more complicated, we have to move\n     * the element -10px to the left on the x axis and also scale the element\n     * by +10px width to fake a negative sizing.\n     *\n     * One solution to this problem is using css-transforms scale() with\n     * transform-origin of top left. BUT we can’t use this since it will size\n     * everything, then when your element has a border for example, the border will\n     * get inanely huge. Also transforms are not widely supported in IE.\n     *\n     * Example #1:\n     * Unfortunately, things get even more complicated when we are inside a scroll-able\n     * DIV. Then, let’s say we scroll to the right by 10px and move the cursor right by 5px in our\n     * checks we have to subtract 10px from the initialcursor position in our check\n     * (since the initial position is moved to the left by 10px) so in our example:\n     * 1. pointerPos.x (5) > initialPointerPos.x (0) - scrollAmount.x (10) === 5 > -10 === true\n     * then set the x position to the cursors start position\n     * selectorPos.x = initialPointerPos.x (0) - scrollAmount.x (10) === 10 // 2.\n     * then we can calculate the elements width, which is\n     * the new cursor position minus the initial one plus the scroll amount, so in our example:\n     * 3. selectorPos.w = pointerPos.x (5) - initialPointerPos.x (0) + scrollAmount.x (10) === 15;\n     *\n     * let’s say after that movement we now scroll 20px to the left and move our cursor by 30px to the left:\n     * 1b. pointerPos.x (-30) > initialPointerPos.x (0) - scrollAmount.x (-20) === -30 < --20 === -30 < +20 === false;\n     * 2b. selectorPos.x = pointerPos.x (-30) === -30; move left position to cursor (for more info see Problem #1)\n     * 3b. selectorPos.w = initialPointerPos.x (0) - pointerPos.x (-30) - scrollAmount.x (-20) === 0--30--20 === 0+30+20 === 50;  // scale width to original left position (for more info see Problem #1)\n     *\n     * same thing has to be done for top/bottom\n     *\n     * I hope that makes sense. Try stuff out and play around with variables to get a hang of it.\n     */\n    var selectorPos = {};\n\n    // right\n    if (pointerPos.x > initialPointerPos.x - scrollAmount.x) {\n      // 1.\n      selectorPos.left = initialPointerPos.x - scrollAmount.x; // 2.\n      selectorPos.width = pointerPos.x - initialPointerPos.x + scrollAmount.x; // 3.\n      // left\n    } else {\n      // 1b.\n      selectorPos.left = pointerPos.x; // 2b.\n      selectorPos.width = initialPointerPos.x - pointerPos.x - scrollAmount.x; // 3b.\n    }\n\n    // bottom\n    if (pointerPos.y > initialPointerPos.y - scrollAmount.y) {\n      selectorPos.top = initialPointerPos.y - scrollAmount.y;\n      selectorPos.height = pointerPos.y - initialPointerPos.y + scrollAmount.y;\n      // top\n    } else {\n      selectorPos.top = pointerPos.y;\n      selectorPos.height = initialPointerPos.y - pointerPos.y - scrollAmount.y;\n    }\n    return selectorPos;\n  });\n\n  // @ts-check\n\n  /**\n   * @param {DSElement} element\n   * @return {Vect2}\n   */\n  var getComputedTranslatePositions = function getComputedTranslatePositions(element) {\n    var position = {\n      x: 0,\n      y: 0\n    };\n    var computed = window.getComputedStyle(element);\n    if (!computed.transform || computed.transform === 'none') return position;\n    if (computed.transform.indexOf('3d') >= 0) {\n      var _match = computed.transform.trim().match(/matrix3d\\((.*?)\\)/);\n      if (_match && _match.length) {\n        var _match$;\n        var values = (_match$ = _match[1]) === null || _match$ === void 0 ? void 0 : _match$.split(',');\n        position.x = parseInt(values[12]) || 0;\n        position.y = parseInt(values[13]) || 0;\n      }\n      return position;\n    }\n    var match = computed.transform.trim().match(/matrix\\((.*?)\\)/);\n    if (match && match.length) {\n      var _match$2;\n      var _values = (_match$2 = match[1]) === null || _match$2 === void 0 ? void 0 : _match$2.split(',');\n      position.x = parseInt(_values[4]) || 0;\n      position.y = parseInt(_values[5]) || 0;\n    }\n    return position;\n  };\n\n  /**\n   * @param {DSElement} element\n   * @return {Vect2}\n   */\n  var getTranslatedPositions = function getTranslatedPositions(element) {\n    var transform = element.style.transform;\n    if (!transform || transform.indexOf('translate') < 0) return getComputedTranslatePositions(element);\n    var position = {\n      x: 0,\n      y: 0\n    };\n    var match = transform.trim().match(/translate[3dD]*?\\(.*?\\)/);\n    if (match) {\n      var _match$3;\n      var split = (_match$3 = match[0]) === null || _match$3 === void 0 ? void 0 : _match$3.split('(');\n      if (split) {\n        var _split$;\n        var values = (_split$ = split[1]) === null || _split$ === void 0 ? void 0 : _split$.split(',');\n        position.x = parseInt(values[0]) || 0;\n        position.y = parseInt(values[1]) || 0;\n      }\n    }\n    if (!position.x && !position.x) return getComputedTranslatePositions(element);\n    return position;\n  };\n\n  /**\n   * @param {DSElement} element\n   * @return {Vect2}\n   */\n  var getTopLeftPosition = function getTopLeftPosition(element) {\n    var style = element.style;\n    var position = {\n      x: parseInt(style.left) || 0,\n      y: parseInt(style.top) || 0\n    };\n\n    // initial positions\n    if (!position.x && !position.x) {\n      var computed = window.getComputedStyle(element);\n      return {\n        x: parseInt(computed.left) || 0,\n        y: parseInt(computed.top) || 0\n      };\n    }\n    return position;\n  };\n\n  /**\n   * Returns the X and Y coordinates based on styles\n   * Can handle translate and top/left\n   * @param {DSElement} element\n   * @param {boolean} [useTranslate]\n   * @return {Vect2}\n   */\n  var getStylePosition = (function (element, useTranslate) {\n    if (useTranslate) return getTranslatedPositions(element);\n    return getTopLeftPosition(element);\n  });\n\n  // @ts-check\n\n  /**\n   * pushes element back the overflow amount\n   * (top - top gives overflow, then new position pushed back by overflow)\n   * @param {Object} p\n   * @param {DSElement} p.element\n   * @param {DSEdges} p.edges\n   * @param {DSBoundingRect} p.elementRect\n   * @param {DSBoundingRect} p.containerRect\n   * @param {Vect2} p.elementPos\n   * @param {boolean} p.useTransform\n   */\n  var handleElementOverflow = (function (_ref) {\n    var element = _ref.element,\n      edges = _ref.edges,\n      elementRect = _ref.elementRect,\n      containerRect = _ref.containerRect,\n      elementPos = _ref.elementPos,\n      useTransform = _ref.useTransform;\n    if (edges.includes('top')) {\n      setStylePosition(element, {\n        y: elementPos.y + containerRect.top - elementRect.top,\n        x: elementPos.x\n      }, useTransform);\n    }\n    if (edges.includes('left')) {\n      setStylePosition(element, {\n        y: elementPos.y,\n        x: elementPos.x + containerRect.left - elementRect.left\n      }, useTransform);\n    }\n    if (edges.includes('bottom')) {\n      setStylePosition(element, {\n        y: elementPos.y + containerRect.bottom - elementRect.bottom,\n        x: elementPos.x\n      }, useTransform);\n    }\n    if (edges.includes('right')) {\n      setStylePosition(element, {\n        y: elementPos.y,\n        x: elementPos.x + containerRect.right - elementRect.right\n      }, useTransform);\n    }\n  });\n\n  // @ts-check\n\n  /**\n   * Fix: some elements have to have a special position attribute for calculations\n   * @param {Object} p\n   * @param {CSSStyleDeclaration} p.computedStyle\n   * @param {DSArea} p.node\n   */\n  var handleElementPositionAttribute = (function (_ref) {\n    var computedStyle = _ref.computedStyle,\n      node = _ref.node;\n    var position = computedStyle.position;\n    var isPositioned = position === 'absolute' || position === 'relative' || position === 'fixed';\n    if (!(node instanceof Document) && !isPositioned) node.style.position = 'relative';\n  });\n\n  // @ts-check\n\n  /**\n   * @typedef {function} ScrollCallback\n   * @property {Array.<'top'|'bottom'|'left'|'right'|undefined>} directions\n   * @property {number} multiplier\n   */\n  /**\n   * @param {Object} p\n   * @param {string} p.key the keyboard key that was pressed\n   * @param {boolean} p.shiftKey\n   * @param {boolean} p.canScroll\n   * @param {number} p.keyboardDragSpeed\n   * @param {number} p.zoom\n   * @param {ScrollCallback} p.scrollCallback\n   * @param {Vect2} p.scrollDiff\n   * @param {DSDragKeys} p.dragKeys\n   * @returns {Vect2}\n   */\n  var handleKeyboardDragPosDifference = (function (_ref) {\n    var shiftKey = _ref.shiftKey,\n      keyboardDragSpeed = _ref.keyboardDragSpeed,\n      zoom = _ref.zoom,\n      key = _ref.key,\n      dragKeys = _ref.dragKeys,\n      scrollDiff = _ref.scrollDiff,\n      canScroll = _ref.canScroll,\n      scrollCallback = _ref.scrollCallback;\n    var posDirection = {\n      x: 0,\n      y: 0\n    };\n    var increase = shiftKey ? keyboardDragSpeed * 4 * zoom : keyboardDragSpeed * zoom;\n    if (dragKeys.left.includes(key)) {\n      posDirection.x = scrollDiff.x || -increase;\n      if (!shiftKey && !scrollDiff.x && canScroll) scrollCallback(['left'], keyboardDragSpeed);\n    }\n    if (dragKeys.right.includes(key)) {\n      posDirection.x = scrollDiff.x || increase;\n      if (!shiftKey && !scrollDiff.x && canScroll) scrollCallback(['right'], keyboardDragSpeed);\n    }\n    if (dragKeys.up.includes(key)) {\n      posDirection.y = scrollDiff.y || -increase;\n      if (!shiftKey && !scrollDiff.y && canScroll) scrollCallback(['top'], keyboardDragSpeed);\n    }\n    if (dragKeys.down.includes(key)) {\n      posDirection.y = scrollDiff.y || increase;\n      if (!shiftKey && !scrollDiff.y && canScroll) scrollCallback(['bottom'], keyboardDragSpeed);\n    }\n    return posDirection;\n  });\n\n  // @ts-check\n\n  /**\n   * Logic when an element is selected\n   * @param {Object} p\n   * @param {DSElement} p.element\n   * @param {boolean} p.force\n   * @param {boolean} p.multiSelectionToggle\n   * @param {Set} p.SelectedSet\n   * @param {string} p.hoverClassName\n   */\n  var handleSelection = (function (_ref) {\n    var element = _ref.element,\n      force = _ref.force,\n      multiSelectionToggle = _ref.multiSelectionToggle,\n      SelectedSet = _ref.SelectedSet,\n      hoverClassName = _ref.hoverClassName;\n    if (element.classList.contains(hoverClassName) && !force) return;\n    if (!SelectedSet.has(element)) SelectedSet.add(element);else if (multiSelectionToggle) SelectedSet[\"delete\"](element);\n    element.classList.add(hoverClassName);\n  });\n\n  // @ts-check\n\n  /**\n   * Logic when an element is de-selected\n   * @param {Object} p\n   * @param {DSElement} p.element\n   * @param {boolean} p.force\n   * @param {Set} p.SelectedSet\n   * @param {Set} p.PrevSelectedSet\n   * @param {string} p.hoverClassName\n   */\n  var handleUnSelection = (function (_ref) {\n    var element = _ref.element,\n      force = _ref.force,\n      SelectedSet = _ref.SelectedSet,\n      PrevSelectedSet = _ref.PrevSelectedSet,\n      hoverClassName = _ref.hoverClassName;\n    if (!element.classList.contains(hoverClassName) && !force) return false;\n    var inSelection = SelectedSet.has(element);\n    var inPrevSelection = PrevSelectedSet.has(element);\n\n    /**\n     * Special for issue #9.\n     * if a multi-select-key is pressed, ds 'remembers' the last selection and reverts\n     * to that state if the selection is not kept, to mimic the natural OS behaviour\n     * = if item was selected and is not in selection anymore, reselect it\n     * = if item was not selected and is not in selection anymore, unselect it\n     */\n    if (inSelection && !inPrevSelection) SelectedSet[\"delete\"](element);else if (!inSelection && inPrevSelection) SelectedSet.add(element);\n    element.classList.remove(hoverClassName);\n  });\n\n  /**\n   * @param {string} key\n   * @param {string} type\n   * @param {*} fallback\n   * @returns {void}\n   */\n  var wrongTypeWarn = function wrongTypeWarn(key, type, fallback) {\n    return console.warn(\"[DragSelect] TypeIssue: setting \\\"\".concat(key, \"\\\" is not of type \\\"\").concat(type, \"\\\".\"));\n  };\n\n  /**\n   * @param {string} key\n   * @param {*} value\n   * @param {boolean} withFallback\n   * @param {*} fallback\n   * @returns {object}\n   */\n  var hydrateHelper = function hydrateHelper(key, value, withFallback, fallback) {\n    // no value available\n    if (value === undefined) return withFallback ? _defineProperty({}, key, fallback) : {};\n    // force unsetting of a value\n    if (value === null) return _defineProperty({}, key, null);\n\n    // TypeCheck [GENERIC]\n    var isAvailable = true; // if it’s not undefined, it was set voluntarily\n    var forceFallback = false;\n\n    // TypeCheck [String]\n    var expectedString = typeof fallback === 'string';\n    if (expectedString) isAvailable = typeof value === 'string' || value instanceof String;\n    if (expectedString && !isAvailable) {\n      forceFallback = true;\n      wrongTypeWarn(key, 'string');\n    }\n\n    // TypeCheck [Number]\n    var expectedNumber = !Number.isNaN(fallback) && typeof fallback === 'number';\n    if (expectedNumber) isAvailable = !Number.isNaN(value) && typeof value === 'number';\n    if (expectedNumber && !isAvailable) {\n      forceFallback = true;\n      wrongTypeWarn(key, 'number');\n    }\n\n    // TypeCheck [Object]\n    var expectedObject = Object.prototype.toString.call(fallback) === '[object Object]';\n    if (expectedObject) isAvailable = Object.prototype.toString.call(value) === '[object Object]';\n    if (expectedObject && !isAvailable) {\n      forceFallback = true;\n      wrongTypeWarn(key, 'object');\n    }\n\n    // TypeCheck [Boolean]\n    var expectedBoolean = typeof fallback === 'boolean';\n    if (expectedBoolean) isAvailable = typeof value === 'boolean';\n    if (expectedBoolean && !isAvailable) {\n      forceFallback = true;\n      wrongTypeWarn(key, 'boolean');\n    }\n\n    // TypeCheck [Array]\n    var expectedArray = Array.isArray(fallback);\n    if (expectedArray) isAvailable = Array.isArray(value);\n    if (expectedArray && !isAvailable) {\n      forceFallback = true;\n      wrongTypeWarn(key, 'array');\n    }\n    var isFallback = forceFallback || withFallback;\n\n    // Special rule for [dragKeys]\n    if (key === 'dragKeys' && isAvailable) return _defineProperty({}, key, Object.assign(fallback, value));\n    if (key === 'dragKeys' && !isAvailable) return isFallback ? _defineProperty({}, key, fallback) : {};\n\n    // Special rule for [dropZones]\n    if (key === 'dropZones' && isAvailable && new Set(value.map(function (v) {\n      return v.id;\n    })).size !== value.length) console.warn(\"[DragSelect] UniqueConstraintsIssue: setting \\\"dropZones\\\" contains duplicate ids.\");\n    if (isAvailable) return _defineProperty({}, key, value);\n    if (isFallback) return _defineProperty({}, key, fallback);\n    return {};\n  };\n\n  /**\n   * This helper method creates the setting object,\n   * - if the settings provided are of wrong type, the fallback value will be used\n   * - - except for if settings are undefined or explicitly marked as \"null\"\n   * - if \"withfallback\" is true, it will return the object with all settings:\n   * - - if not provided from the settings object (or wrong type), the fallback will be used\n   * (the fallback value for each setting is the last prop of the hydrateHelper)\n   * @param {Settings} settings\n   * @param {boolean} withFallback\n   */\n  var hydrateSettings = (function (settings, withFallback) {\n    return _objectSpread2(_objectSpread2(_objectSpread2(_objectSpread2(_objectSpread2(_objectSpread2(_objectSpread2(_objectSpread2(_objectSpread2(_objectSpread2(_objectSpread2(_objectSpread2(_objectSpread2(_objectSpread2(_objectSpread2(_objectSpread2(_objectSpread2(_objectSpread2(_objectSpread2(_objectSpread2(_objectSpread2(_objectSpread2(_objectSpread2(_objectSpread2(_objectSpread2(_objectSpread2(_objectSpread2(_objectSpread2(_objectSpread2(_objectSpread2(_objectSpread2(_objectSpread2(_objectSpread2(_objectSpread2(_objectSpread2({}, hydrateHelper('area', settings.area, withFallback, document)), hydrateHelper('selectables', settings.selectables, withFallback, null)), hydrateHelper('autoScrollSpeed', settings.autoScrollSpeed, withFallback, 5)), hydrateHelper('overflowTolerance', settings.overflowTolerance, withFallback, {\n      x: 25,\n      y: 25\n    })), hydrateHelper('zoom', settings.zoom, withFallback, 1)), hydrateHelper('customStyles', settings.customStyles, withFallback, false)), hydrateHelper('multiSelectMode', settings.multiSelectMode, withFallback, false)), hydrateHelper('multiSelectToggling', settings.multiSelectToggling, withFallback, true)), hydrateHelper('multiSelectKeys', settings.multiSelectKeys, withFallback, ['Control', 'Shift', 'Meta'])), hydrateHelper('selector', settings.selector, withFallback, null)), hydrateHelper('selectionThreshold', settings.selectionThreshold, withFallback, 0)), hydrateHelper('draggability', settings.draggability, withFallback, true)), hydrateHelper('immediateDrag', settings.immediateDrag, withFallback, true)), hydrateHelper('keyboardDrag', settings.keyboardDrag, withFallback, true)), hydrateHelper('dragKeys', settings.dragKeys, withFallback, {\n      up: ['ArrowUp'],\n      down: ['ArrowDown'],\n      left: ['ArrowLeft'],\n      right: ['ArrowRight']\n    })), hydrateHelper('keyboardDragSpeed', settings.keyboardDragSpeed, withFallback, 10)), hydrateHelper('useTransform', settings.useTransform, withFallback, true)), hydrateHelper('refreshMemoryRate', settings.refreshMemoryRate, withFallback, 80)), hydrateHelper('dropZones', settings.dropZones, withFallback, [])), hydrateHelper('dropInsideThreshold', settings.dropInsideThreshold, withFallback, 1)), hydrateHelper('dropTargetThreshold', settings.dropTargetThreshold, withFallback, 0)), hydrateHelper('usePointerEvents', settings.usePointerEvents, withFallback, false)), hydrateHelper('hoverClass', settings.hoverClass, withFallback, 'ds-hover')), hydrateHelper('selectableClass', settings.selectableClass, withFallback, 'ds-selectable')), hydrateHelper('selectedClass', settings.selectedClass, withFallback, 'ds-selected')), hydrateHelper('selectorClass', settings.selectorClass, withFallback, 'ds-selector')), hydrateHelper('selectorAreaClass', settings.selectorAreaClass, withFallback, 'ds-selector-area')), hydrateHelper('droppedTargetClass', settings.droppedTargetClass, withFallback, 'ds-dropped-target')), hydrateHelper('droppedInsideClass', settings.droppedInsideClass, withFallback, 'ds-dropped-inside')), hydrateHelper('droppableClass', settings.droppableClass, withFallback, 'ds-droppable')), hydrateHelper('dropZoneClass', settings.dropZoneClass, withFallback, 'ds-dropzone')), hydrateHelper('dropZoneReadyClass', settings.dropZoneReadyClass, withFallback, 'ds-dropzone-ready')), hydrateHelper('dropZoneTargetClass', settings.dropZoneTargetClass, withFallback, 'ds-dropzone-target')), hydrateHelper('dropZoneInsideClass', settings.dropZoneInsideClass, withFallback, 'ds-dropzone-inside')), hydrateHelper('dragAsBlock', settings.dragAsBlock, withFallback, false));\n  });\n\n  // @ts-check\n\n  // [PUBLICLY EXPOSED METHOD]\n\n  /**\n   * Axis-Aligned Bounding Box Collision Detection.\n   * Imagine following Example:\n   *\n   *\n   *        b01\n   *     a01[1]a02\n   *        b02      b11\n   *              a11[2]a12\n   *                 b12\n   *\n   *\n   * to check if those two boxes collide we do this AABB calculation:\n   * 1. a01 < a12 (left border pos box1 smaller than right border pos box2)\n   * 2. a02 > a11 (right border pos box1 larger than left border pos box2)\n   * 3. b01 < b12 (top border pos box1 smaller than bottom border pos box2)\n   * 4. b02 > b11 (bottom border pos box1 larger than top border pos box2)\n   * {@link https://en.wikipedia.org/wiki/Minimum_bounding_box#Axis-aligned_minimum_bounding_box Wikipedia}\n   * {@link https://developer.mozilla.org/en-US/docs/Games/Techniques/2D_collision_detection MDN}\n   * @param {{left:number,right:number,top:number,bottom:number}} el1\n   * @param {{left:number,right:number,top:number,bottom:number}} el2\n   * @param {number} [percent=0]\n   *  1 = the element has to be completely inside the other element\n   *  0.8 = the element has to be 80% inside the other element\n   *  0.5 = the element has to be 50% inside the other element\n   *  0.2 = the element has to be 20% inside the other element\n   *  0 = the element only has to touch the other element\n   * @returns {boolean}\n   */\n  var isCollision = (function (el1, el2) {\n    var percent = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;\n    var element1 = el1;\n    if (percent > 0) {\n      var widthPoint = (el1.right - el1.left) * percent;\n      var heightPoint = (el1.bottom - el1.top) * percent;\n      element1 = {\n        left: el1.left + widthPoint,\n        right: el1.right - widthPoint,\n        top: el1.top + heightPoint,\n        bottom: el1.bottom - heightPoint\n      };\n    }\n    if (element1.left < el2.right &&\n    // 1.\n    element1.right > el2.left &&\n    // 2.\n    element1.top < el2.bottom &&\n    // 3.\n    element1.bottom > el2.top // 4.\n    ) return true;\n    // collision detected!\n    return false;\n  });\n\n  // @ts-check\n\n  /**\n   * Moves the element in a posDirection\n   * @param {Object} p\n   * @param {DSElement} p.element\n   * @param {Vect2} p.posDirection\n   * @param {DSBoundingRect} p.containerRect\n   * @param {boolean} p.useTransform\n   */\n  var moveElement = (function (_ref) {\n    var element = _ref.element,\n      posDirection = _ref.posDirection,\n      containerRect = _ref.containerRect,\n      useTransform = _ref.useTransform;\n    var elementPos = getStylePosition(element, useTransform);\n    var newPos = calc(elementPos, '+', posDirection);\n    setStylePosition(element, newPos, useTransform);\n    var elementRect = element.getBoundingClientRect();\n    var edges = getOverflowEdges({\n      elementRect: elementRect,\n      containerRect: containerRect\n    });\n    handleElementOverflow({\n      element: element,\n      edges: edges,\n      elementRect: elementRect,\n      containerRect: containerRect,\n      elementPos: newPos,\n      useTransform: useTransform\n    });\n  });\n\n  // @ts-check\n\n  /**\n   * Removes event-listeners to the selectorArea\n   * @param {MutationObserver} modificationObserver\n   * @param {DSModificationCallback} callback\n   */\n  var removeModificationObservers = (function (modificationObserver, callback) {\n    window.removeEventListener('resize', callback);\n    window.removeEventListener('scroll', callback);\n    modificationObserver.disconnect();\n  });\n\n  // @ts-check\n\n  /**\n   * Scroll the element in the specified direction\n   * @param {DSArea} element\n   * @param {Array.<'top'|'bottom'|'left'|'right'|undefined>} directions\n   * @param {number} multiplier\n   */\n  var scrollElement = (function (element, directions, multiplier) {\n    if (!directions.length) return;\n    var docEl = document && document.documentElement && document.documentElement.scrollTop && document.documentElement;\n    var _element = element instanceof Document ? docEl || document.body : element;\n    var scrollTop = directions.includes('top') && _element.scrollTop > 0;\n    var scrollBot = directions.includes('bottom') && _element.scrollTop < _element.scrollHeight;\n    var scrollLeft = directions.includes('left') && _element.scrollLeft > 0;\n    var scrollRight = directions.includes('right') && _element.scrollLeft < _element.scrollWidth;\n    if (scrollTop) _element.scrollTop -= 1 * multiplier;\n    if (scrollBot) _element.scrollTop += 1 * multiplier;\n    if (scrollLeft) _element.scrollLeft -= 1 * multiplier;\n    if (scrollRight) _element.scrollLeft += 1 * multiplier;\n  });\n\n  // @ts-check\n\n  /**\n   * Sets the style position to the X and Y coordinates\n   * Can handle translate and top/left\n   * @param {DSElement} element\n   * @param {Vect2} values\n   * @param {boolean} [useTranslate]\n   * @return {DSElement}\n   */\n  var setStylePosition = (function (element, values, useTranslate) {\n    if (useTranslate) {\n      var prevTransform = element.style.transform;\n      element.style.transform = \"translate3d(\".concat(values.x, \"px,\").concat(values.y, \"px,1px) \").concat(prevTransform.replace(/translate.*?\\)/g, ''));\n    } else {\n      element.style.left = \"\".concat(values.x, \"px\");\n      element.style.top = \"\".concat(values.y, \"px\");\n    }\n    return element;\n  });\n\n  /**\n   * @typedef {function} DSSubscribe\n   * @param {DSCallbackNames} eventName\n   * @param {DSCallback} callback\n   * @returns {number} event id, can be used to unsubscribe more efficiently\n   */\n  /**\n   * @typedef {function} DSPublish\n   * @param {DSCallbackNames} eventName\n   * @param {CallbackObject} data passed to the subscription method\n   */\n\n  /**\n   * Maps internal events to external ones\n   *\n   * @param {Object} p\n   * @param {DSSubscribe} p.subscribe\n   * @param {DSPublish} p.publish\n   * @param {Interaction} p.Interaction\n   * @param {SelectedSet} p.SelectedSet\n   * @param {DropZones} p.DropZones\n   */\n  var subscriberAliases = (function (_ref) {\n    var subscribe = _ref.subscribe,\n      publish = _ref.publish,\n      Interaction = _ref.Interaction,\n      SelectedSet = _ref.SelectedSet,\n      DropZones = _ref.DropZones;\n    var mapping = {\n      'Selected:added': [{\n        name: 'elementselect'\n      }],\n      'Selected:removed': [{\n        name: 'elementunselect'\n      }],\n      'Area:scroll': [{\n        name: 'autoscroll'\n      }],\n      // scroll_directions, scroll_multiplier\n      'Interaction:start': [{\n        name: 'dragstart'\n      }],\n      // event, isDraggingKeyboard\n      'Interaction:update': [\n      // event, isDraggingKeyboard\n      {\n        name: 'dragmove',\n        condition: function condition(data) {\n          return data.event;\n        }\n      }],\n      'Interaction:end': [\n      // event, isDraggingKeyboard\n      {\n        name: 'callback',\n        extraData: function extraData() {\n          var target = DropZones.getTarget();\n          return _objectSpread2({}, target ? {\n            dropTarget: target.toObject()\n          } : {});\n        }\n      }]\n    };\n    var _loop = function _loop() {\n      var _Object$entries$_i = _slicedToArray(_Object$entries[_i], 2),\n        sub_name = _Object$entries$_i[0],\n        pubs = _Object$entries$_i[1];\n      ['pre', false].forEach(function (filler) {\n        return subscribe(filler ? \"\".concat(sub_name, \":\").concat(filler) : sub_name, function (data) {\n          return pubs.forEach(function (pub) {\n            return (!pub.condition || pub.condition(data)) && publish(filler ? \"\".concat(filler).concat(pub.name) : pub.name, _objectSpread2(_objectSpread2({\n              items: SelectedSet.elements,\n              isDragging: Interaction.isDragging\n            }, data), pub.extraData ? pub.extraData(data) : {}));\n          });\n        });\n      });\n    };\n    for (var _i = 0, _Object$entries = Object.entries(mapping); _i < _Object$entries.length; _i++) {\n      _loop();\n    }\n  });\n\n  /**\n   * Transforms any list or single dom node to an array so user doesn’t have to care. Also removes duplicates.\n   * @param {DSInputElements} items a single item, a Node-list or any element group\n   * @return {DSElements}\n   */\n  var toArray = (function (items) {\n    if (!items) return [];\n    if (!Array.isArray(items) && (items instanceof HTMLElement || items instanceof SVGElement)) return [items];\n    // @ts-ignore\n    return _toConsumableArray(new Set(_toConsumableArray(items)));\n  });\n\n  // @ts-check\n\n  /**\n   * Updates element style left, top, width, height values\n   * according to pos input object.\n   * @param {HTMLElement} element\n   * @param {{left:number,top:number,width:number,height:number}} pos\n   */\n  var updateElementStylePos = (function (element, pos) {\n    element.style.left = \"\".concat(pos.left, \"px\");\n    element.style.top = \"\".concat(pos.top, \"px\");\n    element.style.width = \"\".concat(pos.width, \"px\");\n    element.style.height = \"\".concat(pos.height, \"px\");\n  });\n\n  var Area = /*#__PURE__*/function () {\n    /**\n     * @type {DragSelect}\n     * @private\n     */\n\n    /**\n     * @type {{cleanup:() => void}}\n     * @private\n     */\n\n    /**\n     * @type {DSArea}\n     * @private\n     */\n\n    /**\n     * @type {DSArea[]}\n     * @private\n     */\n\n    /**\n     * @type {CSSStyleDeclaration}\n     * @private\n     * */\n\n    /**\n     * @type {{top:number,bottom:number,left:number,right:number}}\n     * @private\n     * */\n\n    /**\n     * @type {DSBoundingRect}\n     * @private\n     * */\n\n    /**\n     * @constructor Area\n     * @param {{DS:DragSelect}} p\n     * @ignore\n     */\n    function Area(_ref) {\n      var _this = this;\n      var DS = _ref.DS;\n      _classCallCheck(this, Area);\n      _defineProperty(this, \"DS\", void 0);\n      _defineProperty(this, \"_observers\", void 0);\n      _defineProperty(this, \"_node\", void 0);\n      _defineProperty(this, \"_parentNodes\", void 0);\n      _defineProperty(this, \"_computedStyle\", void 0);\n      _defineProperty(this, \"_computedBorder\", void 0);\n      _defineProperty(this, \"_rect\", void 0);\n      _defineProperty(this, \"setArea\", function (area) {\n        _this.reset();\n        _this._node = area;\n        handleElementPositionAttribute({\n          computedStyle: _this.computedStyle,\n          node: _this._node\n        });\n\n        // first immediate debounce to update values after dom-update\n        setTimeout(function () {\n          _this.DS.PubSub.publish('Area:modified:pre', {\n            item: _this\n          });\n          _this.reset();\n          _this.DS.PubSub.publish('Area:modified', {\n            item: _this\n          });\n        });\n      });\n      _defineProperty(this, \"start\", function () {\n        _this._observers = addModificationObservers(_this.parentNodes, debounce(function (event) {\n          _this.DS.PubSub.publish('Area:modified:pre', {\n            event: event,\n            item: _this\n          });\n          _this.reset();\n          _this.DS.PubSub.publish('Area:modified', {\n            event: event,\n            item: _this\n          });\n        }, 60));\n      });\n      _defineProperty(this, \"reset\", function () {\n        _this._computedStyle = undefined;\n        _this._rect = undefined;\n        _this._computedBorder = undefined;\n        _this._parentNodes = undefined;\n      });\n      _defineProperty(this, \"stop\", function () {\n        _this._observers.cleanup();\n        _this.reset();\n      });\n      _defineProperty(this, \"scroll\", function (directions, multiplier) {\n        var data = {\n          scroll_directions: directions,\n          scroll_multiplier: multiplier\n        };\n        _this.DS.PubSub.publish('Area:scroll:pre', data);\n        scrollElement(_this._node, directions, multiplier);\n        _this.DS.PubSub.publish('Area:scroll', data);\n      });\n      this.DS = DS;\n      this.setArea(this.DS.stores.SettingsStore.s.area);\n      // @ts-ignore: @todo: update to typescript\n      this.DS.PubSub.subscribe('Settings:updated:area', function (_ref2) {\n        var settings = _ref2.settings;\n        _this.setArea(settings.area);\n      });\n      this.DS.PubSub.subscribe('Interaction:init', this.start);\n      this.DS.PubSub.subscribe('Interaction:end', this.reset);\n    }\n\n    /** @param {DSArea} area */\n    _createClass(Area, [{\n      key: \"HTMLNode\",\n      get:\n      /// ///////////////////////////////////////////////////////////////////////////////////\n      // Node Getters\n\n      function get() {\n        return (/** @type {DSArea} */this._node\n        );\n      }\n\n      /**\n       * The computed border from the element (caches result)\n       * @type {{top:number,bottom:number,left:number,right:number}}\n       */\n    }, {\n      key: \"computedBorder\",\n      get: function get() {\n        if (this._computedBorder) return this._computedBorder;\n        return {\n          top: parseInt(this.computedStyle.borderTopWidth),\n          bottom: parseInt(this.computedStyle.borderBottomWidth),\n          left: parseInt(this.computedStyle.borderLeftWidth),\n          right: parseInt(this.computedStyle.borderRightWidth)\n        };\n      }\n\n      /**\n       * The computed styles from the element (caches result)\n       * @type {CSSStyleDeclaration}\n       */\n    }, {\n      key: \"computedStyle\",\n      get: function get() {\n        if (this._computedStyle) return this._computedStyle;\n        if (this.HTMLNode instanceof Document) return this._computedStyle = window.getComputedStyle(this.HTMLNode.body || this.HTMLNode.documentElement);\n        return this._computedStyle = window.getComputedStyle(this.HTMLNode);\n      }\n\n      /**\n       * The element rect (caches result) (without scrollbar or borders)\n       * @type {DSBoundingRect}\n       */\n    }, {\n      key: \"rect\",\n      get: function get() {\n        if (this._rect) return this._rect;\n        return this._rect = getAreaRect(this.HTMLNode, this.DS.stores.SettingsStore.s.zoom);\n      }\n    }, {\n      key: \"parentNodes\",\n      get: function get() {\n        if (this._parentNodes) return this._parentNodes;\n        return this._parentNodes = getAllParentNodes(this.HTMLNode);\n      }\n    }]);\n    return Area;\n  }();\n\n  var Drag = /*#__PURE__*/function () {\n    /**\n     * @type {Vect2}\n     * @private\n     */\n\n    /**\n     * @type {Vect2}\n     * @private\n     */\n\n    /**\n     * @type {DSElements}\n     * @private\n     */\n\n    /**\n     * @type {DSDragKeys}\n     * @private\n     */\n\n    /**\n     * @type {string[]}\n     * @private\n     */\n\n    /**\n     * @type {DSBoundingRect}\n     * @private\n     */\n\n    /**\n     * @constructor Drag\n     * @param {{DS:DragSelect}} obj\n     * @ignore\n     */\n    function Drag(_ref) {\n      var _this = this;\n      var DS = _ref.DS;\n      _classCallCheck(this, Drag);\n      _defineProperty(this, \"_prevCursorPos\", void 0);\n      _defineProperty(this, \"_prevScrollPos\", void 0);\n      _defineProperty(this, \"_elements\", []);\n      _defineProperty(this, \"_dragKeys\", void 0);\n      _defineProperty(this, \"_dragKeysFlat\", []);\n      _defineProperty(this, \"_selectionRect\", void 0);\n      _defineProperty(this, \"assignDragkeys\", function () {\n        _this._dragKeys = {\n          up: _this.DS.stores.SettingsStore.s.dragKeys.up.map(function (k) {\n            return k.toLowerCase();\n          }),\n          down: _this.DS.stores.SettingsStore.s.dragKeys.down.map(function (k) {\n            return k.toLowerCase();\n          }),\n          left: _this.DS.stores.SettingsStore.s.dragKeys.left.map(function (k) {\n            return k.toLowerCase();\n          }),\n          right: _this.DS.stores.SettingsStore.s.dragKeys.right.map(function (k) {\n            return k.toLowerCase();\n          })\n        };\n        _this._dragKeysFlat = [].concat(_toConsumableArray(_this._dragKeys.up), _toConsumableArray(_this._dragKeys.down), _toConsumableArray(_this._dragKeys.left), _toConsumableArray(_this._dragKeys.right));\n      });\n      _defineProperty(this, \"keyboardDrag\", function (_ref2) {\n        var event = _ref2.event,\n          key = _ref2.key;\n        var _key = key.toLowerCase();\n        if (!_this.DS.stores.SettingsStore.s.keyboardDrag || !_this._dragKeysFlat.includes(_key) || !_this.DS.SelectedSet.size || !_this.DS.stores.SettingsStore.s.draggability || _this.DS[\"continue\"]) return;\n        var publishData = {\n          event: event,\n          isDragging: true,\n          isDraggingKeyboard: true\n        };\n        _this.DS.publish(['Interaction:start:pre', 'Interaction:start'], publishData);\n        _this._elements = _this.DS.getSelection();\n        if (_this.DS.stores.SettingsStore.s.dragAsBlock) _this._selectionRect = getBoundingClientRect(_this._elements, _this.DS.SelectableSet);\n        _this.handleZIndex(true);\n        var posDirection = handleKeyboardDragPosDifference({\n          shiftKey: _this.DS.stores.KeyStore.currentValues.includes('shift'),\n          keyboardDragSpeed: _this.DS.stores.SettingsStore.s.keyboardDragSpeed,\n          zoom: _this.DS.stores.SettingsStore.s.zoom,\n          key: _key,\n          scrollCallback: _this.DS.Area.scroll,\n          scrollDiff: _this._scrollDiff,\n          canScroll: _this.DS.stores.ScrollStore.canScroll,\n          dragKeys: _this._dragKeys\n        });\n        if (_this.DS.stores.SettingsStore.s.dragAsBlock) posDirection = _this.limitDirection(posDirection);\n        _this._elements.forEach(function (element) {\n          return moveElement({\n            element: element,\n            posDirection: posDirection,\n            containerRect: _this.DS.SelectorArea.rect,\n            useTransform: _this.DS.stores.SettingsStore.s.useTransform\n          });\n        });\n        _this.DS.publish(['Interaction:update:pre', 'Interaction:update'], publishData);\n      });\n      _defineProperty(this, \"keyboardEnd\", function (_ref3) {\n        var event = _ref3.event,\n          key = _ref3.key;\n        var _key = key.toLowerCase();\n        if (!_this.DS.stores.SettingsStore.s.keyboardDrag || !_this._dragKeysFlat.includes(_key) || !_this.DS.SelectedSet.size || !_this.DS.stores.SettingsStore.s.draggability) return;\n        var publishData = {\n          event: event,\n          isDragging: _this.DS.stores.SettingsStore.s.draggability,\n          isDraggingKeyboard: true\n        };\n        _this.DS.publish(['Interaction:end:pre', 'Interaction:end'], publishData);\n      });\n      _defineProperty(this, \"start\", function (_ref4) {\n        var isDragging = _ref4.isDragging,\n          isDraggingKeyboard = _ref4.isDraggingKeyboard;\n        if (!isDragging || isDraggingKeyboard) return;\n        _this._prevCursorPos = null;\n        _this._prevScrollPos = null;\n        _this._elements = _this.DS.getSelection();\n        if (_this.DS.stores.SettingsStore.s.dragAsBlock) _this._selectionRect = getBoundingClientRect(_this._elements, _this.DS.SelectableSet);\n        _this.handleZIndex(true);\n      });\n      _defineProperty(this, \"stop\", function (evt) {\n        if (evt !== null && evt !== void 0 && evt.isKeyboard) return;\n        _this._prevCursorPos = null;\n        _this._prevScrollPos = null;\n        _this.handleZIndex(false);\n        _this._elements = [];\n      });\n      _defineProperty(this, \"update\", function (_ref5) {\n        var isDragging = _ref5.isDragging,\n          isDraggingKeyboard = _ref5.isDraggingKeyboard;\n        if (!isDragging || !_this._elements.length || isDraggingKeyboard || _this.DS[\"continue\"]) return;\n        var posDirection = calc(_this._cursorDiff, '+', _this._scrollDiff);\n        if (_this.DS.stores.SettingsStore.s.dragAsBlock) posDirection = _this.limitDirection(posDirection);\n        _this._elements.forEach(function (element) {\n          return moveElement({\n            element: element,\n            posDirection: posDirection,\n            containerRect: _this.DS.SelectorArea.rect,\n            useTransform: _this.DS.stores.SettingsStore.s.useTransform\n          });\n        });\n      });\n      _defineProperty(this, \"limitDirection\", function (direction) {\n        var containerRect = _this.DS.SelectorArea.rect;\n        var scrollAmount = _this.DS.stores.ScrollStore.scrollAmount;\n        var delta = {\n          top: containerRect.top - _this._selectionRect.top + scrollAmount.y,\n          left: containerRect.left - _this._selectionRect.left + scrollAmount.x,\n          bottom: containerRect.bottom - _this._selectionRect.bottom + scrollAmount.y,\n          right: containerRect.right - _this._selectionRect.right + scrollAmount.x\n        };\n        if (direction.x === 0 && direction.y === 0) return direction;\n        if (direction.y < 0) direction.y = Math.max(direction.y, delta.top);\n        if (direction.x < 0) direction.x = Math.max(direction.x, delta.left);\n        if (direction.y > 0) direction.y = Math.min(direction.y, delta.bottom);\n        if (direction.x > 0) direction.x = Math.min(direction.x, delta.right);\n        _this._selectionRect.top += direction.y;\n        _this._selectionRect.bottom += direction.y;\n        _this._selectionRect.left += direction.x;\n        _this._selectionRect.right += direction.x;\n        return direction;\n      });\n      _defineProperty(this, \"handleZIndex\", function (add) {\n        _this._elements.forEach(function (element) {\n          return element.style.zIndex = \"\".concat((parseInt(element.style.zIndex) || 0) + add ? 9999 : -9998);\n        });\n      });\n      this.DS = DS;\n\n      // @ts-ignore: @todo: update to typescript\n      this.DS.subscribe('Settings:updated:dragKeys', this.assignDragkeys);\n      this.assignDragkeys();\n      this.DS.subscribe('Interaction:start', this.start);\n      this.DS.subscribe('Interaction:end', this.stop);\n      this.DS.subscribe('Interaction:update', this.update);\n      this.DS.subscribe('KeyStore:down', this.keyboardDrag);\n      this.DS.subscribe('KeyStore:up', this.keyboardEnd);\n    }\n    _createClass(Drag, [{\n      key: \"_cursorDiff\",\n      get: function get() {\n        var currentPointerVal = this.DS.stores.PointerStore.currentVal;\n        var cursorDiff = this._prevCursorPos ? calc(currentPointerVal, '-', this._prevCursorPos) : {\n          x: 0,\n          y: 0\n        };\n        this._prevCursorPos = currentPointerVal;\n        return cursorDiff;\n      }\n    }, {\n      key: \"_scrollDiff\",\n      get: function get() {\n        var currentScrollVal = this.DS.stores.ScrollStore.currentVal;\n        var scrollDiff = this._prevScrollPos ? calc(currentScrollVal, '-', this._prevScrollPos) : {\n          x: 0,\n          y: 0\n        };\n        this._prevScrollPos = currentScrollVal;\n        return scrollDiff;\n      }\n    }]);\n    return Drag;\n  }();\n\n  var DropZone = /*#__PURE__*/function () {\n    /**\n     * @type {string}\n     */\n\n    /**\n     * @type {DSElement}\n     */\n\n    /**\n     * @type {DSElements}\n     */\n\n    /**\n     * @type {DOMRect}\n     * @private\n     */\n\n    /**\n     * @type {{cleanup:()=>void}}\n     * @private\n     */\n\n    /**\n     * @type {NodeJS.Timeout}\n     * @private\n     */\n\n    /**\n     * @type {DSElements}\n     * @private\n     */\n\n    /**\n     * @type {DSElements}\n     * @private\n     */\n\n    /**\n     * @constructor Drag\n     * @param {Object} obj\n     * @param {DragSelect} obj.DS\n     * @param {string} obj.id\n     * @param {DSElement} obj.element\n     * @param {DSInputElements} [obj.droppables]\n     * @ignore\n     */\n    function DropZone(_ref) {\n      var _this = this;\n      var DS = _ref.DS,\n        id = _ref.id,\n        element = _ref.element,\n        droppables = _ref.droppables;\n      _classCallCheck(this, DropZone);\n      _defineProperty(this, \"id\", void 0);\n      _defineProperty(this, \"element\", void 0);\n      _defineProperty(this, \"_droppables\", void 0);\n      _defineProperty(this, \"_rect\", void 0);\n      _defineProperty(this, \"_observers\", void 0);\n      _defineProperty(this, \"_timeout\", void 0);\n      _defineProperty(this, \"_itemsDropped\", []);\n      _defineProperty(this, \"_itemsInside\", void 0);\n      _defineProperty(this, \"setReadyClasses\", function (action) {\n        if (_this.isDestroyed) return;\n        var selectedEls = _this.droppables.filter(function (el) {\n          return _this.DS.SelectedSet.has(el);\n        });\n        if (!selectedEls.length) return;\n        selectedEls.forEach(function (item) {\n          item.classList[action](\"\".concat(_this.Settings.droppableClass));\n          item.classList[action](\"\".concat(_this.Settings.droppableClass, \"-\").concat(_this.id));\n        });\n        _this.element.classList[action](\"\".concat(_this.Settings.dropZoneReadyClass));\n      });\n      _defineProperty(this, \"handleNoDrop\", function () {\n        var _this$_itemsDropped;\n        if (_this.isDestroyed) return;\n        // for each selected element that is not part of the target zone, remove the classes\n        _this.DS.SelectedSet.forEach(function (item) {\n          item.classList.remove(_this.Settings.droppedTargetClass);\n          item.classList.remove(\"\".concat(_this.Settings.droppedTargetClass, \"-\").concat(_this.id));\n        });\n        // and remove them from the zones dropped items\n        _this._itemsDropped = _this._itemsDropped.filter(function (item) {\n          return !_this.DS.SelectedSet.has(item);\n        });\n        // if the zone has no dropped left, also remove the zones class\n        if (!((_this$_itemsDropped = _this._itemsDropped) !== null && _this$_itemsDropped !== void 0 && _this$_itemsDropped.length)) _this.element.classList.remove(\"\".concat(_this.Settings.dropZoneTargetClass));\n      });\n      _defineProperty(this, \"handleDrop\", function () {\n        var _this$droppables, _this$_itemsDropped2, _this$_itemsDropped3;\n        if (_this.isDestroyed) return;\n        _this._itemsDropped = _toConsumableArray(new Set([].concat(_toConsumableArray(_this._itemsDropped), _toConsumableArray((_this$droppables = _this.droppables) === null || _this$droppables === void 0 ? void 0 : _this$droppables.filter(function (item) {\n          return _this.DS.SelectedSet.has(item);\n        })))));\n        // add the target class to the zones dropped items\n        (_this$_itemsDropped2 = _this._itemsDropped) === null || _this$_itemsDropped2 === void 0 ? void 0 : _this$_itemsDropped2.forEach(function (item) {\n          item.classList.add(\"\".concat(_this.Settings.droppedTargetClass));\n          item.classList.add(\"\".concat(_this.Settings.droppedTargetClass, \"-\").concat(_this.id));\n        });\n        // if the zone has dropped, add the zones class\n        if ((_this$_itemsDropped3 = _this._itemsDropped) !== null && _this$_itemsDropped3 !== void 0 && _this$_itemsDropped3.length) _this.element.classList.add(\"\".concat(_this.Settings.dropZoneTargetClass));\n      });\n      _defineProperty(this, \"handleItemsInsideClasses\", function () {\n        var isAnyInside = false;\n        _this.droppables.forEach(function (item) {\n          if (_this.itemsInside.includes(item)) {\n            item.classList.add(\"\".concat(_this.Settings.droppedInsideClass));\n            item.classList.add(\"\".concat(_this.Settings.droppedInsideClass, \"-\").concat(_this.id));\n            isAnyInside = true;\n          } else {\n            item.classList.remove(\"\".concat(_this.Settings.droppedInsideClass, \"-\").concat(_this.id));\n            if (!item.className.includes(\"\".concat(_this.Settings.droppedInsideClass, \"-\"))) item.classList.remove(\"\".concat(_this.Settings.droppedInsideClass));\n          }\n        });\n        if (isAnyInside) _this.element.classList.add(\"\".concat(_this.Settings.dropZoneInsideClass));else _this.element.classList.remove(\"\".concat(_this.Settings.dropZoneInsideClass));\n      });\n      _defineProperty(this, \"start\", function (_ref2) {\n        var isDragging = _ref2.isDragging;\n        if (!isDragging || _this.isDestroyed) return;\n        _this.setReadyClasses('add');\n      });\n      _defineProperty(this, \"stop\", function (_ref3) {\n        var isDragging = _ref3.isDragging;\n        if (!isDragging || _this.isDestroyed) return;\n        _this.setReadyClasses('remove');\n        _this.handleItemsInsideClasses();\n      });\n      _defineProperty(this, \"toObject\", function () {\n        return {\n          id: _this.id,\n          element: _this.element,\n          droppables: _this.droppables,\n          itemsDropped: _this.itemsDropped,\n          itemsInside: _this.itemsInside\n        };\n      });\n      this.DS = DS;\n      this.Settings = DS.stores.SettingsStore.s;\n      this.id = id;\n      this.element = element;\n      if (droppables) this.droppables = toArray(droppables);\n      this.element.classList.add(\"\".concat(this.Settings.dropZoneClass));\n\n      // @ts-ignore: @todo: update to typescript\n      this.DS.subscribe('Settings:updated:dropZoneClass', function (_ref4) {\n        var settings = _ref4.settings;\n        if (!_this.element) return;\n        _this.element.classList.remove(settings['dropZoneClass:pre']);\n        _this.element.classList.add(settings.dropZoneClass);\n      });\n      this._observers = addModificationObservers(this.parentNodes, debounce(function () {\n        return _this._rect = null;\n      }, this.Settings.refreshMemoryRate));\n      this.DS.subscribe('Interaction:start', this.start);\n      this.DS.subscribe('Interaction:end', this.stop);\n    }\n\n    /**\n     * @param {'add'|'remove'} action\n     */\n    _createClass(DropZone, [{\n      key: \"destroy\",\n      value: function destroy() {\n        var _this2 = this;\n        this._observers.cleanup();\n        this.element.classList.remove(\"\".concat(this.Settings.dropZoneClass));\n        this.element.classList.remove(\"\".concat(this.Settings.dropZoneTargetClass));\n        this.element.classList.remove(\"\".concat(this.Settings.dropZoneReadyClass));\n        this.droppables.forEach(function (item) {\n          item.classList.remove(\"\".concat(_this2.Settings.droppedTargetClass));\n          item.classList.remove(\"\".concat(_this2.Settings.droppedTargetClass, \"-\").concat(_this2.id));\n          item.classList.remove(\"\".concat(_this2.Settings.droppableClass));\n          item.classList.remove(\"\".concat(_this2.Settings.droppableClass, \"-\").concat(_this2.id));\n        });\n        this.DS.unsubscribe('Interaction:start', this.start);\n        this.DS.unsubscribe('Interaction:end', this.stop);\n        this.element = null;\n        this.droppables = null;\n        this.id = null;\n        this._itemsDropped = null;\n        this._itemsInside = null;\n        this.isDestroyed = true;\n      }\n\n      /**\n       * @returns {DSDropZone}\n       */\n    }, {\n      key: \"rect\",\n      get: function get() {\n        if (this.isDestroyed) return null;\n        if (this._rect) return this._rect;\n        return this._rect = this.element.getBoundingClientRect();\n      }\n    }, {\n      key: \"itemsDropped\",\n      get: function get() {\n        if (this.isDestroyed) return null;\n        return this._itemsDropped;\n      }\n    }, {\n      key: \"itemsInside\",\n      get: function get() {\n        var _this3 = this;\n        if (this.isDestroyed) return null;\n        if (this._itemsInside) return this._itemsInside;\n        this._itemsInside = this.droppables.flatMap(function (item) {\n          if (isCollision(_this3.DS.SelectableSet.rects.get(item), _this3.rect, _this3.Settings.dropInsideThreshold)) return [item];\n          return [];\n        });\n\n        // since elements can be moved while this getter is called, we need to update the values every X seconds\n        if (this._timeout) clearTimeout(this._timeout);\n        this._timeout = setTimeout(function () {\n          return _this3._itemsInside = null;\n        }, this.Settings.refreshMemoryRate);\n        return this._itemsInside;\n      }\n    }, {\n      key: \"parentNodes\",\n      get: function get() {\n        if (this._parentNodes) return this._parentNodes;\n        return this._parentNodes = getAllParentNodes(this.element);\n      }\n    }, {\n      key: \"droppables\",\n      get: function get() {\n        if (this._droppables) return this._droppables;\n        return this.DS.SelectableSet.elements;\n      },\n      set: function set(value) {\n        this._droppables = value;\n      }\n    }]);\n    return DropZone;\n  }();\n\n  var DropZones = /*#__PURE__*/_createClass(\n  /**\n   * Get the drop zone by the zone element\n   * @type {Map<DSElement, DropZone>}\n   * @private\n   */\n\n  /**\n   * Get the drop zone by the zone id\n   * @type {Map<string, DropZone>}\n   * @private\n   */\n\n  /**\n   * Get the drop zones by one zone item\n   * @type {Map<DSElement,DropZone[]>}\n   * @private\n   */\n\n  /**\n   * Get the drop zones by one zone item\n   * @type {DropZone[]}\n   * @private\n   */\n\n  /**\n   * @constructor Drag\n   * @param {{DS:DragSelect}} obj\n   * @ignore\n   */\n  function DropZones(_ref) {\n    var _this = this;\n    var DS = _ref.DS;\n    _classCallCheck(this, DropZones);\n    _defineProperty(this, \"_zoneByElement\", new Map());\n    _defineProperty(this, \"_zoneById\", new Map());\n    _defineProperty(this, \"_zonesByDroppable\", new Map());\n    _defineProperty(this, \"_zones\", void 0);\n    _defineProperty(this, \"setDropZones\", function (_ref2) {\n      var dropZones = _ref2.dropZones;\n      if (!dropZones) return;\n      if (_this._zones) _this._zones.forEach(function (zone) {\n        return zone.destroy();\n      });\n      _this._zones = dropZones.map(function (zone) {\n        return new DropZone(_objectSpread2({\n          DS: _this.DS\n        }, zone));\n      });\n      _this._zones.forEach(function (zone) {\n        _this._zoneByElement.set(zone.element, zone);\n        _this._zoneById.set(zone.id, zone);\n        zone.droppables.forEach(function (droppable) {\n          var zones = _this._zonesByDroppable.get(droppable);\n          if (!(zones !== null && zones !== void 0 && zones.length)) return _this._zonesByDroppable.set(droppable, [zone]);\n          // @ts-ignore\n          _this._zonesByDroppable.set(droppable, _toConsumableArray(new Set([].concat(_toConsumableArray(zones), [zone]))));\n        });\n      });\n    });\n    _defineProperty(this, \"_handleDrop\", function (target) {\n      _this._zones.forEach(function (zone) {\n        if (zone === target) return;\n        zone.handleNoDrop();\n      });\n      if (!target) return;\n      target.handleDrop();\n    });\n    _defineProperty(this, \"_getZoneByElementsFromPoint\", function (elements, _ref3) {\n      var x = _ref3.x,\n        y = _ref3.y;\n      for (var i = 0, il = elements.length; i < il; i++) {\n        var zone = _this._zoneByElement.get(elements[i]);\n        if (zone && isCollision(zone.rect, {\n          left: x,\n          right: x,\n          top: y,\n          bottom: y\n        }, Math.min(_this.Settings.dropTargetThreshold, 0.5))) {\n          return zone;\n        }\n      }\n    });\n    _defineProperty(this, \"stop\", function (_ref4) {\n      var isDragging = _ref4.isDragging;\n      if (!isDragging) return;\n      var target = _this.getTarget();\n      _this._handleDrop(target);\n    });\n    _defineProperty(this, \"getItemsDroppedById\", function (zoneId) {\n      var zone = _this._zoneById.get(zoneId);\n      if (!zone) return console.warn(\"[DragSelect] No zone found (id: \".concat(zoneId, \")\"));\n      return zone.itemsDropped;\n    });\n    _defineProperty(this, \"getItemsInsideById\", function (zoneId, addClasses) {\n      var zone = _this._zoneById.get(zoneId);\n      if (!zone) return console.warn(\"[DragSelect] No zone found (id: \".concat(zoneId, \")\"));\n      var itemsInside = zone.itemsInside;\n      if (addClasses) zone.handleItemsInsideClasses();\n      return itemsInside;\n    });\n    _defineProperty(this, \"getTarget\", function (coordinates) {\n      var _this$_zones;\n      if (!((_this$_zones = _this._zones) !== null && _this$_zones !== void 0 && _this$_zones.length)) return;\n      var x = (coordinates === null || coordinates === void 0 ? void 0 : coordinates.x) || _this.DS.stores.PointerStore.currentVal.x;\n      var y = (coordinates === null || coordinates === void 0 ? void 0 : coordinates.y) || _this.DS.stores.PointerStore.currentVal.y;\n      var elements = document.elementsFromPoint(x, y);\n      return _this._getZoneByElementsFromPoint( /** @type {DSElements} */elements, {\n        x: x,\n        y: y\n      });\n    });\n    this.DS = DS;\n    this.Settings = DS.stores.SettingsStore.s;\n\n    // @ts-ignore: @todo: update to typescript\n    this.DS.subscribe('Settings:updated:dropZones', function (_ref5) {\n      var settings = _ref5.settings;\n      return _this.setDropZones(settings);\n    });\n    this.setDropZones({\n      dropZones: /** @type {DSDropZone[]} */this.DS.stores.SettingsStore.s.dropZones\n    });\n    this.DS.subscribe('Interaction:end', this.stop);\n  }\n\n  /**\n   * @param {Object} obj\n   * @param {DSDropZone[]} [obj.dropZones]\n   */);\n\n  var Interaction = /*#__PURE__*/function () {\n    /** @type {boolean} */\n\n    /** @type {boolean} */\n\n    /**\n     * @constructor Interaction\n     * @param {{DS:DragSelect}} obj\n     * @ignore\n     */\n    function Interaction(_ref) {\n      var _this = this;\n      var DS = _ref.DS;\n      _classCallCheck(this, Interaction);\n      _defineProperty(this, \"isInteracting\", void 0);\n      _defineProperty(this, \"isDragging\", void 0);\n      _defineProperty(this, \"init\", function () {\n        return _this.DS.publish('Interaction:init:pre', {});\n      });\n      _defineProperty(this, \"_init\", function () {\n        _this.stop();\n\n        // @TODO: fix pointer events mixing issue see [PR](https://github.com/ThibaultJanBeyer/DragSelect/pull/128#issuecomment-1154885289)\n        if (_this.Settings.usePointerEvents) _this.DS.Area.HTMLNode.addEventListener('pointerdown', _this.start, {\n          passive: false\n        });else _this.DS.Area.HTMLNode.addEventListener('mousedown', _this.start);\n        _this.DS.Area.HTMLNode.addEventListener('touchstart', _this.start, {\n          passive: false\n        });\n        _this.DS.publish('Interaction:init', {});\n      });\n      _defineProperty(this, \"start\", function (event) {\n        return _this.DS.publish('Interaction:start:pre', {\n          event: event,\n          isDragging: _this.isDragging\n        });\n      });\n      _defineProperty(this, \"_start\", function (event) {\n        if (event.type === 'touchstart') event.preventDefault(); // Call preventDefault() to prevent double click issue, see https://github.com/ThibaultJanBeyer/DragSelect/pull/29 & https://developer.mozilla.org/vi/docs/Web/API/Touch_events/Supporting_both_TouchEvent_and_MouseEvent\n        if (!_this._canInteract(event)) return;\n        _this.isInteracting = true;\n        _this.isDragging = _this.isDragEvent(event);\n        _this.DS.publish('Interaction:start', {\n          event: event,\n          isDragging: _this.isDragging\n        });\n\n        // @TODO: fix pointer events mixing issue see [PR](https://github.com/ThibaultJanBeyer/DragSelect/pull/128#issuecomment-1154885289)\n        if (_this.Settings.usePointerEvents) {\n          document.addEventListener('pointerup', _this.reset);\n          document.addEventListener('pointercancel', _this.reset);\n        } else document.addEventListener('mouseup', _this.reset);\n        document.addEventListener('touchend', _this.reset);\n      });\n      _defineProperty(this, \"isDragEvent\", function (event) {\n        var clickedElement = /** @type {Element} */event.target.closest(\".\".concat(_this.Settings.selectableClass));\n        if (!_this.Settings.draggability || _this.DS.stores.KeyStore.isMultiSelectKeyPressed(event) || !clickedElement) return false;\n        if (_this.Settings.immediateDrag) {\n          if (!_this.DS.SelectedSet.size) _this.DS.SelectedSet.add( /** @type {DSElement} */clickedElement);else if (!_this.DS.SelectedSet.has(clickedElement)) {\n            _this.DS.SelectedSet.clear();\n            _this.DS.SelectedSet.add( /** @type {DSElement} */clickedElement);\n          }\n        }\n        if (_this.DS.SelectedSet.has(clickedElement)) return true;\n        return false;\n      });\n      _defineProperty(this, \"onClick\", function (_ref2) {\n        var event = _ref2.event;\n        if (!_this._canInteract(event)) return;\n        if (event.detail > 0) return; // mouse interaction\n\n        var _this$DS = _this.DS,\n          _this$DS$stores = _this$DS.stores,\n          PointerStore = _this$DS$stores.PointerStore,\n          KeyStore = _this$DS$stores.KeyStore,\n          SelectableSet = _this$DS.SelectableSet,\n          SelectedSet = _this$DS.SelectedSet;\n        PointerStore.start(event);\n        var node = /** @type {any} */event.target;\n        if (!SelectableSet.has(node)) return;\n        if (!KeyStore.isMultiSelectKeyPressed(event)) SelectedSet.clear();\n        SelectedSet.toggle(node);\n        _this.reset(); // simulate mouse-up (that does not exist on keyboard)\n      });\n      _defineProperty(this, \"stop\", function () {\n        var area = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : _this.DS.Area.HTMLNode;\n        _this.isInteracting = false;\n        _this.isDragging = false;\n\n        // @TODO: fix pointer events mixing issue see [PR](https://github.com/ThibaultJanBeyer/DragSelect/pull/128#issuecomment-1154885289)\n        if (_this.Settings.usePointerEvents) {\n          area.removeEventListener('pointerdown', _this.start, {\n            // @ts-ignore\n            passive: false\n          });\n          document.removeEventListener('pointerup', _this.reset);\n          document.removeEventListener('pointercancel', _this.reset);\n        } else {\n          area.removeEventListener('mousedown', _this.start);\n          document.removeEventListener('mouseup', _this.reset);\n        }\n        area.removeEventListener('touchstart', _this.start, {\n          // @ts-ignore\n          passive: false\n        });\n        document.removeEventListener('touchend', _this.reset);\n      });\n      _defineProperty(this, \"update\", function (_ref3) {\n        var event = _ref3.event,\n          scroll_directions = _ref3.scroll_directions,\n          scroll_multiplier = _ref3.scroll_multiplier;\n        if (_this.isInteracting) _this.DS.publish(['Interaction:update:pre', 'Interaction:update'], {\n          event: event,\n          scroll_directions: scroll_directions,\n          scroll_multiplier: scroll_multiplier,\n          isDragging: _this.isDragging\n        });\n      });\n      _defineProperty(this, \"reset\", function (event) {\n        return _this.DS.publish('Interaction:end:pre', {\n          event: event,\n          isDragging: _this.isDragging\n        });\n      });\n      _defineProperty(this, \"_reset\", function (event) {\n        var isDragging = _this.isDragging;\n        _this.stop();\n        _this.init();\n        _this.DS.publish('Interaction:end', {\n          event: event,\n          isDragging: isDragging\n        });\n      });\n      this.DS = DS;\n      this.Settings = DS.stores.SettingsStore.s;\n      // @ts-ignore: @todo: update to typescript\n      this.DS.subscribe('Settings:updated:area', function (_ref4) {\n        var settings = _ref4.settings;\n        _this.stop(settings['area:pre']);\n        _this.init();\n      });\n      this.DS.subscribe('PointerStore:updated', this.update);\n      this.DS.subscribe('Selectable:click', this.onClick);\n      this.DS.subscribe('Selectable:pointer', function (_ref5) {\n        var event = _ref5.event;\n        return _this.start(event);\n      });\n      this.DS.subscribe('Interaction:start:pre', function (_ref6) {\n        var event = _ref6.event;\n        return _this._start(event);\n      });\n      this.DS.subscribe('Interaction:init:pre', this._init);\n      this.DS.subscribe('Interaction:end:pre', function (_ref7) {\n        var event = _ref7.event;\n        return _this._reset(event);\n      });\n      this.DS.subscribe('Area:scroll', this.update);\n    }\n    _createClass(Interaction, [{\n      key: \"_canInteract\",\n      value:\n      /**\n       * @param {DSEvent} event\n       */\n      function _canInteract(event) {\n        var isKeyboardClick = /** @type {MouseEvent} */event.clientX === 0 && /** @type {MouseEvent} */event.clientY === 0 && /** @type {MouseEvent} */event.detail === 0 && event.target;\n        if ( /** @type {MouseEvent} */event.button === 2 ||\n        // right-clicks\n        this.isInteracting ||\n        // fix double-click issues\n        event.target && !this.DS.SelectorArea.isInside( /** @type {DSElement} */event.target) ||\n        // fix outside elements issue\n        !isKeyboardClick && !this.DS.SelectorArea.isClicked(event) // make sure the mouse click is inside the area\n        ) return false;\n        return true;\n      }\n\n      /**\n       * @param {DSEvent} event\n       */\n    }]);\n    return Interaction;\n  }();\n\n  var PubSub = /*#__PURE__*/_createClass(function PubSub(_ref) {\n    var _this = this;\n    var DS = _ref.DS;\n    _classCallCheck(this, PubSub);\n    _defineProperty(this, \"subscribers\", {});\n    _defineProperty(this, \"subscribe\", function (eventName, callback) {\n      if (!Array.isArray(_this.subscribers[eventName])) _this.subscribers[eventName] = [];\n      _this.subscribers[eventName].push(callback);\n      return _this.subscribers[eventName].length - 1;\n    });\n    _defineProperty(this, \"unsubscribe\", function (eventName, callback, id) {\n      if (id >= 0) _this.subscribers[eventName].splice(id, 1);else if (callback) _this.subscribers[eventName] = _this.subscribers[eventName].filter(function (cb) {\n        return cb !== callback;\n      });\n    });\n    _defineProperty(this, \"publish\", function (eventName, data) {\n      if (Array.isArray(eventName)) eventName.forEach(function (name) {\n        return _this._publish(name, data);\n      });else _this._publish(eventName, data);\n    });\n    _defineProperty(this, \"_publish\", function (eventName, data) {\n      var subscribers = _this.subscribers[eventName];\n      if (!Array.isArray(subscribers)) return;\n      if (eventName.includes(\":pre\")) _this._handlePrePublish(subscribers, data);else _this._handlePublish(subscribers, data);\n    });\n    _defineProperty(this, \"_handlePublish\", function (subscribers, data) {\n      for (var i = 0, il = subscribers.length; i < il; i++) {\n        if (_this.DS.stopped) return;\n        subscribers[i](data);\n      }\n    });\n    _defineProperty(this, \"_handlePrePublish\", function (subscribers, data) {\n      var i = subscribers.length;\n      while (i--) {\n        if (_this.DS.stopped) return;\n        subscribers[i](data);\n      }\n    });\n    this.DS = DS;\n  }\n\n  /**\n   * Subscribe to an event\n   * @memberof DragSelect#\n   * @function subscribe\n   * @param {DSCallbackNames} eventName\n   * @param {DSCallback} callback\n   * @returns {number} event id, can be used to unsubscribe more efficiently\n   */);\n\n  var SelectableSet = /*#__PURE__*/function (_Set) {\n    _inherits(SelectableSet, _Set);\n    var _super = _createSuper(SelectableSet);\n    /**\n     * @type {Map<DSElement,DSBoundingRect>}\n     * @private\n     */\n\n    /**\n     * @type {NodeJS.Timeout}\n     * @private\n     */\n\n    /**\n     * @constructor SelectableSet\n     * @param {{DS:DragSelect}} obj\n     * @ignore\n     */\n    function SelectableSet(_ref) {\n      var _this;\n      var DS = _ref.DS;\n      _classCallCheck(this, SelectableSet);\n      _this = _super.call(this);\n      _defineProperty(_assertThisInitialized(_this), \"_rects\", void 0);\n      _defineProperty(_assertThisInitialized(_this), \"_timeout\", void 0);\n      _defineProperty(_assertThisInitialized(_this), \"init\", function () {\n        return toArray(_this.Settings.selectables).forEach(function (el) {\n          return _this.add(el);\n        });\n      });\n      _defineProperty(_assertThisInitialized(_this), \"clear\", function () {\n        return _this.forEach(function (el) {\n          return _this[\"delete\"](el);\n        });\n      });\n      _defineProperty(_assertThisInitialized(_this), \"_onClick\", function (event) {\n        return _this.DS.publish(['Selectable:click:pre', 'Selectable:click'], {\n          event: event\n        });\n      });\n      _defineProperty(_assertThisInitialized(_this), \"_onPointer\", function (event) {\n        return _this.DS.publish(['Selectable:pointer:pre', 'Selectable:pointer'], {\n          event: event\n        });\n      });\n      _defineProperty(_assertThisInitialized(_this), \"addAll\", function (elements) {\n        return elements.forEach(function (el) {\n          return _this.add(el);\n        });\n      });\n      _defineProperty(_assertThisInitialized(_this), \"deleteAll\", function (elements) {\n        return elements.forEach(function (el) {\n          return _this[\"delete\"](el);\n        });\n      });\n      _defineProperty(_assertThisInitialized(_this), \"getRect\", function (element) {\n        return _this._rects ? _this.rects.get(element) : element.getBoundingClientRect();\n      });\n      _this.DS = DS;\n      _this.Settings = DS.stores.SettingsStore.s;\n      _this.DS.subscribe('Interaction:init', _this.init);\n      // @ts-ignore: @todo: update to typescript\n      _this.DS.PubSub.subscribe('Settings:updated:selectables', function () {\n        _this.clear();\n        _this.init();\n      });\n      // @ts-ignore: @todo: update to typescript\n      _this.DS.subscribe('Settings:updated:selectableClass', function (_ref2) {\n        var settings = _ref2.settings;\n        _this.forEach(function (el) {\n          el.classList.remove(settings['selectableClass:pre']);\n          el.classList.add(settings.selectableClass);\n        });\n      });\n      return _this;\n    }\n    _createClass(SelectableSet, [{\n      key: \"add\",\n      value:\n      /** \n       * @param {DSElement} element\n       * @return {this}\n       * */\n      function add(element) {\n        if (_get(_getPrototypeOf(SelectableSet.prototype), \"has\", this).call(this, element)) return this;\n        var publishData = {\n          items: this.elements,\n          item: element\n        };\n        this.DS.publish('Selectable:added:pre', publishData);\n        element.classList.add(this.Settings.selectableClass);\n        element.addEventListener('click', this._onClick);\n        if (this.Settings.usePointerEvents) element.addEventListener('pointerdown', this._onPointer, {\n          // @ts-ignore\n          passive: false\n        });else element.addEventListener('mousedown', this._onPointer);\n        element.addEventListener('touchstart', this._onPointer, {\n          // @ts-ignore\n          passive: false\n        });\n        if (this.Settings.draggability && !this.Settings.useTransform) handleElementPositionAttribute({\n          computedStyle: window.getComputedStyle(element),\n          node: element\n        });\n        _get(_getPrototypeOf(SelectableSet.prototype), \"add\", this).call(this, element);\n        this.DS.publish('Selectable:added', publishData);\n        return this;\n      }\n\n      /** @param {DSElement} element */\n    }, {\n      key: \"delete\",\n      value: function _delete(element) {\n        if (!_get(_getPrototypeOf(SelectableSet.prototype), \"has\", this).call(this, element)) return true;\n        var publishData = {\n          items: this.elements,\n          item: element\n        };\n        this.DS.publish('Selectable:removed:pre', publishData);\n        element.classList.remove(this.Settings.selectableClass);\n        element.classList.remove(this.Settings.hoverClass);\n        element.removeEventListener('click', this._onClick);\n        if (this.Settings.usePointerEvents) element.removeEventListener('pointerdown', this._onPointer, {\n          // @ts-ignore\n          passive: false\n        });else element.removeEventListener('mousedown', this._onPointer);\n        element.removeEventListener('touchstart', this._onPointer, {\n          // @ts-ignore\n          passive: false\n        });\n        _get(_getPrototypeOf(SelectableSet.prototype), \"delete\", this).call(this, element);\n        this.DS.publish('Selectable:removed', publishData);\n        return true;\n      }\n    }, {\n      key: \"elements\",\n      get: /** @return {DSElements} */\n      function get() {\n        return Array.from(this.values());\n      }\n    }, {\n      key: \"rects\",\n      get: function get() {\n        var _this2 = this;\n        if (this._rects) return this._rects;\n        this._rects = new Map();\n        this.forEach(function (element) {\n          return _this2._rects.set(element, element.getBoundingClientRect());\n        });\n\n        // since elements can be moved, we need to update the rects every X ms\n        if (this._timeout) clearTimeout(this._timeout);\n        this._timeout = setTimeout(function () {\n          return _this2._rects = null;\n        }, this.Settings.refreshMemoryRate);\n        return this._rects;\n      }\n    }]);\n    return SelectableSet;\n  }( /*#__PURE__*/_wrapNativeSuper(Set));\n\n  var SelectedSet = /*#__PURE__*/function (_Set) {\n    _inherits(SelectedSet, _Set);\n    var _super = _createSuper(SelectedSet);\n    /**\n     * @constructor SelectableSet\n     * @param {{DS:DragSelect}} obj\n     * @ignore\n     */\n    function SelectedSet(_ref) {\n      var _this;\n      var DS = _ref.DS;\n      _classCallCheck(this, SelectedSet);\n      _this = _super.call(this);\n      _defineProperty(_assertThisInitialized(_this), \"clear\", function () {\n        return _this.forEach(function (el) {\n          return _this[\"delete\"](el);\n        });\n      });\n      _defineProperty(_assertThisInitialized(_this), \"addAll\", function (elements) {\n        return elements.forEach(function (el) {\n          return _this.add(el);\n        });\n      });\n      _defineProperty(_assertThisInitialized(_this), \"deleteAll\", function (elements) {\n        return elements.forEach(function (el) {\n          return _this[\"delete\"](el);\n        });\n      });\n      _this.DS = DS;\n      return _this;\n    }\n\n    /** \n     * @param {DSElement} element\n     * @return {this}\n     * */\n    _createClass(SelectedSet, [{\n      key: \"add\",\n      value: function add(element) {\n        if (_get(_getPrototypeOf(SelectedSet.prototype), \"has\", this).call(this, element)) return this;\n        var publishData = {\n          items: this.elements,\n          item: element\n        };\n        this.DS.publish('Selected:added:pre', publishData);\n        _get(_getPrototypeOf(SelectedSet.prototype), \"add\", this).call(this, element);\n        element.classList.add(this.DS.stores.SettingsStore.s.selectedClass);\n        element.style.zIndex = \"\".concat((parseInt(element.style.zIndex) || 0) + 1);\n        this.DS.publish('Selected:added', publishData);\n        return this;\n      }\n\n      /** @param {DSElement} element */\n    }, {\n      key: \"delete\",\n      value: function _delete(element) {\n        if (!_get(_getPrototypeOf(SelectedSet.prototype), \"has\", this).call(this, element)) return true;\n        var publishData = {\n          items: this.elements,\n          item: element\n        };\n        this.DS.publish('Selected:removed:pre', publishData);\n        var deleted = _get(_getPrototypeOf(SelectedSet.prototype), \"delete\", this).call(this, element);\n        element.classList.remove(this.DS.stores.SettingsStore.s.selectedClass);\n        element.style.zIndex = \"\".concat((parseInt(element.style.zIndex) || 0) - 1);\n        this.DS.publish('Selected:removed', publishData);\n        return deleted;\n      }\n    }, {\n      key: \"toggle\",\n      value:\n      /**\n       * Adds/Removes an element. If it is already selected = remove, if not = add.\n       * @param {DSElement} element\n       * @return {DSElement}\n       */\n      function toggle(element) {\n        if (this.has(element)) this[\"delete\"](element);else this.add(element);\n        return element;\n      }\n\n      /** @param {DSElements} elements */\n    }, {\n      key: \"elements\",\n      get: /** @return {DSElements} */\n      function get() {\n        return Array.from(this.values());\n      }\n    }]);\n    return SelectedSet;\n  }( /*#__PURE__*/_wrapNativeSuper(Set));\n\n  var Selection = /*#__PURE__*/function () {\n    /**\n     * @type {Set}\n     * @private\n     * */\n\n    /**\n     * @constructor Selection\n     * @param {{ DS:DragSelect }} p\n     * @ignore\n     */\n    function Selection(_ref) {\n      var _this = this;\n      var DS = _ref.DS;\n      _classCallCheck(this, Selection);\n      _defineProperty(this, \"_prevSelectedSet\", void 0);\n      _defineProperty(this, \"start\", function (_ref2) {\n        var event = _ref2.event,\n          isDragging = _ref2.isDragging;\n        if (isDragging) return;\n        _this._storePrevious(event);\n        _this._handleInsideSelection(true, event);\n      });\n      _defineProperty(this, \"update\", function (_ref3) {\n        var isDragging = _ref3.isDragging;\n        if (isDragging || _this.DS[\"continue\"]) return;\n        _this._handleInsideSelection();\n      });\n      _defineProperty(this, \"_handleInsideSelection\", function (force, event) {\n        var _this$DS = _this.DS,\n          SelectableSet = _this$DS.SelectableSet,\n          SelectorArea = _this$DS.SelectorArea,\n          Selector = _this$DS.Selector;\n        var multiSelectionToggle = _this.DS.stores.KeyStore.isMultiSelectKeyPressed(event) && _this.Settings.multiSelectToggling;\n        var selectionThreshold = _this.Settings.selectionThreshold;\n\n        /** @type {any} */\n        var elRects = SelectableSet.rects;\n        var selectorRect = Selector.rect;\n\n        /** @type {Map<DSElement,DSBoundingRect>} */\n        var select = new Map();\n        /** @type {Map<DSElement,DSBoundingRect>} */\n        var unselect = new Map();\n        var _iterator = _createForOfIteratorHelper(elRects),\n          _step;\n        try {\n          for (_iterator.s(); !(_step = _iterator.n()).done;) {\n            var _step$value = _slicedToArray(_step.value, 2),\n              element = _step$value[0],\n              elementRect = _step$value[1];\n            if (!SelectorArea.isInside(element, elementRect)) continue;\n            if (isCollision(elementRect, selectorRect, selectionThreshold)) select.set(element, elementRect);else unselect.set(element, elementRect);\n          }\n        } catch (err) {\n          _iterator.e(err);\n        } finally {\n          _iterator.f();\n        }\n        if (_this.DS[\"continue\"]) return;\n        var _this$filterSelected = _this.filterSelected({\n            select: select,\n            unselect: unselect,\n            selectorRect: selectorRect\n          }),\n          filteredSelect = _this$filterSelected.select,\n          filteredUnselect = _this$filterSelected.unselect;\n        filteredSelect.forEach(function (_, element) {\n          return handleSelection({\n            element: element,\n            force: force,\n            multiSelectionToggle: multiSelectionToggle,\n            SelectedSet: _this.DS.SelectedSet,\n            hoverClassName: _this.Settings.hoverClass\n          });\n        });\n        filteredUnselect.forEach(function (_, element) {\n          return handleUnSelection({\n            element: element,\n            force: force,\n            SelectedSet: _this.DS.SelectedSet,\n            hoverClassName: _this.Settings.hoverClass,\n            PrevSelectedSet: _this._prevSelectedSet\n          });\n        });\n      });\n      _defineProperty(this, \"filterSelected\", function (_ref4) {\n        var select = _ref4.select,\n          unselect = _ref4.unselect;\n          _ref4.selectorRect;\n        return {\n          select: select,\n          unselect: unselect\n        };\n      });\n      this.DS = DS;\n      this.Settings = this.DS.stores.SettingsStore.s;\n      this.DS.subscribe('Interaction:start', this.start);\n      this.DS.subscribe('Interaction:update', this.update);\n    }\n\n    /**\n     * Stores the previous selection (solves #9)\n     * @param {DSEvent} event\n     * @private\n     * */\n    _createClass(Selection, [{\n      key: \"_storePrevious\",\n      value: function _storePrevious(event) {\n        var _this$DS2 = this.DS,\n          KeyStore = _this$DS2.stores.KeyStore,\n          SelectedSet = _this$DS2.SelectedSet;\n        if (KeyStore.isMultiSelectKeyPressed(event)) this._prevSelectedSet = new Set(SelectedSet);else this._prevSelectedSet = new Set();\n      }\n\n      /** @param {{event:DSEvent,isDragging:boolean}} event */\n    }]);\n    return Selection;\n  }();\n\n  var Selector = /*#__PURE__*/function () {\n    /**\n     * @type {DSBoundingRect}\n     * @private\n     */\n\n    /**\n     * @constructor Selector\n     * @param {{ DS:DragSelect }} p\n     * @ignore\n     */\n    function Selector(_ref) {\n      var _this = this;\n      var DS = _ref.DS;\n      _classCallCheck(this, Selector);\n      _defineProperty(this, \"_rect\", void 0);\n      _defineProperty(this, \"attachSelector\", function () {\n        var _this$DS$SelectorArea, _this$DS$SelectorArea2;\n        if (_this.HTMLNode && (_this$DS$SelectorArea = _this.DS.SelectorArea) !== null && _this$DS$SelectorArea !== void 0 && _this$DS$SelectorArea.HTMLNode) _this.DS.SelectorArea.HTMLNode.removeChild(_this.HTMLNode);\n        _this.HTMLNode = _this.DS.stores.SettingsStore.s.selector || createSelectorElement(_this.DS.stores.SettingsStore.s.customStyles);\n        _this.HTMLNode.classList.add(_this.DS.stores.SettingsStore.s.selectorClass);\n        if (_this.HTMLNode && (_this$DS$SelectorArea2 = _this.DS.SelectorArea) !== null && _this$DS$SelectorArea2 !== void 0 && _this$DS$SelectorArea2.HTMLNode) _this.DS.SelectorArea.HTMLNode.appendChild(_this.HTMLNode);\n      });\n      _defineProperty(this, \"start\", function (_ref2) {\n        var isDragging = _ref2.isDragging;\n        if (isDragging) return;\n        var PointerStore = _this.DS.stores.PointerStore;\n        var pPos = PointerStore.initialValArea;\n        updateElementStylePos(_this.HTMLNode, vect2rect(pPos, 1));\n        _this.HTMLNode.style.display = 'block';\n        _this._rect = null;\n      });\n      _defineProperty(this, \"stop\", function () {\n        _this.HTMLNode.style.width = '0';\n        _this.HTMLNode.style.height = '0';\n        _this.HTMLNode.style.display = 'none';\n      });\n      _defineProperty(this, \"update\", function (_ref3) {\n        var isDragging = _ref3.isDragging;\n        if (isDragging || _this.DS[\"continue\"]) return;\n        var _this$DS$stores = _this.DS.stores,\n          ScrollStore = _this$DS$stores.ScrollStore,\n          PointerStore = _this$DS$stores.PointerStore;\n        var pos = getSelectorPosition({\n          scrollAmount: ScrollStore.scrollAmount,\n          initialPointerPos: PointerStore.initialValArea,\n          pointerPos: PointerStore.currentValArea\n        });\n        updateElementStylePos(_this.HTMLNode, pos);\n        _this._rect = null;\n      });\n      this.DS = DS;\n\n      // @ts-ignore: @todo: update to typescript\n      this.DS.subscribe('Settings:updated:selectorClass', function (_ref4) {\n        var settings = _ref4.settings;\n        _this.HTMLNode.classList.remove(settings['selectorClass:pre']);\n        _this.HTMLNode.classList.add(settings.selectorClass);\n      });\n      // @ts-ignore: @todo: update to typescript\n      this.DS.subscribe('Settings:updated:selector', this.attachSelector);\n      // @ts-ignore: @todo: update to typescript\n      this.DS.subscribe('Settings:updated:customStyles', this.attachSelector);\n      this.attachSelector();\n      this.DS.subscribe('Interaction:start', this.start);\n      this.DS.subscribe('Interaction:update', this.update);\n      this.DS.subscribe('Interaction:end', this.stop);\n    }\n    _createClass(Selector, [{\n      key: \"rect\",\n      get: function get() {\n        if (this._rect) return this._rect;\n        return this._rect = this.HTMLNode.getBoundingClientRect();\n      }\n    }]);\n    return Selector;\n  }();\n\n  var SelectorArea = /*#__PURE__*/function () {\n    /**\n     * @type {*}\n     * @private\n     * */\n\n    /**\n     * @type {DSBoundingRect}\n     * @private\n     */\n\n    /**\n     * @type {DSEdges}\n     * @private\n     */\n\n    /**\n     * @class SelectorArea\n     * @constructor SelectorArea\n     * @param {{ DS:DragSelect }} obj\n     * @ignore\n     */\n    function SelectorArea(_ref) {\n      var _this = this;\n      var DS = _ref.DS;\n      _classCallCheck(this, SelectorArea);\n      _defineProperty(this, \"_scrollInterval\", void 0);\n      _defineProperty(this, \"_rect\", void 0);\n      _defineProperty(this, \"currentEdges\", []);\n      _defineProperty(this, \"start\", function () {\n        _this.applyElements('append');\n        _this.updatePos();\n      });\n      _defineProperty(this, \"applyElements\", function () {\n        var method = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 'append';\n        var docEl = document.body ? 'body' : 'documentElement';\n        var methodName = \"\".concat(method, \"Child\");\n        _this.HTMLNode[methodName](_this.DS.Selector.HTMLNode);\n        document[docEl][methodName](_this.HTMLNode);\n      });\n      _defineProperty(this, \"updatePos\", function () {\n        _this._rect = null;\n        var rect = _this.DS.Area.rect;\n        var border = _this.DS.Area.computedBorder;\n        var style = _this.HTMLNode.style;\n        var top = \"\".concat(rect.top + border.top, \"px\");\n        var left = \"\".concat(rect.left + border.left, \"px\");\n        var width = \"\".concat(rect.width, \"px\");\n        var height = \"\".concat(rect.height, \"px\");\n        if (style.top !== top) style.top = top;\n        if (style.left !== left) style.left = left;\n        if (style.width !== width) style.width = width;\n        if (style.height !== height) style.height = height;\n      });\n      _defineProperty(this, \"stop\", function (remove) {\n        _this.stopAutoScroll();\n        if (remove) _this.applyElements('remove');\n      });\n      _defineProperty(this, \"startAutoScroll\", function () {\n        _this.currentEdges = [];\n        _this._scrollInterval = setInterval(function () {\n          return _this.handleAutoScroll();\n        }, 16);\n      });\n      _defineProperty(this, \"handleAutoScroll\", function () {\n        if (_this.DS[\"continue\"]) return;\n        var _this$DS = _this.DS,\n          PointerStore = _this$DS.stores.PointerStore,\n          Area = _this$DS.Area;\n        _this.currentEdges = getOverflowEdges({\n          elementRect: vect2rect(PointerStore.currentVal),\n          containerRect: _this.rect,\n          tolerance: _this.DS.stores.SettingsStore.s.overflowTolerance\n        });\n        if (_this.currentEdges.length) Area.scroll(_this.currentEdges, _this.DS.stores.SettingsStore.s.autoScrollSpeed);\n      });\n      _defineProperty(this, \"stopAutoScroll\", function () {\n        _this.currentEdges = [];\n        clearInterval(_this._scrollInterval);\n      });\n      _defineProperty(this, \"isInside\", function (element, elementRect) {\n        if (_this.DS.Area.HTMLNode.contains(element) && _this.DS.stores.ScrollStore.canScroll) return true;\n        return isCollision(_this.rect, elementRect || element.getBoundingClientRect());\n      });\n      this.DS = DS;\n      this.HTMLNode = createSelectorAreaElement();\n      // @ts-ignore: @todo: update to typescript\n      this.DS.subscribe('Settings:updated:selectorAreaClass', function (_ref2) {\n        var settings = _ref2.settings;\n        _this.HTMLNode.classList.remove(settings['selectorAreaClass:pre']);\n        _this.HTMLNode.classList.add(settings['selectorAreaClass']);\n      });\n      this.HTMLNode.classList.add(this.DS.stores.SettingsStore.s.selectorAreaClass);\n      this.DS.subscribe('Area:modified', this.updatePos);\n      this.DS.subscribe('Area:modified', this.updatePos);\n      this.DS.subscribe('Interaction:init', this.start);\n      this.DS.subscribe('Interaction:start', this.startAutoScroll);\n      this.DS.subscribe('Interaction:end', function () {\n        _this.updatePos();\n        _this.stopAutoScroll();\n      });\n    }\n    _createClass(SelectorArea, [{\n      key: \"isClicked\",\n      value:\n      /**\n       * checks if the click was triggered on the area.\n       * @param {DSEvent} [event]\n       * @returns {boolean}\n       */\n      function isClicked(event) {\n        var PointerStore = this.DS.stores.PointerStore;\n        var initialVal = event ? PointerStore.getPointerPosition(event) : PointerStore.initialVal;\n        return isCollision({\n          left: initialVal.x,\n          top: initialVal.y,\n          right: initialVal.x,\n          bottom: initialVal.y\n        }, this.rect);\n      }\n    }, {\n      key: \"rect\",\n      get: function get() {\n        if (this._rect) return this._rect;\n        return this._rect = this.HTMLNode.getBoundingClientRect();\n      }\n    }]);\n    return SelectorArea;\n  }();\n\n  var KeyStore = /*#__PURE__*/function () {\n    /**\n     * @type {Set<string>}\n     * @private\n     * */\n\n    /**\n     * @type {{control:string,shift:string,meta:string}}\n     * @private\n     * */\n\n    /**\n     * @class KeyStore\n     * @constructor KeyStore\n     * @param {{DS:DragSelect}} p\n     * @ignore\n     */\n    function KeyStore(_ref) {\n      var _this = this;\n      var DS = _ref.DS;\n      _classCallCheck(this, KeyStore);\n      _defineProperty(this, \"_currentValues\", new Set());\n      _defineProperty(this, \"_keyMapping\", {\n        control: 'ctrlKey',\n        shift: 'shiftKey',\n        meta: 'metaKey'\n      });\n      _defineProperty(this, \"init\", function () {\n        document.addEventListener('keydown', _this.keydown);\n        document.addEventListener('keyup', _this.keyup);\n        window.addEventListener('blur', _this.reset);\n      });\n      _defineProperty(this, \"keydown\", function (event) {\n        var key = event.key.toLowerCase();\n        _this.DS.publish('KeyStore:down:pre', {\n          event: event,\n          key: key\n        });\n        _this._currentValues.add(key);\n        _this.DS.publish('KeyStore:down', {\n          event: event,\n          key: key\n        });\n      });\n      _defineProperty(this, \"keyup\", function (event) {\n        var key = event.key.toLowerCase();\n        _this.DS.publish('KeyStore:up:pre', {\n          event: event,\n          key: key\n        });\n        _this._currentValues[\"delete\"](key);\n        _this.DS.publish('KeyStore:up', {\n          event: event,\n          key: key\n        });\n      });\n      _defineProperty(this, \"stop\", function () {\n        document.removeEventListener('keydown', _this.keydown);\n        document.removeEventListener('keyup', _this.reset);\n        window.removeEventListener('blur', _this.reset);\n        _this.reset();\n      });\n      _defineProperty(this, \"reset\", function () {\n        return _this._currentValues.clear();\n      });\n      this.DS = DS;\n      this.DS.subscribe('Interaction:init', this.init);\n    }\n    _createClass(KeyStore, [{\n      key: \"isMultiSelectKeyPressed\",\n      value: /** @param {KeyboardEvent|MouseEvent|PointerEvent|TouchEvent} [event] */\n      function isMultiSelectKeyPressed(event) {\n        var _this2 = this;\n        if (this.DS.stores.SettingsStore.s.multiSelectMode) return true;\n        var multiSelectKeys = this.DS.stores.SettingsStore.s.multiSelectKeys.map(function (key) {\n          return key.toLocaleLowerCase();\n        });\n        if (this.currentValues.some(function (key) {\n          return multiSelectKeys.includes(key.toLocaleLowerCase());\n        })) return true;\n        if (event && multiSelectKeys.some(function (key) {\n          return event[_this2._keyMapping[key]];\n        })) return true;\n        return false;\n      }\n    }, {\n      key: \"currentValues\",\n      get: function get() {\n        return Array.from(this._currentValues.values());\n      }\n    }]);\n    return KeyStore;\n  }();\n\n  var PointerStore = /*#__PURE__*/function () {\n    /** @type {boolean} */\n\n    // Pointer Positions within Area\n    /**\n     * @type {Vect2}\n     * @private\n     * */\n\n    /**\n     * @type {Vect2}\n     * @private\n     * */\n\n    /**\n     * @type {Vect2}\n     * @private\n     * */\n\n    // General Pointer Position\n    /**\n     * @type {Vect2}\n     * @private\n     * */\n\n    /**\n     * @type {Vect2}\n     * @private\n     * */\n\n    /**\n     * @type {Vect2}\n     * @private\n     * */\n\n    /**\n     * @type {TouchEvent}\n     * @private\n     * */\n\n    /**\n     * @class PointerStore\n     * @constructor PointerStore\n     * @param {{DS:DragSelect}} p\n     * @ignore\n     */\n    function PointerStore(_ref) {\n      var _this = this;\n      var DS = _ref.DS;\n      _classCallCheck(this, PointerStore);\n      _defineProperty(this, \"_isMouseInteraction\", false);\n      _defineProperty(this, \"_initialValArea\", void 0);\n      _defineProperty(this, \"_currentValArea\", void 0);\n      _defineProperty(this, \"_lastValArea\", void 0);\n      _defineProperty(this, \"_initialVal\", void 0);\n      _defineProperty(this, \"_currentVal\", void 0);\n      _defineProperty(this, \"_lastVal\", void 0);\n      _defineProperty(this, \"_lastTouch\", void 0);\n      _defineProperty(this, \"init\", function () {\n        if (_this.Settings.usePointerEvents) document.addEventListener('pointermove', _this.update, {\n          // @ts-ignore\n          passive: false\n        });else document.addEventListener('mousemove', _this.update);\n        document.addEventListener('touchmove', _this.update, {\n          // @ts-ignore\n          passive: false\n        });\n      });\n      _defineProperty(this, \"getPointerPosition\", function (event) {\n        return getPointerPos({\n          event: _this._normalizedEvent(event)\n        });\n      });\n      _defineProperty(this, \"update\", function (event) {\n        if (!event) return;\n        _this.DS.publish('PointerStore:updated:pre', {\n          event: event\n        });\n        _this.currentVal = _this.getPointerPosition(event);\n        if (!_this._isMouseInteraction) return;\n        _this.DS.publish('PointerStore:updated', {\n          event: event\n        });\n      });\n      _defineProperty(this, \"stop\", function () {\n        // @TODO: fix pointer events mixing issue see [PR](https://github.com/ThibaultJanBeyer/DragSelect/pull/128#issuecomment-1154885289)\n        if (_this.Settings.usePointerEvents) document.removeEventListener('pointermove', _this.update, {\n          // @ts-ignore\n          passive: false\n        });else document.removeEventListener('mousemove', _this.update);\n        document.removeEventListener('touchmove', _this.update, {\n          // @ts-ignore\n          passive: false\n        });\n        // debounce in order \"onClick\" to work\n        setTimeout(function () {\n          return _this._isMouseInteraction = false;\n        }, 100);\n      });\n      _defineProperty(this, \"reset\", function (event) {\n        if (!event) return;\n        _this.currentVal = _this.lastVal = _this.getPointerPosition(event);\n        _this.stop();\n        _this.init();\n      });\n      this.DS = DS;\n      this.Settings = DS.stores.SettingsStore.s;\n      this.DS.subscribe('Interaction:init', this.init);\n      this.DS.subscribe('Interaction:start', function (_ref2) {\n        var event = _ref2.event;\n        return _this.start(event);\n      });\n      this.DS.subscribe('Interaction:end', function (_ref3) {\n        var event = _ref3.event;\n        return _this.reset(event);\n      });\n    }\n    _createClass(PointerStore, [{\n      key: \"start\",\n      value: /** @param {DSEvent} [event] */\n      function start(event) {\n        if (!event) return;\n        this._isMouseInteraction = true;\n        this.currentVal = this.initialVal = this.getPointerPosition(event);\n      }\n\n      /** @param {DSEvent} event */\n    }, {\n      key: \"_normalizedEvent\",\n      value:\n      /**\n       * @param {DSEvent} event\n       * @return {MouseEvent|PointerEvent|Touch}\n       * @private\n       */\n      function _normalizedEvent(event) {\n        // touchend has not touches. so we take the last touch if a touchevent, we need to store the positions\n        if ('touches' in event && event.type !== 'touchend') this._lastTouch = event;\n        // if a touchevent, return the last touch rather than the regular event\n        // we need .touches[0] from that event instead\n        return 'touches' in event ? this._lastTouch.touches[0] : event;\n      }\n\n      /** First recorded pointer position within the area */\n    }, {\n      key: \"initialValArea\",\n      get: function get() {\n        if (!this._initialValArea) return {\n          x: 0,\n          y: 0\n        };\n        return this._initialValArea;\n      }\n\n      /** Current pointer position within the area */\n    }, {\n      key: \"currentValArea\",\n      get: function get() {\n        if (!this._currentValArea) return {\n          x: 0,\n          y: 0\n        };\n        return this._currentValArea;\n      }\n\n      /** Last recorded pointer position within the area */\n    }, {\n      key: \"lastValArea\",\n      get: function get() {\n        if (!this._lastValArea) return {\n          x: 0,\n          y: 0\n        };\n        return this._lastValArea;\n      }\n\n      /** First recorded pointer position */\n    }, {\n      key: \"initialVal\",\n      get: function get() {\n        if (!this._initialVal) return {\n          x: 0,\n          y: 0\n        };\n        return this._initialVal;\n      }\n\n      /** Current pointer position */,\n      set: function set(value) {\n        this._initialVal = value;\n        this._initialValArea = value && calc(value, '-', calc(rect2vect(this.DS.Area.rect), '+', rect2vect(this.DS.Area.computedBorder)));\n      }\n    }, {\n      key: \"currentVal\",\n      get: function get() {\n        if (!this._currentVal) return {\n          x: 0,\n          y: 0\n        };\n        return this._currentVal;\n      }\n\n      /** Last recorded pointer position */,\n      set: function set(value) {\n        this._currentVal = value;\n        this._currentValArea = value && calc(value, '-', calc(rect2vect(this.DS.Area.rect), '+', rect2vect(this.DS.Area.computedBorder)));\n      }\n    }, {\n      key: \"lastVal\",\n      get: function get() {\n        if (!this._lastVal) return {\n          x: 0,\n          y: 0\n        };\n        return this._lastVal;\n      },\n      set: function set(value) {\n        this._lastVal = value;\n        this._lastValArea = value && calc(value, '-', calc(rect2vect(this.DS.Area.rect), '+', rect2vect(this.DS.Area.computedBorder)));\n      }\n    }]);\n    return PointerStore;\n  }();\n\n  var ScrollStore = /*#__PURE__*/function () {\n    /**\n     * @type {Vect2}\n     * @private */\n\n    /**\n     * @type {Vect2}\n     * @private */\n\n    /**\n     * @type {boolean}\n     * @private */\n\n    /**\n     * @class ScrollStore\n     * @constructor ScrollStore\n     * @param {{ DS:DragSelect }} p\n     * @ignore\n     */\n    function ScrollStore(_ref) {\n      var _this = this;\n      var DS = _ref.DS;\n      _classCallCheck(this, ScrollStore);\n      _defineProperty(this, \"_initialVal\", void 0);\n      _defineProperty(this, \"_currentVal\", void 0);\n      _defineProperty(this, \"_canScroll\", void 0);\n      _defineProperty(this, \"init\", function () {\n        return _this.DS.stores.SettingsStore.s.area.addEventListener('scroll', _this.update);\n      });\n      _defineProperty(this, \"start\", function () {\n        _this._currentVal = _this._initialVal = getCurrentScroll(_this.DS.stores.SettingsStore.s.area);\n        _this.DS.stores.SettingsStore.s.area.addEventListener('scroll', _this.update);\n      });\n      _defineProperty(this, \"update\", function () {\n        return _this._currentVal = getCurrentScroll(_this.DS.stores.SettingsStore.s.area);\n      });\n      _defineProperty(this, \"stop\", function () {\n        _this.DS.stores.SettingsStore.s.area.removeEventListener('scroll', _this.update);\n        _this._initialVal = {\n          x: 0,\n          y: 0\n        };\n        _this._canScroll = null;\n      });\n      _defineProperty(this, \"reset\", function () {\n        _this.stop();\n        _this.start();\n      });\n      this.DS = DS;\n      this.DS.subscribe('Interaction:init', this.init);\n      this.DS.subscribe('Interaction:start', function () {\n        return _this.start();\n      });\n      this.DS.subscribe('Interaction:end', function () {\n        return _this.reset();\n      });\n    }\n    _createClass(ScrollStore, [{\n      key: \"canScroll\",\n      get: function get() {\n        if (typeof this._canScroll === 'boolean') return this._canScroll;\n        return this._canScroll = canScroll(this.DS.stores.SettingsStore.s.area);\n      }\n    }, {\n      key: \"scrollAmount\",\n      get: function get() {\n        var scrollDiff = calc(this.currentVal, '-', this.initialVal);\n\n        // if area is zoomed, the scroll values are skewed, we need to fix that manually :(\n        var zoom = num2vect(this.DS.stores.SettingsStore.s.zoom);\n        var zoomScroll = calc(calc(scrollDiff, '*', zoom), '-', scrollDiff);\n        return {\n          x: scrollDiff.x + zoomScroll.x,\n          y: scrollDiff.y + zoomScroll.y\n        };\n      }\n    }, {\n      key: \"initialVal\",\n      get: function get() {\n        if (!this._initialVal) return {\n          x: 0,\n          y: 0\n        };\n        return this._initialVal;\n      }\n    }, {\n      key: \"currentVal\",\n      get: function get() {\n        if (!this._currentVal) this._currentVal = getCurrentScroll(this.DS.stores.SettingsStore.s.area);\n        return this._currentVal;\n      }\n    }]);\n    return ScrollStore;\n  }();\n\n  var SettingsStore = /*#__PURE__*/_createClass(\n  /**\n   * @type {Settings}\n   * @private\n   * */\n\n  /**\n   * Holds the settings and their previous value `:pre`\n   * @example {\n   *    autoScrollSpeed: 3,\n   *    'autoScrollSpeed:pre': 5\n   * }\n   * @type {Settings}\n   * */\n\n  /**\n   * @class ScrollStore\n   * @constructor ScrollStore\n   * @param {{ DS:DragSelect, settings:Settings }} p\n   * @ignore\n   */\n  function SettingsStore(_ref) {\n    var _this = this;\n    var DS = _ref.DS,\n      _settings2 = _ref.settings;\n    _classCallCheck(this, SettingsStore);\n    _defineProperty(this, \"_settings\", {});\n    _defineProperty(this, \"s\", {});\n    _defineProperty(this, \"update\", function (_ref2) {\n      var settings = _ref2.settings,\n        init = _ref2.init;\n      return _this.DS.publish('Settings:updated:pre', _objectSpread2({\n        settings: settings\n      }, init ? {\n        init: init\n      } : {}));\n    });\n    _defineProperty(this, \"_update\", function (_ref3) {\n      var settings = _ref3.settings,\n        init = _ref3.init;\n      var _settings = hydrateSettings(settings, init);\n      var _loop = function _loop() {\n        var _settings4;\n        var _Object$entries$_i = _slicedToArray(_Object$entries[_i], 2),\n          key = _Object$entries$_i[0],\n          value = _Object$entries$_i[1];\n        if (!(key in _this._settings)) {\n          Object.defineProperty(_this.s, key, {\n            get: function get() {\n              return _this._settings[key];\n            },\n            set: function set(newValue) {\n              return _this.update({\n                settings: _defineProperty({}, key, newValue)\n              });\n            }\n          });\n        }\n        _this._settings[\"\".concat(key, \":pre\")] = _this._settings[key];\n        _this._settings[key] = value;\n        var update = {\n          settings: (_settings4 = {}, _defineProperty(_settings4, key, _this._settings[key]), _defineProperty(_settings4, \"\".concat(key, \":pre\"), _this._settings[\"\".concat(key, \":pre\")]), _settings4)\n        };\n        _this.DS.publish('Settings:updated', update);\n        // @ts-ignore: @todo: update to typescript\n        _this.DS.publish(\"Settings:updated:\".concat(key), update);\n      };\n      for (var _i = 0, _Object$entries = Object.entries(_settings); _i < _Object$entries.length; _i++) {\n        _loop();\n      }\n    });\n    this.DS = DS;\n    this.DS.subscribe('Settings:updated:pre', this._update);\n    this.update({\n      settings: _settings2,\n      init: true\n    });\n  }\n\n  /** @param {{settings: Settings, init?: boolean}} props */);\n\n  // Setup\n  /// ///////////////////////////////////////////////////////////////////////////////////\n  var DragSelect = /*#__PURE__*/function () {\n    /**\n     * used to skip all current Selection and dragNdrop functionality\n     * @type {boolean}\n     */\n\n    /**\n     * @class DragSelect\n     * @constructor DragSelect\n     * @param {Settings} settings\n     */\n    function DragSelect(_settings) {\n      var _this = this;\n      _classCallCheck(this, DragSelect);\n      _defineProperty(this, \"continue\", false);\n      _defineProperty(this, \"start\", function () {\n        _this.stopped = false;\n        _this.Interaction.init();\n      });\n      _defineProperty(this, \"break\", function () {\n        return _this[\"continue\"] = true;\n      });\n      _defineProperty(this, \"setSettings\", function (settings) {\n        return _this.stores.SettingsStore.update({\n          settings: settings\n        });\n      });\n      _defineProperty(this, \"getSelection\", function () {\n        return _this.SelectedSet.elements;\n      });\n      _defineProperty(this, \"getSelectables\", function () {\n        return _this.SelectableSet.elements;\n      });\n      _defineProperty(this, \"getInitialCursorPosition\", function () {\n        return _this.stores.PointerStore.initialVal;\n      });\n      _defineProperty(this, \"getCurrentCursorPosition\", function () {\n        return _this.stores.PointerStore.currentVal;\n      });\n      _defineProperty(this, \"getPreviousCursorPosition\", function () {\n        return _this.stores.PointerStore.lastVal;\n      });\n      _defineProperty(this, \"getInitialCursorPositionArea\", function () {\n        return _this.stores.PointerStore.initialValArea;\n      });\n      _defineProperty(this, \"getCurrentCursorPositionArea\", function () {\n        return _this.stores.PointerStore.currentValArea;\n      });\n      _defineProperty(this, \"getPreviousCursorPositionArea\", function () {\n        return _this.stores.PointerStore.lastValArea;\n      });\n      _defineProperty(this, \"isMultiSelect\", function (event) {\n        return _this.stores.KeyStore.isMultiSelectKeyPressed(event);\n      });\n      _defineProperty(this, \"isDragging\", function () {\n        return _this.Interaction.isDragging;\n      });\n      _defineProperty(this, \"getZoneByCoordinates\", function (coordinates) {\n        var _this$DropZones$getTa;\n        return (_this$DropZones$getTa = _this.DropZones.getTarget(coordinates)) === null || _this$DropZones$getTa === void 0 ? void 0 : _this$DropZones$getTa.toObject();\n      });\n      _defineProperty(this, \"getItemsDroppedByZoneId\", function (zoneId) {\n        return _this.DropZones.getItemsDroppedById(zoneId);\n      });\n      _defineProperty(this, \"getItemsInsideByZoneId\", function (zoneId, addClasses) {\n        return _this.DropZones.getItemsInsideById(zoneId, addClasses);\n      });\n      this.PubSub = new PubSub({\n        DS: this\n      });\n      this.subscribe = this.PubSub.subscribe;\n      this.unsubscribe = this.PubSub.unsubscribe;\n      this.publish = this.PubSub.publish;\n      this.stores = /** @type {{ SettingsStore:SettingsStore, PointerStore:PointerStore, ScrollStore:ScrollStore, KeyStore:KeyStore }} */{};\n      this.stores.SettingsStore = new SettingsStore({\n        DS: this,\n        settings: _settings\n      });\n      this.stores.PointerStore = new PointerStore({\n        DS: this\n      });\n      this.stores.ScrollStore = new ScrollStore({\n        DS: this\n      });\n      this.stores.KeyStore = new KeyStore({\n        DS: this\n      });\n      this.Area = new Area({\n        DS: this\n      });\n      this.Selector = new Selector({\n        DS: this\n      });\n      this.SelectorArea = new SelectorArea({\n        DS: this\n      });\n      this.SelectableSet = new SelectableSet({\n        DS: this\n      });\n      this.SelectedSet = new SelectedSet({\n        DS: this\n      });\n      this.Selection = new Selection({\n        DS: this\n      });\n      this.Drag = new Drag({\n        DS: this\n      });\n      this.DropZones = new DropZones({\n        DS: this\n      });\n      this.Interaction = new Interaction({\n        DS: this\n      });\n\n      // Subscriber Aliases\n      subscriberAliases({\n        subscribe: this.subscribe,\n        publish: this.publish,\n        SelectedSet: this.SelectedSet,\n        Interaction: this.Interaction,\n        DropZones: this.DropZones\n      });\n      this.subscribe('Interaction:end', function () {\n        return _this[\"continue\"] = false;\n      });\n      this.start();\n    }\n\n    // Useful methods for the user\n    /// ///////////////////////////////////////////////////////////////////////////////////\n    /**\n     * Initializes the functionality. Automatically triggered when created.\n     * Also, reset the functionality after a teardown\n     */\n    _createClass(DragSelect, [{\n      key: \"stop\",\n      value:\n      /**\n       * Complete function teardown\n       * Will teardown/stop the whole functionality\n       * @param {boolean} [remove] - if elements should be removed.\n       * @param {boolean} [fromSelection] - if elements should also be added/removed to the selection.\n       * @param {boolean} [withCallback] - if elements should also be added/removed to the selection.\n       */\n      function stop() {\n        var remove = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : true;\n        var fromSelection = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;\n        var withCallback = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n        if (withCallback) this.publish('callback', {\n          items: this.getSelection()\n        });\n        this.Interaction.stop();\n        this.Area.stop();\n        this.Drag.stop();\n        this.Selector.stop();\n        this.SelectorArea.stop(remove);\n        this.stores.KeyStore.stop();\n        this.stores.PointerStore.stop();\n        this.stores.ScrollStore.stop();\n        if (remove) this.SelectableSet.clear();\n        if (fromSelection) this.SelectedSet.clear();\n        this.stopped = true;\n      }\n\n      /**\n       * Utility to override DragSelect internal functionality:\n       * Break will skip the selection or dragging functionality (until after the callback) but let everything continue to run.\n       * Useful utility to write your own functionality/move/dragNdrop based on DragSelect pointer positions.\n       */\n    }, {\n      key: \"addSelection\",\n      value:\n      /**\n       * Adds several elements to the selection list also adds the specific classes and take into account all calculations.\n       * Does not clear the selection, in contrary to .setSelection. Can add multiple elements at once\n       * @param {DSInputElements} elements one or multiple elements\n       * @param {boolean} [triggerCallback] - if callback should be called\n       * @param {boolean} [dontAddToSelectables] - if element should not be added to the list of selectable elements\n       * @return {DSElements} all selected elements\n       */\n      function addSelection(elements) {\n        var triggerCallback = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n        var dontAddToSelectables = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n        this.SelectedSet.addAll(toArray(elements));\n        if (!dontAddToSelectables) this.addSelectables(elements);\n        if (triggerCallback) this.PubSub.publish('callback', {\n          items: this.getSelection()\n        });\n        return this.getSelection();\n      }\n\n      /**\n       * Removes specific elements from the selection\n       * Multiple elements can be given at once, in contrary to unselect\n       * @param {DSInputElements} elements one or multiple elements\n       * @param {boolean} [triggerCallback] - if callback should be called\n       * @param {boolean} [removeFromSelectables] - if element should be removed from the list of selectable elements\n       * @return {DSElements} all selected elements\n       */\n    }, {\n      key: \"removeSelection\",\n      value: function removeSelection(elements) {\n        var triggerCallback = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n        var removeFromSelectables = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n        this.SelectedSet.deleteAll(toArray(elements));\n        if (removeFromSelectables) this.removeSelectables(elements);\n        if (triggerCallback) this.PubSub.publish('callback', {\n          items: this.getSelection()\n        });\n        return this.getSelection();\n      }\n\n      /**\n       * Toggles specific elements from the selection:\n       * If element is not in selection it will be added, if it is already selected, it will be removed.\n       * Multiple elements can be given at once.\n       * @param {DSInputElements} elements one or multiple elements\n       * @param {boolean} [triggerCallback] - if callback should be called\n       * @param {boolean} [removeFromSelectables] - if element should not be added/removed to the list of selectable elements accordingly\n       * @return {DSElements} all selected elements\n       */\n    }, {\n      key: \"toggleSelection\",\n      value: function toggleSelection(elements) {\n        var _this2 = this;\n        var triggerCallback = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n        var removeFromSelectables = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n        toArray(elements).forEach(function (el) {\n          return _this2.SelectedSet.has(el) ? _this2.removeSelection(elements, triggerCallback, removeFromSelectables) : _this2.addSelection(elements, triggerCallback, removeFromSelectables);\n        });\n        if (triggerCallback) this.PubSub.publish('callback', {\n          items: this.getSelection()\n        });\n        return this.getSelection();\n      }\n\n      /**\n       * Sets the current selected elements and optionally run the callback\n       * By default, adds new elements also to the list of selectables\n       * @param {DSInputElements} elements – dom elements\n       * @param {boolean} [triggerCallback] - if callback should be called\n       * @param {boolean} [dontAddToSelectables] - if element should not be added to the list of selectable elements\n       * @return {DSElements}\n       */\n    }, {\n      key: \"setSelection\",\n      value: function setSelection(elements) {\n        var triggerCallback = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n        var dontAddToSelectables = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n        this.clearSelection();\n        this.addSelection(elements, triggerCallback, dontAddToSelectables);\n        return this.getSelection();\n      }\n\n      /**\n       * Unselect / Deselect all current selected Nodes\n       * @param {boolean} [triggerCallback] - if callback should be called\n       * @return {DSElements} this.selected, should be empty\n       */\n    }, {\n      key: \"clearSelection\",\n      value: function clearSelection() {\n        var triggerCallback = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n        this.SelectedSet.clear();\n        if (triggerCallback) this.PubSub.publish('callback', {\n          items: this.getSelection()\n        });\n        return this.getSelection();\n      }\n\n      /**\n       * Add elements that can be selected. No node is added twice\n       * @param {DSInputElements} elements dom element(s)\n       * @param {boolean} [addToSelection] if elements should also be added to current selection\n       * @param {boolean} [triggerCallback] - if callback should be called\n       * @return {DSInputElements} the added element(s)\n       */\n    }, {\n      key: \"addSelectables\",\n      value: function addSelectables(elements, addToSelection, triggerCallback) {\n        var els = toArray(elements);\n        this.SelectableSet.addAll(els);\n        if (addToSelection) this.SelectedSet.addAll(els);\n        if (triggerCallback) this.PubSub.publish('callback', {\n          items: this.getSelection()\n        });\n        return elements;\n      }\n\n      /**\n       * Gets all nodes that can potentially be selected\n       * @return {DSElements} this.selectables\n       */\n    }, {\n      key: \"setSelectables\",\n      value:\n      /**\n       * Sets all elements that can be selected.\n       * Removes all current selectables (& their respective classes).\n       * Adds the new set to the selectables set, thus replacing the original set.\n       * @param {DSInputElements} elements – dom element(s)\n       * @param {boolean} [removeFromSelection] if elements should also be removed from current selection\n       * @param {boolean} [addToSelection] if elements should also be added to current selection\n       * @return {DSInputElements} elements – the added element(s)\n       */\n      function setSelectables(elements) {\n        var removeFromSelection = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n        var addToSelection = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n        console.warn('[DragSelect] DEPRECATION \".setSelectables\" is deprecated and will be removed soon. Please use \"ds.setSettings({ selectables: << new dom elements >> })\" instead (see docs)');\n        this.removeSelectables(elements, removeFromSelection);\n        return this.addSelectables(elements, addToSelection);\n      }\n\n      /**\n       * Remove elements from the elements that can be selected.\n       * @param {DSInputElements} elements – dom element(s)\n       * @param {boolean} [removeFromSelection] if elements should also be removed from current selection\n       * @param {boolean} [triggerCallback] - if callback should be called\n       * @return {DSInputElements} the removed element(s)\n       */\n    }, {\n      key: \"removeSelectables\",\n      value: function removeSelectables(elements, removeFromSelection, triggerCallback) {\n        this.SelectableSet.deleteAll(toArray(elements));\n        if (removeFromSelection) this.removeSelection(elements);\n        if (triggerCallback) this.PubSub.publish('callback', {\n          items: this.getSelection()\n        });\n        return elements;\n      }\n\n      /** The starting/initial position of the cursor/selector @return {Vect2} */\n    }]);\n    return DragSelect;\n  }();\n  DragSelect.isCollision = isCollision;\n\n  return DragSelect;\n\n}));\n","module.exports = __WEBPACK_EXTERNAL_MODULE__370__;","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","/**\n * @license\n * Copyright 2022 MIT\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * @fileoverview Global data structure.\n */\n\nimport * as Blockly from 'blockly/core';\n\n/**\n * Weakmap for storing multidraggable objects for a given workspace (as a key).\n */\nexport const multiDraggableWeakMap = new WeakMap();\n\n/**\n * Set for storing the current selected blockSvg ids.\n */\nexport const dragSelectionWeakMap = new WeakMap();\n\n/**\n * Store the current selection mode.\n */\nexport const inMultipleSelectionModeWeakMap = new WeakMap();\n\n/**\n * Store the multi-select controls instances.\n */\nexport const multiselectControlsList = new Set();\n\n/**\n * Store the copy data.\n */\nexport const copyData = new Set();\n\n/**\n * Store the paste shortcut mode.\n */\nexport const inPasteShortcut = new WeakMap();\n\n/**\n * Store the copied connections list.\n */\nexport const connectionDBList = [];\n\n/**\n * Store the registered context menu list.\n */\nexport const registeredContextMenu = [];\n\n/**\n * Store the registered shortcut list.\n */\nexport const registeredShortcut = [];\n\n/**\n * Store the copy time.\n */\nlet timestamp = 0;\n\n// TODO: Update custom enum below into actual enum\n//  if plugin is updated to TypeScript.\n/**\n * Object holding the names of the default shortcut items.\n */\nexport const shortcutNames = Object.freeze({\n  MULTIDELETE: 'multiselectDelete',\n  MULTICOPY: 'multiselectCopy',\n  MULTICUT: 'multiselectCut',\n  MULTIPASTE: 'multiselectPaste',\n});\n\n/**\n * Check if the current selected blockSvg set already contains the parents.\n * @param {!Blockly.BlockSvg} block to check.\n * @param {boolean} move Whether or not in moving.\n * @returns {boolean} true if the block's parents are selected.\n */\nexport const hasSelectedParent = function(block, move = false) {\n  while (block) {\n    if (move) {\n      block = block.getParent();\n    } else {\n      block = block.getSurroundParent();\n    }\n\n    if (block && dragSelectionWeakMap.get(block.workspace).has(block.id)) {\n      return true;\n    }\n  }\n  return false;\n};\n\n/**\n * Returns the corresponding object related to the id in the workspace.\n * Currently only supports blocks and workspace comments\n * @param {!Blockly.Workspace} workspace to check.\n * @param {string} id The ID of the object\n * @returns {Blockly.IDraggable} The object that is draggable\n */\nexport const getByID = function(workspace, id) {\n  // TODO: Need to figure our if there is a way to determine\n  // type of draggable just from ID, or if we have to pass into\n  // getById functions for each type\n  if (workspace.getBlockById(id)) {\n    return workspace.getBlockById(id);\n  } else if (workspace.getCommentById(id)) {\n    return workspace.getCommentById(id);\n  }\n  return null;\n};\n\n/**\n * Store copy information for blocks in localStorage.\n */\nexport const dataCopyToStorage = function() {\n  const storage = [];\n  copyData.forEach((data) => {\n    delete data['source'];\n    storage.push(data);\n  });\n  timestamp = Date.now();\n  localStorage.setItem('blocklyStashMulti', JSON.stringify(storage));\n  localStorage.setItem('blocklyStashConnection',\n      JSON.stringify(connectionDBList));\n  localStorage.setItem('blocklyStashTime', timestamp);\n};\n\n/**\n * Get copy information for blocks from localStorage.\n */\nexport const dataCopyFromStorage = function() {\n  const storage = JSON.parse(localStorage.getItem('blocklyStashMulti'));\n  const connection = JSON.parse(localStorage.getItem('blocklyStashConnection'));\n  const time = localStorage.getItem('blocklyStashTime');\n  if (storage && parseInt(time) > timestamp) {\n    timestamp = time;\n    copyData.clear();\n    storage.forEach((data) => {\n      copyData.add(data);\n    });\n    connectionDBList.length = 0;\n    connection.forEach((data) => {\n      connectionDBList.push(data);\n    });\n  }\n};\n\n/**\n * Get blocks number in the clipboard from localStorage.\n * @param {boolean} useCopyPasteCrossTab Whether or not to use\n *     cross tab copy/paste.\n * @returns {number} The number of blocks in the clipboard.\n */\nexport const blockNumGetFromStorage = function(useCopyPasteCrossTab) {\n  if (!useCopyPasteCrossTab) {\n    return copyData.size;\n  }\n  const storage = JSON.parse(localStorage.getItem('blocklyStashMulti'));\n  const time = localStorage.getItem('blocklyStashTime');\n  if (storage && parseInt(time) > timestamp) {\n    return storage.length;\n  }\n  return copyData.size;\n};\n","/**\n * @license\n * Copyright 2024 MIT\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * @fileoverview Multiple selection draggable class.\n */\nimport * as Blockly from 'blockly/core';\nimport {dragSelectionWeakMap, hasSelectedParent, inMultipleSelectionModeWeakMap} from './global';\n\n\n/**\n * A draggable object that adds the functionality for multiple blocks to\n * be moved while someone is dragging it.\n * It implements the IDraggable interface in Blockly v11.\n */\nexport class MultiselectDraggable {\n  /**\n   * A constructor for the MultiselectDraggable class\n   * @param {Blockly.Workspace} workspace The workspace the\n   * multiselectDraggable object is located in.\n   */\n  constructor(workspace) {\n    this.workspace = workspace;\n    this.id = Blockly.utils.idGenerator.genUid();\n    this.subDraggables = new Map();\n    this.topSubDraggables = [];\n    this.loc = new Blockly.utils.Coordinate(0, 0);\n    this.connectionDBList = [];\n    this.dragSelection = dragSelectionWeakMap.get(workspace);\n  }\n\n  /**\n   * Clears everything in the subDraggables\n   * map of the MultiselectDraggable object.\n   */\n  clearAll_() {\n    for (const [subDraggable] of this.subDraggables) {\n      subDraggable.unselect();\n      this.removeSubDraggable_(subDraggable);\n    }\n  }\n\n  /**\n   * Adds a subDraggable to the multiselectDraggable object\n   * @param {Blockly.IDraggable} subDraggable A draggable object that\n   * is to be added to the multiselectDraggable object.\n   * @private\n   */\n  addSubDraggable_(subDraggable) {\n    if (!(subDraggable instanceof MultiselectDraggable)) {\n      this.addPointerDownEventListener_(subDraggable);\n    }\n    this.subDraggables.set(subDraggable, subDraggable.getRelativeToSurfaceXY());\n  }\n\n  /**\n   * Removes a subDraggable to the multiselectDraggable object\n   * @param {Blockly.IDraggable} subDraggable A draggable object that\n   * is to be removed from the multiselectDraggable object.\n   * @private\n   */\n  removeSubDraggable_(subDraggable) {\n    if (!(subDraggable instanceof MultiselectDraggable)) {\n      this.removePointerDownEventListener_(subDraggable);\n    }\n    this.subDraggables.delete(subDraggable);\n  }\n\n  // This is the feature where we added a pointer down event listener.\n  // This was added to mitigate the issue of setStart[draggable] overwriting\n  // the call that passes the multidraggable to Blockly.common.SetSelected().\n  // This should be updated/fixed when a more flexible gesture handling\n  // system is implemented.\n  // TODO: Look into these after gestures have been updated\n  /**\n   * Adds a pointer down event listener to a subdraggable to mitigate issue\n   * of setStart[draggable] overwriting the call that passes the\n   * multidraggable to Blockly.common.SetSelected().\n   * @param {Blockly.IDraggable} subDraggable A draggable object that will\n   * have an event listener added to\n   * @private\n   */\n  addPointerDownEventListener_(subDraggable) {\n    // Bind the handler to the correct context (class instance)\n    // i.e. it creates a new function where the 'this' of the new function\n    // is set to whatever is passed into the bind method argument.\n    // In this case, it is the multiselectDraggable class/object.\n    const handler = this.pointerDownEventHandler_.bind(this);\n\n    // Store the handler function in the subDraggable object\n    subDraggable.pointerDownHandler = handler;\n\n    // When adding/removing an event listener, we must pass in named functions\n    // as anonymous functions are different function instances in memory\n    subDraggable.getSvgRoot().addEventListener('pointerdown', handler);\n  }\n\n  /**\n   * Removes a pointer down event listener from a subdraggable to\n   * mitigate issue of setStart[draggable] overwriting the call that\n   *  passes the multidraggable to Blockly.common.SetSelected().\n   * @param {Blockly.IDraggable} subDraggable A draggable object\n   * that will have an event listener removed from\n   * @private\n   */\n  removePointerDownEventListener_(subDraggable) {\n    if (subDraggable) {\n      // Retrieve the stored handler function\n      const handler = subDraggable.pointerDownHandler;\n      if (handler) {\n        subDraggable.getSvgRoot().removeEventListener('pointerdown', handler);\n\n        // Clean up the stored handler reference\n        delete subDraggable.pointerDownHandler;\n      }\n    }\n  }\n\n  /**\n   * The handler for the pointer down event that mitigates\n   * the issue of setStart[draggable] overwriting the call that\n   * passes the multidraggable to Blockly.common.SetSelected().\n   * @param {PointerEvent} event A pointer down event\n   * @private\n   */\n  pointerDownEventHandler_(event) {\n    if (!inMultipleSelectionModeWeakMap.get(this.workspace)) {\n      Blockly.common.setSelected(this);\n    }\n  }\n\n  /**\n   * A method that determines whether the object is movable or not.\n   * @returns {boolean} Returns true as it is always movable\n   */\n  isMovable() {\n    if (inMultipleSelectionModeWeakMap.get(this.workspace)) {\n      return false;\n    }\n    return true;\n  }\n\n  /**\n   * Returns the current location of the multiselectDraggable\n   * in workspace coordinates.\n   * @returns {Blockly.utils.Coordinate} The coordinate of the current location\n   * on workspace (top left corner of multiselect-draggable)\n   */\n  getRelativeToSurfaceXY() {\n    return this.loc;\n  }\n\n  /**\n   * Starts a drag on the multiselectDraggable object if there\n   * are no other plugins that overwrite this method.\n   * It delegates the startDrag methods to the topmost subdraggables.\n   * @param {Blockly.Events.BLOCK_DRAG} e A drag event\n   */\n  startDrag(e) {\n    this.inGroup = !!Blockly.Events.getGroup();\n    if (!this.inGroup) {\n      Blockly.Events.setGroup(true);\n    }\n    for (const draggable of this.subDraggables) {\n      if (draggable[0] instanceof\n          Blockly.BlockSvg) {\n        // Save only the topmost subdraggables to do the drag on\n        // or if it is not any other draggable with parents/child\n        // relationships like workspace comments\n        if (!(hasSelectedParent(draggable[0], true))) {\n          this.topSubDraggables.push(draggable[0]);\n        }\n\n        // Save any connections between blocks of the same level\n        // (next statement)\n        if (!draggable[0].isShadow()) {\n          const parentBlock = draggable[0].getParent();\n          if (parentBlock && this.subDraggables.has(parentBlock) &&\n              parentBlock.getNextBlock() === draggable[0]) {\n            this.connectionDBList.push([parentBlock.nextConnection,\n              draggable[0].previousConnection]);\n          }\n        }\n      } else {\n        // If the draggable is not a block (e.g. ws comment)\n        this.topSubDraggables.push(draggable[0]);\n      }\n\n      this.subDraggables.set(draggable[0],\n          draggable[0].getRelativeToSurfaceXY());\n    }\n    for (const draggable of this.topSubDraggables) {\n      draggable.startDrag();\n    }\n  }\n\n  /**\n   * Drags the subdraggables of the multiselectDraggable object if\n   * there are no other plugins that overwrite this method.\n   * It delegates the drag methods to the topmost subdraggables.\n   * @param {Blockly.utils.Coordinate} newLoc The new location the object\n   * is being moved to (in Blockly coordinates)\n   * @param {Blockly.Events.BLOCK_DRAG} e A drag event\n   */\n  drag(newLoc, e) {\n    for (const draggable of this.topSubDraggables) {\n      if (this.subDraggables.get(draggable) &&\n          this.subDraggables.get(draggable) instanceof\n          Blockly.utils.Coordinate) {\n        draggable.drag(Blockly.utils.Coordinate.sum(newLoc,\n            this.subDraggables.get(draggable)), e);\n      }\n    }\n  }\n\n  /**\n   * Ends the drag of the subdraggables of the multiselectDraggable\n   * object if there are no other plugins that overwrite this method.\n   * It delegates the endDrag methods to the topmost subdraggables.\n   * @param {Blockly.Events.BLOCK_DRAG} e A drag event\n   */\n  endDrag(e) {\n    for (const draggable of this.topSubDraggables) {\n      draggable.endDrag(e);\n    }\n\n    for (const draggable of this.subDraggables) {\n      // Update location of subdraggables\n      draggable[1] = draggable[0].getRelativeToSurfaceXY();\n    }\n\n    // Reconnect any connections between blocks that are\n    // on the same level (not child/parent)\n    this.connectionDBList.forEach(function(connectionDB) {\n      connectionDB[0].connect(connectionDB[1]);\n    });\n\n    this.topSubDraggables.length = 0;\n    this.connectionDBList.length = 0;\n    if (!this.inGroup) {\n      Blockly.Events.setGroup(false);\n    }\n  }\n\n  /**\n   * Reverts any drags done on the multiselectDraggable object.\n   */\n  revertDrag() {\n    for (const draggable of this.subDraggables) {\n      draggable[0].revertDrag();\n    }\n  }\n\n  // ISelectable methods\n  /**\n   * A function that updates the highlight selection\n   * of the subdraggables. Currently, this only updates\n   * the highlighting after multiselect mode is turned\n   * off. Look at updateDraggables_ method in\n   * multiselect_controls.js\n   */\n  select() {\n    // This needs to be worked on to see if we can make the\n    // highlighting of the subdraggables in real time.\n    for (const draggable of this.subDraggables) {\n      if (draggable[0] instanceof Blockly.BlockSvg &&\n          !draggable[0].isShadow()) {\n        draggable[0].select();\n      } else {\n        draggable[0].select();\n      }\n    }\n  }\n\n  /**\n   * A function that turns off the highlight selection\n   * of the subdraggables. Currently not used as it\n   * causes a bug when selecting a block by clicking\n   * while in multiselect mode.\n   */\n  unselect() {\n    // TODO: Look into this after gestures have been updated\n    // for (const draggable of this.subDraggables) {\n    //   draggable[0].unselect();\n    // }\n  }\n\n\n  // IDeletable methods\n  /**\n   * A function that is required for the\n   * multiselectDraggable object to be deletable.\n   * @returns {boolean} Always true\n   */\n  isDeletable() {\n    return true;\n  }\n\n  /**\n   * Disposes all subdraggables in the multiselectDraggable object.\n   */\n  dispose() {\n    for (const draggable of this.subDraggables) {\n      if (!draggable[0].isDeletable()) {\n        continue;\n      }\n      this.removeSubDraggable_(draggable[0]);\n      this.dragSelection.delete(draggable[0].id);\n      if (draggable[0] instanceof Blockly.BlockSvg) {\n        draggable[0].dispose(true, true);\n      } else {\n        draggable[0].dispose();\n      }\n    }\n  }\n\n  /**\n   * Sets the delete style when we drag the multidraggable over a delete\n   * area.\n   * @param {boolean} enable A boolean that determines whether to set the\n   * delete style of the blocks.\n   */\n  setDeleteStyle(enable) {\n    // TODO: Check this after ws comment's setDeleteStyle is fixed\n    for (const draggable of this.subDraggables) {\n      if (draggable[0].isDeletable()) {\n        draggable[0].setDeleteStyle(enable);\n      }\n    }\n  }\n\n  /**\n   * Returns a rectangular bound for the multiselectDraggable\n   * object needed to be compatible with the Scroll Options plugin.\n   * @returns {Blockly.utils.Rect} A Blockly Rect that represents\n   * the bounds of the multiselectDraggable object.\n   */\n  getBoundingRectangle() {\n    if (this.subDraggables.size === 0) {\n      return new Blockly.utils.Rect(0, 0, 0, 0);\n    }\n\n    let top = Infinity;\n    let bottom = -Infinity;\n    let left = Infinity;\n    let right = -Infinity;\n\n    this.subDraggables.forEach((coord, subDraggable) => {\n      const boundingBox = subDraggable.getBoundingRectangle();\n      top = Math.min(top, boundingBox.top);\n      bottom = Math.max(bottom, boundingBox.bottom);\n      left = Math.min(left, boundingBox.left);\n      right = Math.max(right, boundingBox.right);\n    });\n\n    return new Blockly.utils.Rect(top, bottom, left, right);\n  }\n\n  // Backpack plugin support\n  /**\n   * Converts the subdraggables into flyout information for the\n   * backpack plugin.\n   * @returns {Blockly.utils.toolbox.FlyoutItemInfoArray} Returns an\n   * array of flyout info of subdraggables that can be placed\n   * in a flyout (i.e. blocks).\n   * Otherwise, it does not convert them into flyout info (i.e.\n   * ws comments).\n   */\n  toFlyoutInfo() {\n    const flyoutList = [];\n    for (const draggable of this.subDraggables) {\n      if (draggable[0].toFlyoutInfo !== undefined) {\n        const draggableFlyoutInfo = draggable[0].toFlyoutInfo();\n        flyoutList.push(...draggableFlyoutInfo);\n      }\n    }\n    return flyoutList;\n  }\n}\n","/**\n * @license\n * Copyright 2022 MIT\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * @fileoverview Multiple selection context menu.\n */\n\nimport * as Blockly from 'blockly/core';\nimport {\n  dragSelectionWeakMap, hasSelectedParent, copyData,\n  connectionDBList, dataCopyToStorage, dataCopyFromStorage,\n  blockNumGetFromStorage, registeredContextMenu, multiDraggableWeakMap, getByID,\n} from './global';\nimport {MultiselectDraggable} from './multiselect_draggable';\n\n/**\n * Copy multiple selected blocks to clipboard.\n * @param {boolean} useCopyPasteCrossTab Whether or not to use\n *     cross tab copy paste.\n */\nconst registerCopy = function(useCopyPasteCrossTab) {\n  const id = 'blockCopyToStorage';\n  const copyOptions = {\n    displayText: function(scope) {\n      let workableBlocksLength = 0;\n      const workspace = scope.block.workspace;\n      const dragSelection = dragSelectionWeakMap.get(workspace);\n      dragSelection.forEach(function(id) {\n        const block = workspace.getBlockById(id);\n        if (block && copyOptions.check(block)) {\n          workableBlocksLength++;\n        }\n      });\n      if (workableBlocksLength <= 1) {\n        return Blockly.Msg['CROSS_TAB_COPY']?\n        Blockly.Msg['CROSS_TAB_COPY'] : 'Copy';\n      } else {\n        return Blockly.Msg['CROSS_TAB_COPY_X_BLOCKS']?\n            Blockly.Msg['CROSS_TAB_COPY_X_BLOCKS'].replace(\n                '%1', workableBlocksLength) :\n            (Blockly.Msg['CROSS_TAB_COPY']?\n            Blockly.Msg['CROSS_TAB_COPY'] : 'Copy'\n            ) + ' (' +\n            workableBlocksLength + ')';\n      }\n    },\n    preconditionFn: function(scope) {\n      const workspace = scope.block.workspace;\n      if (workspace.options.readOnly && !useCopyPasteCrossTab) {\n        return 'hidden';\n      }\n      const selected = Blockly.common.getSelected();\n      const dragSelection = dragSelectionWeakMap.get(workspace);\n\n      // Fix the context menu error for backpack plugin\n      if (dragSelection === undefined) {\n        return 'hidden';\n      }\n\n      if (!dragSelection.size) {\n        if (copyOptions.check(selected)) {\n          return 'enabled';\n        } else {\n          return 'disabled';\n        }\n      }\n      for (const id of dragSelection) {\n        const block = workspace.getBlockById(id);\n        if (block && copyOptions.check(block)) {\n          return 'enabled';\n        }\n      }\n      return 'disabled';\n    },\n    check: function(block) {\n      return block && block.isDeletable() && block.isMovable() &&\n             !hasSelectedParent(block);\n    },\n    callback: function(scope) {\n      const workspace = scope.block.workspace;\n      copyData.clear();\n      workspace.hideChaff();\n      const blockList = [];\n      const apply = function(block) {\n        if (copyOptions.check(block)) {\n          copyData.add(JSON.stringify(block.toCopyData()));\n          blockList.push(block.id);\n        }\n      };\n      const selected = Blockly.common.getSelected();\n      const dragSelection = dragSelectionWeakMap.get(workspace);\n      Blockly.Events.setGroup(true);\n\n      // Handle the case where MultiselectDraggable is in use\n      if (selected && selected instanceof MultiselectDraggable) {\n        for (const element of selected.subDraggables) {\n          if (element[0] instanceof Blockly.BlockSvg) {\n            apply(element[0]);\n          }\n        }\n      } else if (!dragSelection.size) {\n        apply(selected);\n      }\n\n      connectionDBList.length = 0;\n      blockList.forEach(function(id) {\n        const block = workspace.getBlockById(id);\n        const parentBlock = block.getParent();\n        if (parentBlock && blockList.indexOf(parentBlock.id) !== -1 &&\n          parentBlock.getNextBlock() === block) {\n          connectionDBList.push([\n            blockList.indexOf(parentBlock.id),\n            blockList.indexOf(block.id)]);\n        }\n      });\n      if (useCopyPasteCrossTab) {\n        dataCopyToStorage();\n      }\n      Blockly.Events.setGroup(false);\n      return true;\n    },\n    scopeType: Blockly.ContextMenuRegistry.ScopeType.BLOCK,\n    id,\n    weight: 0,\n  };\n  if (Blockly.ContextMenuRegistry.registry.getItem(id) !== null) {\n    Blockly.ContextMenuRegistry.registry.unregister(id);\n  }\n  Blockly.ContextMenuRegistry.registry.register(copyOptions);\n};\n\n/**\n * Modification for context menu 'Duplicate' to be available for\n * multiple blocks.\n */\nconst registerDuplicate = function() {\n  const id = 'blockDuplicate';\n  const duplicateOption = {\n    displayText: function(scope) {\n      let workableBlocksLength = 0;\n      const workspace = scope.block.workspace;\n      const dragSelection = dragSelectionWeakMap.get(workspace);\n      dragSelection.forEach(function(id) {\n        const block = workspace.getBlockById(id);\n        if (duplicateOption.check(block)) {\n          workableBlocksLength++;\n        }\n      });\n      if (workableBlocksLength <= 1) {\n        return Blockly.Msg['DUPLICATE_BLOCK'];\n      } else {\n        return Blockly.Msg['DUPLICATE_X_BLOCKS']?\n            Blockly.Msg['DUPLICATE_X_BLOCKS'].replace(\n                '%1', workableBlocksLength) :\n            Blockly.Msg['DUPLICATE_BLOCK'] + ' (' +\n            workableBlocksLength + ')';\n      }\n    },\n    preconditionFn: function(scope) {\n      const block = scope.block;\n      if (!block.isInFlyout && block.isDeletable() && block.isMovable()) {\n        if (block.isDuplicatable()) {\n          return 'enabled';\n        }\n        return 'disabled';\n      }\n      return 'hidden';\n    },\n    // Only duplicate-able blocks will be duplicated.\n    check: function(block) {\n      return block &&\n             duplicateOption.preconditionFn({block: block}) === 'enabled' &&\n             !hasSelectedParent(block);\n    },\n    callback: function(scope) {\n      const duplicatedBlocks = {};\n      const connectionDBList = [];\n      const workspace = scope.block.workspace;\n      const multiDraggable = multiDraggableWeakMap.get(workspace);\n      const apply = function(block) {\n        if (duplicateOption.check(block)) {\n          // Generate a new unique ID\n          const newId = Blockly.utils.idGenerator.genUid();\n          // Get the copy data of the block\n          const blockCopyData = block.toCopyData();\n          // Set the new ID in the copy data\n          blockCopyData.blockState.id = newId;\n          // Paste the block with the modified copy data\n          duplicatedBlocks[block.id] =\n              Blockly.clipboard.paste(blockCopyData, workspace);\n        }\n      };\n      const dragSelection = dragSelectionWeakMap.get(workspace);\n      Blockly.Events.setGroup(true);\n\n      // We want to update the dragSelection and the multiDraggable object to\n      // remove subdraggables from the current selection prior to duplicating.\n      if (dragSelection.size) {\n        dragSelection.forEach(function(id) {\n          const block = workspace.getBlockById(id);\n          if (block) {\n            block.unselect();\n            if (!hasSelectedParent(block)) {\n              apply(block);\n            }\n          }\n        });\n        dragSelection.clear();\n        multiDraggable.clearAll_();\n        Blockly.common.setSelected(null);\n      } else {\n        apply(scope.block);\n      }\n\n      for (const [id, block] of Object.entries(duplicatedBlocks)) {\n        const origBlock = workspace.getBlockById(id);\n        const origParentBlock = origBlock.getParent();\n        if (block.id) {\n          if (origParentBlock && origParentBlock.id in duplicatedBlocks &&\n            origParentBlock.getNextBlock() === origBlock) {\n            connectionDBList.push([\n              duplicatedBlocks[origParentBlock.id].nextConnection,\n              block.previousConnection]);\n          }\n          if (block.type !== 'drag_to_dupe') {\n            dragSelection.add(block.id);\n            multiDraggable.addSubDraggable_(block);\n          }\n        }\n      }\n      connectionDBList.forEach(function(connectionDB) {\n        connectionDB[0].connect(connectionDB[1]);\n      });\n      Blockly.common.setSelected(multiDraggable);\n      Blockly.Events.setGroup(false);\n    },\n    scopeType: Blockly.ContextMenuRegistry.ScopeType.BLOCK,\n    id,\n    weight: 1,\n  };\n  if (Blockly.ContextMenuRegistry.registry.getItem(id) !== null) {\n    Blockly.ContextMenuRegistry.registry.unregister(id);\n  }\n  Blockly.ContextMenuRegistry.registry.register(duplicateOption);\n};\n\n/**\n * Modification for context menu 'Comment' to be available for multiple blocks.\n */\nconst registerBlockComment = function() {\n  const id = 'blockComment';\n  const commentOption = {\n    displayText: function(scope) {\n      let workableBlocksLength = 0;\n      const state = scope.block.hasIcon(Blockly.icons.CommentIcon.TYPE);\n      const workspace = scope.block.workspace;\n      const dragSelection = dragSelectionWeakMap.get(workspace);\n      dragSelection.forEach(function(id) {\n        const block = workspace.getBlockById(id);\n        if (commentOption.check(block) && state === block.hasIcon(\n            Blockly.icons.CommentIcon.TYPE)) {\n          workableBlocksLength++;\n        }\n      });\n      if (state) {\n        if (workableBlocksLength <= 1) {\n          return Blockly.Msg['REMOVE_COMMENT'];\n        } else {\n          return Blockly.Msg['REMOVE_X_COMMENTS']?\n            Blockly.Msg['REMOVE_X_COMMENTS'].replace(\n                '%1', workableBlocksLength) :\n            Blockly.Msg['REMOVE_COMMENT'] + ' (' +\n            workableBlocksLength + ')';\n        }\n      } else {\n        if (workableBlocksLength <= 1) {\n          return Blockly.Msg['ADD_COMMENT'];\n        } else {\n          return Blockly.Msg['ADD_X_COMMENTS']?\n            Blockly.Msg['ADD_X_COMMENTS'].replace(\n                '%1', workableBlocksLength) :\n            Blockly.Msg['ADD_COMMENT'] + ' (' +\n            workableBlocksLength + ')';\n        }\n      }\n    },\n    preconditionFn: function(scope) {\n      const block = scope.block;\n      if (!Blockly.utils.userAgent.IE && !block.isInFlyout &&\n        block.workspace.options.comments && !block.isCollapsed() &&\n        block.isEditable()) {\n        return 'enabled';\n      }\n      return 'hidden';\n    },\n    check: function(block) {\n      return block &&\n             commentOption.preconditionFn({block: block}) === 'enabled';\n    },\n    callback: function(scope) {\n      const hasCommentIcon = scope.block.hasIcon(\n          Blockly.icons.CommentIcon.TYPE);\n      const apply = function(block) {\n        if (commentOption.check(block)) {\n          if (hasCommentIcon) {\n            block.setCommentText(null);\n          } else {\n            block.setCommentText('');\n          }\n        }\n      };\n      const workspace = scope.block.workspace;\n      const dragSelection = dragSelectionWeakMap.get(workspace);\n      Blockly.Events.setGroup(true);\n      if (!dragSelection.size) {\n        apply(scope.block);\n      }\n      dragSelection.forEach(function(id) {\n        const block = workspace.getBlockById(id);\n        if (block) {\n          apply(block);\n        }\n      });\n      Blockly.Events.setGroup(false);\n    },\n    scopeType: Blockly.ContextMenuRegistry.ScopeType.BLOCK,\n    id,\n    weight: 2,\n  };\n  if (Blockly.ContextMenuRegistry.registry.getItem(id) !== null) {\n    Blockly.ContextMenuRegistry.registry.unregister(id);\n  }\n  Blockly.ContextMenuRegistry.registry.register(commentOption);\n};\n\n/**\n * Modification for context menu 'Inline' to be available for multiple blocks.\n */\nconst registerInline = function() {\n  const id = 'blockInline';\n  const inlineOption = {\n    displayText: function(scope) {\n      let workableBlocksLength = 0;\n      const state = scope.block.getInputsInline();\n      const workspace = scope.block.workspace;\n      const dragSelection = dragSelectionWeakMap.get(workspace);\n      dragSelection.forEach(function(id) {\n        const block = workspace.getBlockById(id);\n        if (inlineOption.check(block) &&\n            block.getInputsInline() === state) {\n          workableBlocksLength++;\n        }\n      });\n      if (state) {\n        if (workableBlocksLength <= 1) {\n          return Blockly.Msg['EXTERNAL_INPUTS'];\n        } else {\n          return Blockly.Msg['EXTERNAL_X_INPUTS']?\n            Blockly.Msg['EXTERNAL_X_INPUTS'].replace(\n                '%1', workableBlocksLength) :\n            Blockly.Msg['EXTERNAL_INPUTS'] + ' (' +\n            workableBlocksLength + ')';\n        }\n      } else {\n        if (workableBlocksLength <= 1) {\n          return Blockly.Msg['INLINE_INPUTS'];\n        } else {\n          return Blockly.Msg['INLINE_X_INPUTS']?\n            Blockly.Msg['INLINE_X_INPUTS'].replace(\n                '%1', workableBlocksLength) :\n            Blockly.Msg['INLINE_INPUTS'] + ' (' +\n            workableBlocksLength + ')';\n        }\n      }\n    },\n    preconditionFn: function(scope) {\n      const block = scope.block;\n      if (!block.isInFlyout && block.isMovable() && !block.isCollapsed()) {\n        for (let i = 1; i < block.inputList.length; i++) {\n          // Only display this option if there are two value or dummy inputs\n          // next to each other.\n          if (block.inputList[i - 1].type !==\n              Blockly.inputs.inputTypes.STATEMENT &&\n            block.inputList[i].type !== Blockly.inputs.inputTypes.STATEMENT) {\n            return 'enabled';\n          }\n        }\n      }\n      return 'hidden';\n    },\n    check: function(block) {\n      return block &&\n             inlineOption.preconditionFn({block: block}) === 'enabled';\n    },\n    callback: function(scope) {\n      const state = !scope.block.getInputsInline();\n      const apply = function(block) {\n        if (inlineOption.check(block)) {\n          block.setInputsInline(state);\n        }\n      };\n      const workspace = scope.block.workspace;\n      const dragSelection = dragSelectionWeakMap.get(workspace);\n      Blockly.Events.setGroup(true);\n      if (!dragSelection.size) {\n        apply(scope.block);\n      }\n      dragSelection.forEach(function(id) {\n        const block = workspace.getBlockById(id);\n        if (block) {\n          apply(block);\n        }\n      });\n      Blockly.Events.setGroup(false);\n    },\n    scopeType: Blockly.ContextMenuRegistry.ScopeType.BLOCK,\n    id,\n    weight: 3,\n  };\n  if (Blockly.ContextMenuRegistry.registry.getItem(id) !== null) {\n    Blockly.ContextMenuRegistry.registry.unregister(id);\n  }\n  Blockly.ContextMenuRegistry.registry.register(inlineOption);\n};\n\n/**\n * Modification for context menu 'Collapse/Expand' to be available for\n * multiple blocks.\n */\nconst registerCollapseExpandBlock = function() {\n  const id = 'blockCollapseExpand';\n  const collapseExpandOption = {\n    displayText: function(scope) {\n      let workableBlocksLength = 0;\n      const state = scope.block.isCollapsed();\n      const workspace = scope.block.workspace;\n      const dragSelection = dragSelectionWeakMap.get(workspace);\n      dragSelection.forEach(function(id) {\n        const block = workspace.getBlockById(id);\n        if (collapseExpandOption.check(block) &&\n            block.isCollapsed() === state) {\n          workableBlocksLength++;\n        }\n      });\n      if (state) {\n        if (workableBlocksLength <= 1) {\n          return Blockly.Msg['EXPAND_BLOCK'];\n        } else {\n          return Blockly.Msg['EXPAND_X_BLOCKS']?\n            Blockly.Msg['EXPAND_X_BLOCKS'].replace(\n                '%1', workableBlocksLength) :\n            Blockly.Msg['EXPAND_BLOCK'] + ' (' +\n            workableBlocksLength + ')';\n        }\n      } else {\n        if (workableBlocksLength <= 1) {\n          return Blockly.Msg['COLLAPSE_BLOCK'];\n        } else {\n          return Blockly.Msg['COLLAPSE_X_BLOCKS']?\n            Blockly.Msg['COLLAPSE_X_BLOCKS'].replace(\n                '%1', workableBlocksLength) :\n            Blockly.Msg['COLLAPSE_BLOCK'] + ' (' +\n            workableBlocksLength + ')';\n        }\n      }\n    },\n    preconditionFn: function(scope) {\n      const block = scope.block;\n      if (!block.isInFlyout && block.isMovable() &&\n        block.workspace.options.collapse) {\n        return 'enabled';\n      }\n      return 'hidden';\n    },\n    check: function(block) {\n      return block &&\n             collapseExpandOption.preconditionFn({block: block}) ===\n             'enabled' && (!hasSelectedParent(block) ||\n             block.isCollapsed());\n    },\n    callback: function(scope) {\n      const state = !scope.block.isCollapsed();\n      const apply = function(block) {\n        if (collapseExpandOption.check(block)) {\n          block.setCollapsed(state);\n        }\n      };\n      const workspace = scope.block.workspace;\n      const dragSelection = dragSelectionWeakMap.get(workspace);\n      Blockly.Events.setGroup(true);\n      if (!dragSelection.size) {\n        apply(scope.block);\n      }\n      dragSelection.forEach(function(id) {\n        const block = workspace.getBlockById(id);\n        if (block) {\n          apply(block);\n        }\n      });\n      Blockly.Events.setGroup(false);\n    },\n    scopeType: Blockly.ContextMenuRegistry.ScopeType.BLOCK,\n    id,\n    weight: 4,\n  };\n  if (Blockly.ContextMenuRegistry.registry.getItem(id) !== null) {\n    Blockly.ContextMenuRegistry.registry.unregister(id);\n  }\n  Blockly.ContextMenuRegistry.registry.register(collapseExpandOption);\n};\n\n/**\n * Modification for context menu 'Disable' to be available for multiple blocks.\n */\nconst registerDisable = function() {\n  const id = 'blockDisable';\n  const disableOption = {\n    displayText: function(scope) {\n      let workableBlocksLength = 0;\n      const state = scope.block.isEnabled();\n      const workspace = scope.block.workspace;\n      const dragSelection = dragSelectionWeakMap.get(workspace);\n      dragSelection.forEach(function(id) {\n        const block = workspace.getBlockById(id);\n        if (disableOption.check(block) &&\n            block.isEnabled() === state) {\n          workableBlocksLength++;\n        }\n      });\n      if (state) {\n        if (workableBlocksLength <= 1) {\n          return Blockly.Msg['DISABLE_BLOCK'];\n        } else {\n          return Blockly.Msg['DISABLE_X_BLOCKS']?\n            Blockly.Msg['DISABLE_X_BLOCKS'].replace(\n                '%1', workableBlocksLength) :\n            Blockly.Msg['DISABLE_BLOCK'] + ' (' +\n            workableBlocksLength + ')';\n        }\n      } else {\n        if (workableBlocksLength <= 1) {\n          return Blockly.Msg['ENABLE_BLOCK'];\n        } else {\n          return Blockly.Msg['ENABLE_X_BLOCKS']?\n            Blockly.Msg['ENABLE_X_BLOCKS'].replace(\n                '%1', workableBlocksLength) :\n            Blockly.Msg['ENABLE_BLOCK'] + ' (' +\n            workableBlocksLength + ')';\n        }\n      }\n    },\n    preconditionFn: function(scope) {\n      const block = scope.block;\n      if (!block.isInFlyout && block.workspace.options.disable &&\n          block.isEditable()) {\n        if (block.getInheritedDisabled()) {\n          return 'disabled';\n        }\n        return 'enabled';\n      }\n      return 'hidden';\n    },\n    check: function(block) {\n      return block &&\n             disableOption.preconditionFn({block: block}) === 'enabled' &&\n             (!hasSelectedParent(block) || !block.isEnabled());\n    },\n    callback: function(scope) {\n      const state = !scope.block.isEnabled();\n      const apply = function(block) {\n        if (disableOption.check(block)) {\n          block.setEnabled(state);\n        }\n      };\n      const workspace = scope.block.workspace;\n      const dragSelection = dragSelectionWeakMap.get(workspace);\n      Blockly.Events.setGroup(true);\n      if (!dragSelection.size) {\n        apply(scope.block);\n      }\n      dragSelection.forEach(function(id) {\n        const block = workspace.getBlockById(id);\n        if (block) {\n          apply(block);\n        }\n      });\n      Blockly.Events.setGroup(false);\n    },\n    scopeType: Blockly.ContextMenuRegistry.ScopeType.BLOCK,\n    id,\n    weight: 5,\n  };\n  if (Blockly.ContextMenuRegistry.registry.getItem(id) !== null) {\n    Blockly.ContextMenuRegistry.registry.unregister(id);\n  }\n  Blockly.ContextMenuRegistry.registry.register(disableOption);\n};\n\n/**\n * Modification for context menu 'Delete' to be available for multiple blocks.\n */\nconst registerDelete = function() {\n  const id = 'blockDelete';\n  const deleteOption = {\n    displayText: function(scope) {\n      let descendantCount = 0;\n      const workspace = scope.block.workspace;\n      const dragSelection = dragSelectionWeakMap.get(workspace);\n      dragSelection.forEach(function(id) {\n        const block = workspace.getBlockById(id);\n        if (block && !hasSelectedParent(block)) {\n          // Count the number of blocks that are nested in this block.\n          descendantCount += block.getDescendants(false).length;\n          for (const subBlocks of block.getDescendants(false)) {\n            if (subBlocks.isShadow()) {\n              descendantCount -= 1;\n            }\n          }\n          const nextBlock = block.getNextBlock();\n          if (nextBlock) {\n            // Blocks in the current stack would survive this block's deletion.\n            descendantCount -= nextBlock.getDescendants(false).length;\n          }\n        }\n      });\n      return (descendantCount <= 1) ?\n        Blockly.Msg['DELETE_BLOCK'] :\n        Blockly.Msg['DELETE_X_BLOCKS'].replace('%1', String(descendantCount));\n    },\n    preconditionFn: function(scope) {\n      if (!scope.block.isInFlyout && scope.block.isDeletable()) {\n        return 'enabled';\n      }\n      return 'hidden';\n    },\n    check: function(block) {\n      return block && !block.workspace.isFlyout &&\n             deleteOption.preconditionFn({block: block}) === 'enabled' &&\n             !hasSelectedParent(block);\n    },\n    callback: function(scope) {\n      const apply = function(block) {\n        if (deleteOption.check(block)) {\n          block.workspace.hideChaff();\n          if (block.outputConnection) {\n            block.dispose(false, true);\n          } else {\n            block.dispose(true, true);\n          }\n        }\n      };\n      const workspace = scope.block.workspace;\n      const dragSelection = dragSelectionWeakMap.get(workspace);\n      const selected = Blockly.common.getSelected();\n      Blockly.Events.setGroup(true);\n\n      // Handle the case where MultiselectDraggable is in use\n      if (selected && selected instanceof MultiselectDraggable) {\n        for (const element of selected.subDraggables) {\n          element[0].unselect();\n          if (element[0] instanceof Blockly.BlockSvg) {\n            apply(element[0]);\n          }\n        }\n        dragSelection.clear();\n        selected.clearAll_();\n      } else if (!dragSelection.size) {\n        apply(selected);\n      }\n\n      Blockly.Events.setGroup(false);\n    },\n    scopeType: Blockly.ContextMenuRegistry.ScopeType.BLOCK,\n    id,\n    weight: 6,\n  };\n  if (Blockly.ContextMenuRegistry.registry.getItem(id) !== null) {\n    Blockly.ContextMenuRegistry.registry.unregister(id);\n  }\n  Blockly.ContextMenuRegistry.registry.register(deleteOption);\n};\n\n/**\n * Paste multiple selected draggables from clipboard.\n * @param {boolean} useCopyPasteCrossTab Whether to use cross tab copy paste.\n */\nconst registerPaste = function(useCopyPasteCrossTab) {\n  const id = 'blockPasteFromStorage';\n  const pasteOption = {\n    displayText: function() {\n      const workableDraggableLength =\n          blockNumGetFromStorage(useCopyPasteCrossTab);\n      if (workableDraggableLength <= 1) {\n        return Blockly.Msg['CROSS_TAB_PASTE']?\n          Blockly.Msg['CROSS_TAB_PASTE'] : 'Paste';\n      } else {\n        return Blockly.Msg['CROSS_TAB_PASTE_X_ELEMENTS']?\n            Blockly.Msg['CROSS_TAB_PASTE_X_ELEMENTS'].replace(\n                '%1', workableDraggableLength) :\n            (Blockly.Msg['CROSS_TAB_PASTE']?\n            Blockly.Msg['CROSS_TAB_PASTE'] : 'Paste'\n            ) + ' (' +\n            workableDraggableLength + ')';\n      }\n    },\n    preconditionFn: function(scope) {\n      return scope.workspace.options.readOnly?\n        'hidden': (blockNumGetFromStorage(useCopyPasteCrossTab) < 1?\n          'disabled': 'enabled');\n    },\n    callback: function(scope) {\n      let workspace = scope.workspace;\n      const dragSelection = dragSelectionWeakMap.get(workspace);\n      Blockly.Events.setGroup(true);\n      const multiDraggable = multiDraggableWeakMap.get(workspace);\n\n      // Update the dragSelection and multiDraggable object\n      // to remove current selection prior to pasting.\n      if (dragSelection.size) {\n        dragSelection.forEach(function(id) {\n          const element = getByID(workspace, id);\n          element.unselect();\n        });\n        dragSelection.clear();\n        multiDraggable.clearAll_();\n      }\n\n      const blockList = [];\n      if (useCopyPasteCrossTab) {\n        dataCopyFromStorage();\n      }\n      copyData.forEach(function(stringData) {\n        // Pasting always pastes to the main workspace, even if the copy\n        // started in a flyout workspace.\n        const data = JSON.parse(stringData);\n\n        // Set unique id for data to prevent bug where\n        // blocks on multiple workspaces are highlighted.\n        if (workspace.id !== Blockly.getMainWorkspace().id) {\n          if (data.blockState) {\n            data.blockState.id = Blockly.utils.idGenerator.genUid();\n          } else if (data.commentState) {\n            data.commentState.id = Blockly.utils.idGenerator.genUid();\n          }\n        }\n\n        if (data.source) {\n          workspace = data.source;\n        }\n        if (workspace.isFlyout) {\n          workspace = workspace.targetWorkspace;\n        }\n        if (data.typeCounts &&\n            workspace.isCapacityAvailable(data.typeCounts)) {\n          const element = Blockly.clipboard.paste(data, workspace);\n          if (element) {\n            blockList.push(element);\n          }\n          if (element.type !== 'drag_to_dupe') {\n            dragSelectionWeakMap.get(workspace).add(element.id);\n            multiDraggableWeakMap.get(workspace).addSubDraggable_(element);\n          }\n        } else if (data.commentState) {\n          const element = Blockly.clipboard.paste(data, workspace);\n          if (element) {\n            element.select();\n          }\n          dragSelectionWeakMap.get(workspace).add(element.id);\n          multiDraggableWeakMap.get(workspace).addSubDraggable_(element);\n        }\n      });\n      connectionDBList.forEach(function(connectionDB) {\n        blockList[connectionDB[0]].nextConnection.connect(\n            blockList[connectionDB[1]].previousConnection);\n      });\n      Blockly.Events.setGroup(false);\n      Blockly.common.setSelected(multiDraggable);\n      return true;\n    },\n    scopeType: Blockly.ContextMenuRegistry.ScopeType.WORKSPACE,\n    id,\n    weight: 0,\n  };\n  if (Blockly.ContextMenuRegistry.registry.getItem(id) !== null) {\n    Blockly.ContextMenuRegistry.registry.unregister(id);\n  }\n  Blockly.ContextMenuRegistry.registry.register(pasteOption);\n};\n\n/**\n * Add context menu 'Select all Blocks' for workspace.\n */\nconst registerSelectAll = function() {\n  const id = 'workspaceSelectAll';\n  const selectAllOption = {\n    displayText: function() {\n      return 'Select all Blocks';\n    },\n    preconditionFn: function(scope) {\n      return scope.workspace.getTopBlocks().some(\n          (b) => selectAllOption.check(b)) ? 'enabled' : 'disabled';\n    },\n    check: function(block) {\n      return block &&\n             (block.isDeletable() || block.isMovable()) &&\n             !block.isInsertionMarker();\n    },\n    callback: function(scope) {\n      const multiDraggable = multiDraggableWeakMap.get(scope.workspace);\n\n      // Make sure that there is nothing in the multiDraggable (clearing)\n      // prior to selecting all blocks in workspace.\n      if (Blockly.getSelected()) {\n        if (Blockly.getSelected() instanceof MultiselectDraggable) {\n          for (const [subDraggable] of Blockly.getSelected().subDraggables) {\n            subDraggable.unselect();\n          }\n        } else {\n          Blockly.getSelected().unselect();\n        }\n        Blockly.common.setSelected(null);\n        multiDraggable.clearAll_();\n        dragSelectionWeakMap.get(scope.workspace).clear();\n      }\n\n      const blockList = [];\n      scope.workspace.getTopBlocks().forEach(function(block) {\n        if (selectAllOption.check(block)) {\n          blockList.push(block);\n          let nextBlock = block.getNextBlock();\n          while (nextBlock) {\n            blockList.push(nextBlock);\n            nextBlock = nextBlock.getNextBlock();\n          }\n        }\n      });\n      blockList.forEach(function(block) {\n        if (block.type !== 'drag_to_dupe') {\n          dragSelectionWeakMap.get(block.workspace).add(block.id);\n          multiDraggable.addSubDraggable_(block);\n        }\n      });\n\n      Blockly.common.setSelected(multiDraggable);\n    },\n    scopeType: Blockly.ContextMenuRegistry.ScopeType.WORKSPACE,\n    id,\n    weight: 5,\n  };\n  if (Blockly.ContextMenuRegistry.registry.getItem(id) !== null) {\n    Blockly.ContextMenuRegistry.registry.unregister(id);\n  }\n  Blockly.ContextMenuRegistry.registry.register(selectAllOption);\n};\n\n/**\n * Registers copy to back pack context menu item in back pack.\n * @param {boolean} disablePreconditionContainsCheck Option for\n *                  the back pack plugin, default is false.\n */\nconst updateToMultiCopyToBackpack =\n    function(disablePreconditionContainsCheck = false) {\n      const id = 'copy_to_backpack';\n      const copyToBackpack = {\n        getBackPack: function(ws) {\n          return ws\n              .getComponentManager()\n              .getComponent('backpack');\n        },\n        check: function(block) {\n          if (!block) return false;\n          const ws = block.workspace;\n          const backpack = copyToBackpack.getBackPack(ws);\n          return backpack &&\n             !backpack.containsBlock(block) &&\n             !hasSelectedParent(block);\n        },\n        displayText: function(scope) {\n          if (!scope.block) {\n            return '';\n          }\n          const ws = scope.block.workspace;\n          const backpack = copyToBackpack.getBackPack(ws);\n          if (!backpack) {\n            return '';\n          }\n          const backpackCount = backpack.getCount();\n          let workableBlocksLength = 0;\n          const dragSelection = dragSelectionWeakMap.get(ws);\n          if (!dragSelection.size) {\n            if (copyToBackpack.check(scope.block)) {\n              workableBlocksLength++;\n            }\n          }\n          for (const id of dragSelection) {\n            if (copyToBackpack.check(ws.getBlockById(id))) {\n              workableBlocksLength++;\n            }\n          }\n          return `(${workableBlocksLength}) ` +\n             `${Blockly.Msg['COPY_TO_BACKPACK']} (${backpackCount})`;\n        },\n        preconditionFn: function(scope) {\n          if (!scope.block) return 'hidden';\n          const ws = scope.block.workspace;\n          if (!ws.isFlyout) {\n            if (!copyToBackpack.getBackPack(ws)) {\n              return 'hidden';\n            }\n            if (disablePreconditionContainsCheck) {\n              return 'enabled';\n            }\n            const dragSelection = dragSelectionWeakMap.get(ws);\n            if (!dragSelection.size) {\n              if (copyToBackpack.check(scope.block)) {\n                return 'enabled';\n              }\n            }\n            for (const id of dragSelection) {\n              if (copyToBackpack.check(ws.getBlockById(id))) {\n                return 'enabled';\n              }\n            }\n            return 'disabled';\n          }\n          return 'hidden';\n        },\n        callback: function(scope) {\n          if (!scope.block) return;\n          const ws = scope.block.workspace;\n          const backpack = copyToBackpack.getBackPack(ws);\n          const dragSelection = dragSelectionWeakMap.get(ws);\n          if (!dragSelection.size) {\n            if (copyToBackpack.check(scope.block)) {\n              backpack.addBlock(scope.block);\n            }\n          }\n          dragSelection.forEach(function(id) {\n            const block = ws.getBlockById(id);\n            if (copyToBackpack.check(block)) {\n              backpack.addBlock(block);\n            }\n          });\n        },\n        scopeType: Blockly.ContextMenuRegistry.ScopeType.BLOCK,\n        id,\n        // Use a larger weight to push the option lower on the context menu.\n        weight: 200,\n      };\n      if (Blockly.ContextMenuRegistry.registry.getItem(id) !== null) {\n        Blockly.ContextMenuRegistry.registry.unregister(id);\n      }\n      Blockly.ContextMenuRegistry.registry.register(copyToBackpack);\n    };\n\n/**\n * Modification for context menu 'commentDelete' to\n * be available for multiple comments.\n */\nconst registerCommentDelete = function() {\n  const id = 'commentDelete';\n  const deleteOption = {\n    displayText: function(scope) {\n      let count = 0;\n      const workspace = scope.comment.workspace;\n      const dragSelection = dragSelectionWeakMap.get(workspace);\n      dragSelection.forEach(function(id) {\n        const comment = workspace.getCommentById(id);\n        if (comment) {\n          // Count the number of blocks that are nested in this block.\n          count += 1;\n        }\n      });\n      if (count <= 1) {\n        return Blockly.Msg['REMOVE_COMMENT'];\n      } else {\n        return Blockly.Msg['REMOVE_X_COMMENTS']?\n            Blockly.Msg['REMOVE_X_COMMENTS'].replace(\n                '%1', count) :\n            Blockly.Msg['REMOVE_COMMENT'] + ' (' +\n            count + ')';\n      }\n    },\n    preconditionFn: function(scope) {\n      if (scope.comment.isDeletable()) {\n        return 'enabled';\n      }\n      return 'hidden';\n    },\n    check: function(comment) {\n      return comment &&\n          deleteOption.preconditionFn({comment: comment}) === 'enabled';\n    },\n    callback: function(scope) {\n      const apply = function(comment) {\n        if (deleteOption.check(comment)) {\n          comment.workspace.hideChaff();\n          comment.dispose();\n        }\n      };\n      const workspace = scope.comment.workspace;\n      const dragSelection = dragSelectionWeakMap.get(workspace);\n      const selected = Blockly.common.getSelected();\n      Blockly.Events.setGroup(true);\n\n      // Handle the case where MultiselectDraggable is in use\n      if (selected && selected instanceof MultiselectDraggable) {\n        for (const element of selected.subDraggables) {\n          element[0].unselect();\n          if (element[0] instanceof\n              Blockly.comments.RenderedWorkspaceComment) {\n            apply(element[0]);\n          }\n        }\n        dragSelection.clear();\n        selected.clearAll_();\n      } else if (!dragSelection.size) {\n        apply(scope.comment);\n      }\n\n      Blockly.Events.setGroup(false);\n    },\n    scopeType: Blockly.ContextMenuRegistry.ScopeType.COMMENT,\n    id,\n    weight: 6,\n  };\n  if (Blockly.ContextMenuRegistry.registry.getItem(id) !== null) {\n    Blockly.ContextMenuRegistry.registry.unregister(id);\n  }\n  Blockly.ContextMenuRegistry.registry.register(deleteOption);\n};\n\n/**\n * Modification for context menu 'commentDuplicate' to be available for\n * multiple comments.\n */\nconst registerCommentDuplicate = function() {\n  const id = 'commentDuplicate';\n  const duplicateOption = {\n    displayText: function(scope) {\n      let count = 0;\n      const workspace = scope.comment.workspace;\n      const dragSelection = dragSelectionWeakMap.get(workspace);\n      dragSelection.forEach(function(id) {\n        const comment = workspace.getCommentById(id);\n        if (comment) {\n          count += 1;\n        }\n      });\n      if (count <= 1) {\n        return Blockly.Msg['DUPLICATE_COMMENT'];\n      } else {\n        return Blockly.Msg['DUPLICATE_X_COMMENTS']?\n            Blockly.Msg['DUPLICATE_X_COMMENTS'].replace(\n                '%1', count) :\n            Blockly.Msg['DUPLICATE_COMMENT'] + ' (' +\n            count + ')';\n      }\n    },\n    preconditionFn: function(scope) {\n      const comment = scope.comment;\n      if (comment.isDeletable() && comment.isMovable()) {\n        return 'enabled';\n      }\n      return 'hidden';\n    },\n    check: function(comment) {\n      return comment && duplicateOption.preconditionFn({comment: comment}) ===\n          'enabled';\n    },\n    callback: function(scope) {\n      const duplicatedComments = {};\n      const workspace = scope.comment.workspace;\n      const multiDraggable = multiDraggableWeakMap.get(workspace);\n      const apply = function(comment) {\n        if (duplicateOption.check(comment)) {\n          // Generate a new unique ID\n          const newId = Blockly.utils.idGenerator.genUid();\n          // Get the copy data of the block\n          const commentCopyData = comment.toCopyData();\n          // Set the new ID in the copy data\n          commentCopyData.commentState.id = newId;\n          // Paste the block with the modified copy data\n          duplicatedComments[comment.id] =\n              Blockly.clipboard.paste(commentCopyData, workspace);\n        }\n      };\n      const dragSelection = dragSelectionWeakMap.get(workspace);\n      Blockly.Events.setGroup(true);\n\n      // We want to update the dragSelection and the multiDraggable object to\n      // remove subdraggables from the current selection prior to duplicating.\n      if (dragSelection.size) {\n        dragSelection.forEach(function(id) {\n          const comment = workspace.getCommentById(id);\n          if (comment) {\n            comment.unselect();\n            apply(comment);\n          }\n        });\n        dragSelection.clear();\n        multiDraggable.clearAll_();\n        Blockly.common.setSelected(null);\n      } else {\n        apply(scope.comment);\n      }\n\n      for (const [, comment] of Object.entries(duplicatedComments)) {\n        if (comment.id) {\n          dragSelection.add(comment.id);\n          multiDraggable.addSubDraggable_(comment);\n          comment.select();\n        }\n      }\n      Blockly.common.setSelected(multiDraggable);\n      Blockly.Events.setGroup(false);\n    },\n    scopeType: Blockly.ContextMenuRegistry.ScopeType.COMMENT,\n    id,\n    weight: 1,\n  };\n  if (Blockly.ContextMenuRegistry.registry.getItem(id) !== null) {\n    Blockly.ContextMenuRegistry.registry.unregister(id);\n  }\n  Blockly.ContextMenuRegistry.registry.register(duplicateOption);\n};\n\n/**\n * Copy multiple selected comments to clipboard.\n * @param {boolean} useCopyPasteCrossTab Whether or not to use\n *     cross tab copy paste.\n */\nconst registerCommentCopy = function(useCopyPasteCrossTab) {\n  const id = 'commentCopyToStorage';\n  const copyOptions = {\n    displayText: function(scope) {\n      let workableCommentsLength = 0;\n      const workspace = scope.comment.workspace;\n      const dragSelection = dragSelectionWeakMap.get(workspace);\n      dragSelection.forEach(function(id) {\n        const comment = workspace.getCommentById(id);\n        if (comment) {\n          if (copyOptions.check(comment)) {\n            workableCommentsLength++;\n          }\n        }\n      });\n      if (workableCommentsLength <= 1) {\n        return Blockly.Msg['CROSS_TAB_COPY']?\n            Blockly.Msg['CROSS_TAB_COPY'] : 'Copy';\n      } else {\n        return Blockly.Msg['CROSS_TAB_COPY_X_COMMENTS']?\n            Blockly.Msg['CROSS_TAB_COMMENTS'].replace(\n                '%1', workableCommentsLength) :\n            (Blockly.Msg['CROSS_TAB_COPY']?\n                    Blockly.Msg['CROSS_TAB_COPY'] : 'Copy'\n            ) + ' (' +\n            workableCommentsLength + ')';\n      }\n    },\n    preconditionFn: function(scope) {\n      const workspace = scope.comment.workspace;\n      if (workspace.options.readOnly && !useCopyPasteCrossTab) {\n        return 'hidden';\n      }\n\n      const dragSelection = dragSelectionWeakMap.get(workspace);\n\n      // Fix the context menu error for backpack plugin\n      if (dragSelection === undefined) {\n        return 'hidden';\n      }\n\n      if (!dragSelection.size) {\n        if (copyOptions.check(scope.comment)) {\n          return 'enabled';\n        } else {\n          return 'disabled';\n        }\n      }\n      for (const id of dragSelection) {\n        const comment = workspace.getCommentById(id);\n        if (comment) {\n          if (copyOptions.check(comment)) {\n            return 'enabled';\n          }\n        }\n      }\n      return 'disabled';\n    },\n    check: function(comment) {\n      return comment && comment.isDeletable() &&\n          comment.isMovable();\n    },\n    callback: function(scope) {\n      const workspace = scope.comment.workspace;\n      copyData.clear();\n      workspace.hideChaff();\n\n      const apply = function(comm) {\n        if (copyOptions.check(comm)) {\n          copyData.add(JSON.stringify(comm.toCopyData()));\n        }\n      };\n\n      const selected = Blockly.common.getSelected();\n      const dragSelection = dragSelectionWeakMap.get(workspace);\n      Blockly.Events.setGroup(true);\n\n      // Handle the case where MultiselectDraggable is in use\n      if (selected && selected instanceof MultiselectDraggable) {\n        for (const element of selected.subDraggables) {\n          if (element[0] instanceof Blockly.comments.RenderedWorkspaceComment) {\n            apply(element[0]);\n          }\n        }\n      } else if (!dragSelection.size) {\n        apply(scope.comment);\n      }\n\n      if (useCopyPasteCrossTab) {\n        dataCopyToStorage();\n      }\n      Blockly.Events.setGroup(false);\n      return true;\n    },\n    scopeType: Blockly.ContextMenuRegistry.ScopeType.COMMENT,\n    id,\n    weight: 0,\n  };\n  if (Blockly.ContextMenuRegistry.registry.getItem(id) !== null) {\n    Blockly.ContextMenuRegistry.registry.unregister(id);\n  }\n  Blockly.ContextMenuRegistry.registry.register(copyOptions);\n};\n\n/**\n * Unregister context menu item, should be called before registering.\n */\nexport const unregisterContextMenu = function() {\n  registeredContextMenu.length = 0;\n  for (const id of ['blockDuplicate', 'blockComment', 'blockInline',\n    'blockCollapseExpand', 'blockDisable', 'blockDelete', 'commentDelete',\n    'commentDuplicate']) {\n    if (Blockly.ContextMenuRegistry.registry.getItem(id) !== null) {\n      Blockly.ContextMenuRegistry.registry.unregister(id);\n    }\n    registeredContextMenu.push(id);\n  }\n};\n\n/**\n * Register default context menu item.\n */\nexport const registerOrigContextMenu = function() {\n  const map = {\n    blockDuplicate: Blockly.ContextMenuItems.registerDuplicate,\n    blockComment: Blockly.ContextMenuItems.registerComment,\n    blockInline: Blockly.ContextMenuItems.registerInline,\n    blockCollapseExpand: Blockly.ContextMenuItems.registerCollapseExpandBlock,\n    blockDisable: Blockly.ContextMenuItems.registerDisable,\n    blockDelete: Blockly.ContextMenuItems.registerDelete,\n    commentDelete: Blockly.ContextMenuItems.registerCommentDelete,\n    commentDuplicate: Blockly.ContextMenuItems.registerCommentDuplicate,\n  };\n  for (const id of registeredContextMenu) {\n    map[id]();\n  }\n};\n\n/**\n * Registers all modified context menu item.\n * @param {boolean} useCopyPasteMenu Whether to use copy/paste menu.\n * @param {boolean} useCopyPasteCrossTab Whether to use cross tab copy/paste.\n */\nexport const registerOurContextMenu = function(useCopyPasteMenu, useCopyPasteCrossTab) {\n  if (useCopyPasteMenu) {\n    registerCopy(useCopyPasteCrossTab);\n    registerPaste(useCopyPasteCrossTab);\n    registerCommentCopy(useCopyPasteCrossTab);\n  }\n  const map = {\n    blockDuplicate: registerDuplicate,\n    blockComment: registerBlockComment,\n    blockInline: registerInline,\n    blockCollapseExpand: registerCollapseExpandBlock,\n    blockDisable: registerDisable,\n    blockDelete: registerDelete,\n    commentDelete: registerCommentDelete,\n    commentDuplicate: registerCommentDuplicate,\n  };\n  for (const id of registeredContextMenu) {\n    map[id]();\n  }\n  registerSelectAll();\n  updateToMultiCopyToBackpack();\n};\n","/**\n * @license\n * Copyright 2022 MIT\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * @fileoverview Multiple selection shortcut.\n */\n\nimport * as Blockly from 'blockly/core';\nimport {\n  dragSelectionWeakMap, hasSelectedParent, copyData, connectionDBList,\n  dataCopyToStorage, dataCopyFromStorage, registeredShortcut,\n  multiDraggableWeakMap, inPasteShortcut, getByID, shortcutNames,\n} from './global';\nimport {MultiselectDraggable} from './multiselect_draggable';\n\n/**\n * Modification for keyboard shortcut 'Delete' to be available\n * for multiple blocks.\n */\nconst registerShortcutDelete = function() {\n  const name = shortcutNames.MULTIDELETE;\n  const deleteShortcut = {\n    name,\n    preconditionFn: function(workspace) {\n      if (workspace.options.readOnly || Blockly.Gesture.inProgress()) {\n        return false;\n      }\n      const selected = Blockly.common.getSelected();\n      const dragSelection = dragSelectionWeakMap.get(workspace);\n      if (!dragSelection.size) {\n        return deleteShortcut.check(selected);\n      }\n      for (const id of dragSelection) {\n        const element = getByID(workspace, id);\n        if (deleteShortcut.check(element)) {\n          return true;\n        }\n      }\n      return false;\n    },\n    check: function(element) {\n      if (element instanceof Blockly.BlockSvg) {\n        return element && element.isDeletable() &&\n            !element.workspace.isFlyout &&\n            !hasSelectedParent(element);\n      } else if (element instanceof\n          Blockly.comments.RenderedWorkspaceComment) {\n        return element && element.isDeletable();\n      }\n      return false;\n    },\n    callback: function(workspace, e) {\n      // Delete or backspace.\n      // Stop the browser from going back to the previous page.\n      // Do this first to prevent an error in the delete code from resulting in\n      // data loss.\n      e.preventDefault();\n\n      const apply = function(element) {\n        if (deleteShortcut.check(element)) {\n          element.workspace.hideChaff();\n          if (element instanceof Blockly.BlockSvg) {\n            if (element.outputConnection) {\n              element.dispose(false, true);\n            } else {\n              element.dispose(true, true);\n            }\n          } else {\n            element.dispose();\n          }\n        }\n      };\n\n      const selected = Blockly.common.getSelected();\n      Blockly.Events.setGroup(true);\n      const dragSelection = dragSelectionWeakMap.get(workspace);\n\n      // Handle the case where MultiselectDraggable is in use\n      if (selected && selected instanceof MultiselectDraggable) {\n        for (const element of selected.subDraggables) {\n          selected.removeSubDraggable_(element[0]);\n          apply(element[0]);\n        }\n        dragSelection.clear();\n      } else if (!dragSelection.size) {\n        apply(selected);\n      }\n\n      Blockly.Events.setGroup(false);\n      return true;\n    },\n  };\n  if (name in Blockly.ShortcutRegistry.registry.getRegistry()) {\n    Blockly.ShortcutRegistry.registry.unregister(name);\n  }\n  Blockly.ShortcutRegistry.registry.register(deleteShortcut);\n  Blockly.ShortcutRegistry.registry.addKeyMapping(\n      Blockly.utils.KeyCodes.DELETE, deleteShortcut.name, true);\n  Blockly.ShortcutRegistry.registry.addKeyMapping(\n      Blockly.utils.KeyCodes.BACKSPACE, deleteShortcut.name, true);\n};\n\n\n/**\n * Keyboard shortcut to copy multiple selected blocks on\n * ctrl+c, cmd+c, or alt+c.\n * @param {boolean} useCopyPasteCrossTab Whether or not to use copy/paste\n */\nconst registerCopy = function(useCopyPasteCrossTab) {\n  const name = shortcutNames.MULTICOPY;\n  const copyShortcut = {\n    name,\n    preconditionFn: function(workspace) {\n      if (workspace.options.readOnly || Blockly.Gesture.inProgress()) {\n        return false;\n      }\n      const selected = Blockly.common.getSelected();\n      const dragSelection = dragSelectionWeakMap.get(workspace);\n      if (!dragSelection.size) {\n        return copyShortcut.check(selected);\n      }\n      for (const id of dragSelection) {\n        const element = getByID(workspace, id);\n        if (copyShortcut.check(element)) {\n          return true;\n        }\n      }\n      return false;\n    },\n    check: function(element) {\n      if (element instanceof Blockly.BlockSvg) {\n        return element && element.isDeletable() && element.isMovable() &&\n            !hasSelectedParent(element);\n      } else if (element instanceof\n          Blockly.comments.RenderedWorkspaceComment) {\n        return element && element.isDeletable() && element.isMovable();\n      }\n      return false;\n    },\n    callback: function(workspace, e) {\n      // Prevent the default copy behavior, which may beep or\n      // otherwise indicate an error due to the lack of a selection.\n      e.preventDefault();\n      copyData.clear();\n      workspace.hideChaff();\n      const blockList = [];\n      const apply = function(element) {\n        if (copyShortcut.check(element)) {\n          copyData.add(JSON.stringify(element.toCopyData()));\n          if (element instanceof Blockly.BlockSvg) {\n            blockList.push(element.id);\n          }\n        }\n      };\n      const selected = Blockly.common.getSelected();\n      const dragSelection = dragSelectionWeakMap.get(workspace);\n      Blockly.Events.setGroup(true);\n\n      // Handle the case where MultiselectDraggable is in use\n      if (selected && selected instanceof MultiselectDraggable) {\n        for (const element of selected.subDraggables) {\n          apply(element[0]);\n        }\n      } else if (!dragSelection.size) {\n        apply(selected);\n      }\n\n      connectionDBList.length = 0;\n      blockList.forEach(function(id) {\n        const block = workspace.getBlockById(id);\n        const parentBlock = block.getParent();\n        if (parentBlock && blockList.indexOf(parentBlock.id) !== -1 &&\n            parentBlock.getNextBlock() === block) {\n          connectionDBList.push([\n            blockList.indexOf(parentBlock.id),\n            blockList.indexOf(block.id)]);\n        }\n      });\n      if (useCopyPasteCrossTab) {\n        dataCopyToStorage();\n      }\n      Blockly.Events.setGroup(false);\n      return true;\n    },\n  };\n  if (name in Blockly.ShortcutRegistry.registry.getRegistry()) {\n    Blockly.ShortcutRegistry.registry.unregister(name);\n  }\n  Blockly.ShortcutRegistry.registry.register(copyShortcut);\n\n  const ctrlC = Blockly.ShortcutRegistry.registry.createSerializedKey(\n      Blockly.utils.KeyCodes.C, [Blockly.utils.KeyCodes.CTRL]);\n  Blockly.ShortcutRegistry.registry.addKeyMapping(\n      ctrlC, copyShortcut.name, true);\n\n  const altC = Blockly.ShortcutRegistry.registry.createSerializedKey(\n      Blockly.utils.KeyCodes.C, [Blockly.utils.KeyCodes.ALT]);\n  Blockly.ShortcutRegistry.registry.addKeyMapping(\n      altC, copyShortcut.name, true);\n\n  const metaC = Blockly.ShortcutRegistry.registry.createSerializedKey(\n      Blockly.utils.KeyCodes.C, [Blockly.utils.KeyCodes.META]);\n  Blockly.ShortcutRegistry.registry.addKeyMapping(\n      metaC, copyShortcut.name, true);\n};\n\n\n/**\n * Keyboard shortcut to copy and delete multiple selected blocks on\n * ctrl+x, cmd+x, or alt+x.\n * @param {boolean} useCopyPasteCrossTab Whether or not to use copy/paste\n */\nconst registerCut = function(useCopyPasteCrossTab) {\n  const name = shortcutNames.MULTICUT;\n  const cutShortcut = {\n    name,\n    preconditionFn: function(workspace) {\n      if (workspace.options.readOnly || Blockly.Gesture.inProgress()) {\n        return false;\n      }\n      const selected = Blockly.common.getSelected();\n      const dragSelection = dragSelectionWeakMap.get(workspace);\n      if (!dragSelection.size) {\n        return cutShortcut.check(selected);\n      }\n      for (const id of dragSelection) {\n        const element = getByID(workspace, id);\n        if (cutShortcut.check(element)) {\n          return true;\n        }\n      }\n      return false;\n    },\n    check: function(element) {\n      if (element instanceof Blockly.BlockSvg) {\n        return element && element.isDeletable() && element.isMovable() &&\n            !element.workspace.isFlyout &&\n            !hasSelectedParent(element);\n      } else if (element instanceof\n          Blockly.comments.RenderedWorkspaceComment) {\n        return element && element.isDeletable() && element.isMovable();\n      }\n      return false;\n    },\n    callback: function(workspace) {\n      copyData.clear();\n      const elementList = [];\n      const apply = function(element) {\n        if (cutShortcut.check(element)) {\n          copyData.add(JSON.stringify(element.toCopyData()));\n          elementList.push(element.id);\n        }\n      };\n      const applyDelete = function(element) {\n        if (!element) return;\n        element.workspace.hideChaff();\n        if (element instanceof Blockly.BlockSvg) {\n          if (element.outputConnection) {\n            element.dispose(false, true);\n          } else {\n            element.dispose(true, true);\n          }\n        } else {\n          // This may need to be adjusted based on what\n          // kinds of draggables are added to blockly\n          element.dispose();\n        }\n      };\n\n      const selected = Blockly.common.getSelected();\n      const dragSelection = dragSelectionWeakMap.get(workspace);\n      Blockly.Events.setGroup(true);\n\n      // Handle the case where MultiselectDraggable is in use\n      if (selected && selected instanceof MultiselectDraggable) {\n        for (const element of selected.subDraggables) {\n          apply(element[0]);\n          selected.removeSubDraggable_(element[0]);\n        }\n      } else if (!dragSelection.size) {\n        apply(selected);\n      }\n      dragSelection.clear();\n\n      connectionDBList.length = 0;\n      elementList.forEach(function(id) {\n        const block = workspace.getBlockById(id);\n        if (block) {\n          const parentBlock = block.getParent();\n          if (parentBlock && elementList.indexOf(parentBlock.id) !== -1 &&\n              parentBlock.getNextBlock() === block) {\n            connectionDBList.push([\n              elementList.indexOf(parentBlock.id),\n              elementList.indexOf(block.id)]);\n          }\n        }\n      });\n      elementList.forEach(function(id) {\n        const element = getByID(workspace, id);\n        applyDelete(element);\n      });\n\n      if (useCopyPasteCrossTab) {\n        dataCopyToStorage();\n      }\n      Blockly.Events.setGroup(false);\n      return true;\n    },\n  };\n\n  if (name in Blockly.ShortcutRegistry.registry.getRegistry()) {\n    Blockly.ShortcutRegistry.registry.unregister(name);\n  }\n  Blockly.ShortcutRegistry.registry.register(cutShortcut);\n\n  const ctrlX = Blockly.ShortcutRegistry.registry.createSerializedKey(\n      Blockly.utils.KeyCodes.X, [Blockly.utils.KeyCodes.CTRL]);\n  Blockly.ShortcutRegistry.registry.addKeyMapping(\n      ctrlX, cutShortcut.name, true);\n\n  const altX = Blockly.ShortcutRegistry.registry.createSerializedKey(\n      Blockly.utils.KeyCodes.X, [Blockly.utils.KeyCodes.ALT]);\n  Blockly.ShortcutRegistry.registry.addKeyMapping(\n      altX, cutShortcut.name, true);\n\n  const metaX = Blockly.ShortcutRegistry.registry.createSerializedKey(\n      Blockly.utils.KeyCodes.X, [Blockly.utils.KeyCodes.META]);\n  Blockly.ShortcutRegistry.registry.addKeyMapping(\n      metaX, cutShortcut.name, true);\n};\n\n// TODO: Look into undo stack and adding/removing blocks from multidraggable\n/**\n * Keyboard shortcut to paste multiple selected blocks on\n * ctrl+v, cmd+v, or alt+v.\n * @param {boolean} useCopyPasteCrossTab Whether or not to use copy/paste\n */\nconst registerPaste = function(useCopyPasteCrossTab) {\n  const name = shortcutNames.MULTIPASTE;\n  const pasteShortcut = {\n    name,\n    preconditionFn: function(workspace) {\n      return !workspace.options.readOnly && !Blockly.Gesture.inProgress();\n    },\n    callback: function(workspace) {\n      inPasteShortcut.set(workspace, true);\n      const dragSelection = dragSelectionWeakMap.get(workspace);\n      const multiDraggable = multiDraggableWeakMap.get(workspace);\n\n      // Update the dragSelection and multiDraggable object\n      // to remove current selection prior to pasting.\n      if (dragSelection.size) {\n        dragSelection.forEach(function(id) {\n          const element = getByID(workspace, id);\n          if (element) {\n            element.unselect();\n          }\n        });\n        dragSelection.clear();\n        multiDraggable.clearAll_();\n      }\n\n      Blockly.Events.setGroup(true);\n\n      const blockList = [];\n      if (useCopyPasteCrossTab) {\n        dataCopyFromStorage();\n      }\n      copyData.forEach(function(stringData) {\n        const data = JSON.parse(stringData);\n        // Set unique id for data to prevent bug where\n        // blocks on multiple workspaces are highlighted.\n        if (workspace.id !== Blockly.getMainWorkspace().id) {\n          if (data.blockState) {\n            data.blockState.id = Blockly.utils.idGenerator.genUid();\n          } else if (data.commentState) {\n            data.commentState.id = Blockly.utils.idGenerator.genUid();\n          }\n        }\n\n        if (data.source) {\n          workspace = data.source;\n        }\n        if (workspace.isFlyout) {\n          workspace = workspace.targetWorkspace;\n        }\n        if (data.typeCounts &&\n            workspace.isCapacityAvailable(data.typeCounts)) {\n          const element = Blockly.clipboard.paste(data, workspace);\n          if (element) {\n            blockList.push(element);\n          }\n          if (element.type !== 'drag_to_dupe') {\n            dragSelectionWeakMap.get(workspace).add(element.id);\n            multiDraggableWeakMap.get(workspace).addSubDraggable_(element);\n          }\n        } else if (data.commentState) {\n          const element = Blockly.clipboard.paste(data, workspace);\n          if (element) {\n            element.select();\n          }\n          dragSelectionWeakMap.get(workspace).add(element.id);\n          multiDraggableWeakMap.get(workspace).addSubDraggable_(element);\n        }\n      });\n      connectionDBList.forEach(function(connectionDB) {\n        blockList[connectionDB[0]].nextConnection.connect(\n            blockList[connectionDB[1]].previousConnection);\n      });\n\n      Blockly.common.setSelected(multiDraggable);\n      Blockly.Events.setGroup(false);\n      return true;\n    },\n  };\n\n  if (name in Blockly.ShortcutRegistry.registry.getRegistry()) {\n    Blockly.ShortcutRegistry.registry.unregister(name);\n  }\n  Blockly.ShortcutRegistry.registry.register(pasteShortcut);\n\n  const ctrlV = Blockly.ShortcutRegistry.registry.createSerializedKey(\n      Blockly.utils.KeyCodes.V, [Blockly.utils.KeyCodes.CTRL]);\n  Blockly.ShortcutRegistry.registry.addKeyMapping(\n      ctrlV, pasteShortcut.name, true);\n\n  const altV = Blockly.ShortcutRegistry.registry.createSerializedKey(\n      Blockly.utils.KeyCodes.V, [Blockly.utils.KeyCodes.ALT]);\n  Blockly.ShortcutRegistry.registry.addKeyMapping(\n      altV, pasteShortcut.name, true);\n\n  const metaV = Blockly.ShortcutRegistry.registry.createSerializedKey(\n      Blockly.utils.KeyCodes.V, [Blockly.utils.KeyCodes.META]);\n  Blockly.ShortcutRegistry.registry.addKeyMapping(\n      metaV, pasteShortcut.name, true);\n};\n\n/**\n * Keyboard shortcut to select all top blocks in the workspace on\n * ctrl+a, cmd+a, or alt+a.\n */\nconst registerSelectAll = function() {\n  const name = 'selectall';\n  const selectAllShortcut = {\n    name,\n    preconditionFn: function(workspace) {\n      return workspace.getTopBlocks().some(\n          (b) => selectAllShortcut.check(b)) ? true : false;\n    },\n    check: function(block) {\n      return block &&\n            (block.isDeletable() || block.isMovable()) &&\n            !block.isInsertionMarker();\n    },\n    callback: function(workspace, e) {\n      // Prevent the default text all selection behavior.\n      e.preventDefault();\n      const dragSelection = dragSelectionWeakMap.get(workspace);\n      const multiDraggable = multiDraggableWeakMap.get(workspace);\n\n      // Make sure that there is nothing in the multiDraggable\n      // (clearing) prior to selecting all blocks in workspace.\n      if (Blockly.getSelected()) {\n        if (Blockly.getSelected() instanceof MultiselectDraggable) {\n          for (const [subDraggable] of Blockly.getSelected().subDraggables) {\n            subDraggable.unselect();\n          }\n        } else {\n          Blockly.getSelected().unselect();\n        }\n        Blockly.common.setSelected(null);\n        multiDraggable.clearAll_();\n        dragSelectionWeakMap.get(workspace).clear();\n      }\n\n      const blockList = [];\n      workspace.getTopBlocks().forEach(function(block) {\n        if (selectAllShortcut.check(block)) {\n          blockList.push(block);\n          let nextBlock = block.getNextBlock();\n          while (nextBlock) {\n            blockList.push(nextBlock);\n            nextBlock = nextBlock.getNextBlock();\n          }\n        }\n      });\n      blockList.forEach(function(block) {\n        if (block.type !== 'drag_to_dupe') {\n          multiDraggable.addSubDraggable_(block);\n          dragSelection.add(block.id);\n        }\n      });\n\n      Blockly.common.setSelected(multiDraggable);\n      return true;\n    },\n  };\n  if (name in Blockly.ShortcutRegistry.registry.getRegistry()) {\n    Blockly.ShortcutRegistry.registry.unregister(name);\n  }\n  Blockly.ShortcutRegistry.registry.register(selectAllShortcut);\n\n  const ctrlA = Blockly.ShortcutRegistry.registry.createSerializedKey(\n      Blockly.utils.KeyCodes.A, [Blockly.utils.KeyCodes.CTRL]);\n  Blockly.ShortcutRegistry.registry.addKeyMapping(\n      ctrlA, selectAllShortcut.name);\n\n  const altA =\n  Blockly.ShortcutRegistry.registry.createSerializedKey(\n      Blockly.utils.KeyCodes.A, [Blockly.utils.KeyCodes.ALT]);\n  Blockly.ShortcutRegistry.registry.addKeyMapping(\n      altA, selectAllShortcut.name);\n\n  const metaA = Blockly.ShortcutRegistry.registry.createSerializedKey(\n      Blockly.utils.KeyCodes.A, [Blockly.utils.KeyCodes.META]);\n  Blockly.ShortcutRegistry.registry.addKeyMapping(\n      metaA, selectAllShortcut.name);\n};\n\n/**\n * Unregister keyboard shortcut item, should be called before registering.\n */\nexport const unregisterOrigShortcut = function() {\n  registeredShortcut.length = 0;\n  for (const name of [Blockly.ShortcutItems.names.DELETE,\n    Blockly.ShortcutItems.names.COPY,\n    Blockly.ShortcutItems.names.CUT, Blockly.ShortcutItems.names.PASTE]) {\n    if (Object.entries(Blockly.ShortcutRegistry.registry.getRegistry())\n        .map(([_, value]) => value.name).includes(name)) {\n      Blockly.ShortcutRegistry.registry.unregister(name);\n      registeredShortcut.push(name);\n    }\n  }\n};\n\nexport const unregisterOurShortcut = function() {\n  registeredShortcut.length = 0;\n  for (const name of [shortcutNames.MULTIDELETE,\n    shortcutNames.MULTICOPY,\n    shortcutNames.MULTICUT, shortcutNames.MULTIPASTE]) {\n    if (Object.entries(Blockly.ShortcutRegistry.registry.getRegistry())\n        .map(([_, value]) => value.name).includes(name)) {\n      Blockly.ShortcutRegistry.registry.unregister(name);\n    }\n  }\n  for (const name of [Blockly.ShortcutItems.names.DELETE,\n    Blockly.ShortcutItems.names.COPY,\n    Blockly.ShortcutItems.names.CUT, Blockly.ShortcutItems.names.PASTE]) {\n    registeredShortcut.push(name);\n  }\n};\n\n/**\n * Register default keyboard shortcut item.\n */\nexport const registerOrigShortcut = function() {\n  const map = {\n    [Blockly.ShortcutItems.names.DELETE]: Blockly.ShortcutItems.registerDelete,\n    [Blockly.ShortcutItems.names.COPY]: Blockly.ShortcutItems.registerCopy,\n    [Blockly.ShortcutItems.names.CUT]: Blockly.ShortcutItems.registerCut,\n    [Blockly.ShortcutItems.names.PASTE]: Blockly.ShortcutItems.registerPaste,\n  };\n  for (const name of registeredShortcut) {\n    map[name]();\n  }\n};\n\n/**\n * Registers all modified keyboard shortcut item.\n * @param {boolean} useCopyPasteCrossTab Whether to use copy/paste cross tab.\n */\nexport const registerOurShortcut = function(useCopyPasteCrossTab) {\n  const ListNoParameter = [Blockly.ShortcutItems.names.DELETE];\n  const map = {\n    [Blockly.ShortcutItems.names.DELETE]: registerShortcutDelete,\n    [Blockly.ShortcutItems.names.COPY]: registerCopy,\n    [Blockly.ShortcutItems.names.CUT]: registerCut,\n    [Blockly.ShortcutItems.names.PASTE]: registerPaste,\n  };\n  for (const name of registeredShortcut) {\n    if (ListNoParameter.includes(name)) {\n      map[name]();\n    } else {\n      map[name](useCopyPasteCrossTab);\n    }\n  }\n  registerSelectAll();\n};\n","/**\n * @license\n * Copyright 2022 MIT\n * SPDX-License-Identifier: Apache-2.0\n */\n\n\n/**\n * @fileoverview Multiple selection svg switch.\n */\n\nimport * as Blockly from 'blockly/core';\n\nimport DragSelect from 'dragselect';\nimport {\n  dragSelectionWeakMap,\n  getByID,\n  inMultipleSelectionModeWeakMap,\n  inPasteShortcut,\n  multiDraggableWeakMap,\n} from './global';\nimport {MultiselectDraggable} from './multiselect_draggable';\n\n/**\n * Width of the multi select controls.\n * @type {number}\n * @const\n */\nconst WIDTH = 32;\n\n/**\n * Height of the multi select control.\n * @type {number}\n * @const\n */\nconst HEIGHT = 32;\n\n/**\n * Distance between multi select controls and bottom or top edge of workspace.\n * @type {number}\n * @const\n */\nconst MARGIN_VERTICAL = 20;\n\n/**\n * Distance between multi select controls and right or left edge of workspace.\n * @type {number}\n */\nconst MARGIN_HORIZONTAL = 20;\n\n/**\n * Class for a multi select controls.\n * @implements {Blockly.IPositionable}\n */\nexport class MultiselectControls {\n  /**\n   * @param {!Blockly.WorkspaceSvg} workspace The workspace to sit in.\n   * @param {Object} options The icons configuration.\n   * @param {!Array<string>} multiSelectKeys The key codes for\n   *                         switching between multi select mode.\n   */\n  constructor(workspace, options, multiSelectKeys) {\n    /**\n     * Icon path of the multi select controls when enabled.\n     * @type {string}\n     */\n    this.enabled_img =\n        'https://github.com/mit-cml/workspace-multiselect' +\n        '/raw/main/test/media/select.svg';\n\n    /**\n     * Icon path of the multi select controls when disabled.\n     * @type {string}\n     */\n    this.disabled_img =\n        'https://github.com/mit-cml/workspace-multiselect' +\n        '/raw/main/test/media/unselect.svg';\n\n    /**\n     * @type {!Blockly.WorkspaceSvg} The workspace to sit in.\n     * @private\n     */\n    this.workspace_ = workspace;\n\n    /**\n     * State of the multi select controls.\n     * @type {boolean}\n     */\n    this.enabled = false;\n\n    /**\n     * The unique id for this component that is used to register with the\n     * ComponentManager.\n     * @type {string}\n     */\n    this.id = 'multiselectControls';\n\n    /**\n     * The key codes for switching between multi select.\n     * @type {!Array<string>}\n     * @private\n     */\n    this.multiSelectKeys_ = multiSelectKeys;\n\n    /**\n     * A handle to use to unbind the mouse down event handler for multi select\n     *    button. Opaque data returned from browserEvents.conditionalBind.\n     * @type {?Blockly.browserEvents.Data}\n     * @private\n     */\n    this.onMultiselectWrapper_ = null;\n\n    /**\n     * The multi select svg <g> element.\n     * @type {SVGGElement}\n     * @private\n     */\n    this.multiselectGroup_ = null;\n\n    /**\n     * Whether this has been initialized.\n     * @type {boolean}\n     * @private\n     */\n    this.initialized_ = false;\n\n    /**\n     * Store the status of workspace dragging\n     * before entering multi select mode.\n     * @type {boolean}\n     * @private\n     */\n    this.hasDisableWorkspaceDrag_ = false;\n\n    /**\n     * Store the block that just got unselected.\n     * @type {!Blockly.BlockSvg}\n     * @private\n     */\n    this.justUnselectedBlock_ = null;\n\n    /**\n     * Store the block that was last selected.\n     * @type {!Blockly.BlockSvg}\n     * @private\n     */\n    this.lastSelectedElement_ = null;\n\n    if (options && options.enabledIcon) {\n      this.enabled_img = options.enabledIcon;\n    }\n\n    if (options && options.disabledIcon) {\n      this.disabled_img = options.disabledIcon;\n    }\n\n    // Set containing currently select blockSvg ids.\n    this.dragSelection = dragSelectionWeakMap.get(workspace);\n\n    // MultiDraggable object that holds subdraggables\n    this.multiDraggable = multiDraggableWeakMap.get(workspace);\n\n    // Original settings for handling the start block\n    this.origHandleBlockStart = Blockly.Gesture.prototype.handleBlockStart;\n  }\n\n  /**\n   * Create the multi select controls.\n   * @returns {!SVGElement} The multi select controls SVG group.\n   */\n  createDom() {\n    this.svgGroup_ = Blockly.utils.dom.createSvgElement(\n        Blockly.utils.Svg.G, {}, null);\n    this.createMultiselectSvg_();\n    return this.svgGroup_;\n  }\n\n  /**\n   * Initializes the multi select controls.\n   */\n  init(hideIcon, weight) {\n    if (!hideIcon) {\n      let weightValue = 3;\n      if (typeof weight === 'number') {\n        weightValue = weight;\n      }\n      this.workspace_.getComponentManager().addComponent({\n        component: this,\n        weight: weightValue,\n        capabilities: [Blockly.ComponentManager.Capability.POSITIONABLE],\n      });\n    }\n    this.initialized_ = true;\n    this.workspace_.resize();\n    this.multiDraggable.clearAll_();\n  }\n\n  /**\n   * Disposes of this multi select controls.\n   * Unlink from all DOM elements to prevent memory leaks.\n   */\n  dispose() {\n    this.disableMultiselect();\n    this.workspace_.getComponentManager().removeComponent(this.id);\n    if (this.svgGroup_) {\n      Blockly.utils.dom.removeNode(this.svgGroup_);\n    }\n    if (this.onMultiselectWrapper_) {\n      Blockly.browserEvents.unbind(this.onMultiselectWrapper_);\n    }\n  }\n\n  /**\n   * Returns the bounding rectangle of the UI element in pixel units relative to\n   * the Blockly injection div.\n   * @returns {?Blockly.utils.Rect} The UI elements's bounding box. Null if\n   *   bounding box should be ignored by other UI elements.\n   */\n  getBoundingRectangle() {\n    const bottom = this.top_ + HEIGHT;\n    const right = this.left_ + WIDTH;\n    return new Blockly.utils.Rect(this.top_, bottom, this.left_, right);\n  }\n\n  /**\n   * Positions the multi select controls.\n   * It is positioned in the opposite corner to the corner the\n   * categories/toolbox starts at.\n   * @param {!Blockly.MetricsManager.UiMetrics} metrics The workspace metrics.\n   * @param {!Array<!Blockly.utils.Rect>} savedPositions List of rectangles that\n   *     are already on the workspace.\n   */\n  position(metrics, savedPositions) {\n    // Not yet initialized.\n    if (!this.initialized_) {\n      return;\n    }\n\n    const cornerPosition =\n      Blockly.uiPosition.getCornerOppositeToolbox(this.workspace_, metrics);\n    const startRect = Blockly.uiPosition.getStartPositionRect(\n        cornerPosition, new Blockly.utils.Size(WIDTH, HEIGHT),\n        MARGIN_HORIZONTAL,\n        MARGIN_VERTICAL, metrics, this.workspace_);\n\n    const verticalPosition = cornerPosition.vertical;\n    const bumpDirection = verticalPosition ===\n      Blockly.uiPosition.verticalPosition.TOP ?\n      Blockly.uiPosition.bumpDirection.DOWN :\n      Blockly.uiPosition.bumpDirection.UP;\n    const positionRect = Blockly.uiPosition.bumpPositionRect(\n        startRect, MARGIN_VERTICAL, bumpDirection, savedPositions);\n\n    this.top_ = positionRect.top;\n    this.left_ = positionRect.left;\n    if (this.svgGroup_) {\n      this.svgGroup_.setAttribute(\n          'transform', 'translate(' + this.left_ + ',' + this.top_ + ')');\n    }\n  }\n\n  /**\n   * Revert the last unselected block.\n   */\n  revertLastUnselectedBlock() {\n    this.updateDraggables_(this.justUnselectedBlock_);\n  }\n\n  /**\n   * Create the multi-select icon and its event handler.\n   * @private\n   */\n  createMultiselectSvg_() {\n    /* This markup will be generated and added to the .svgGroup_:\n    <g class=\"blocklyMultiselect\">\n      <image width=\"32\" height=\"32\" xlink:href=\"media/unselect.svg\"></image>\n    </g>\n    */\n    this.multiselectGroup_ =\n      Blockly.utils.dom.createSvgElement(Blockly.utils.Svg.G, {\n        'class': 'blocklyMultiselect',\n      }, this.svgGroup_);\n    const MultiselectSvg = Blockly.utils.dom.createSvgElement(\n        Blockly.utils.Svg.IMAGE, {\n          'width': WIDTH,\n          'height': HEIGHT,\n        },\n        this.multiselectGroup_);\n    MultiselectSvg.setAttributeNS(\n        Blockly.utils.dom.XLINK_NS, 'xlink:href', this.disabled_img);\n\n    // Attach event listeners.\n    this.onMultiselectWrapper_ = Blockly.browserEvents.conditionalBind(\n        this.multiselectGroup_, 'mousedown', null,\n        this.switchMultiselect_.bind(this));\n  }\n\n  /**\n   * Handles a mouse down event on the multi-select button on the workspace.\n   * @param {!Event} e A mouse down event.\n   * @private\n   */\n  switchMultiselect_(e) {\n    this.workspace_.markFocused();\n    this.enabled = !this.enabled;\n    // Multiple selection switch.\n    if (this.enabled) {\n      this.enableMultiselect(true);\n    } else {\n      this.disableMultiselect(true);\n    }\n    Blockly.Touch.clearTouchIdentifier(); // Don't block future drags.\n    e.stopPropagation(); // Don't start a workspace scroll.\n    e.preventDefault(); // Stop double-clicking from selecting text.\n  }\n\n  /**\n   * Maintain the selected draggable set list when updating.\n   * @param {!Blockly.IDraggable} draggable The draggable to update.\n   * @private\n   */\n  updateDraggables_(draggable) {\n    if (!draggable) {\n      return;\n    }\n    if (draggable instanceof Blockly.BlockSvg) {\n      // The case where the draggable is a block\n      if (!((draggable.isDeletable() || draggable.isMovable()) &&\n          !draggable.isShadow()) || draggable.type === 'drag_to_dupe') {\n        return;\n      }\n      if (this.dragSelection.has(draggable.id)) {\n        this.dragSelection.delete(draggable.id);\n        this.justUnselectedBlock_ = draggable;\n        this.multiDraggable.removeSubDraggable_(draggable);\n        draggable.pathObject.updateSelected(false);\n      } else {\n        this.dragSelection.add(draggable.id);\n        this.justUnselectedBlock_ = null;\n        this.multiDraggable.addSubDraggable_(draggable);\n        draggable.pathObject.updateSelected(true);\n        draggable.bringToFront();\n      }\n    } else {\n      // The case where the draggable is not a block (e.g. ws comment)\n      if (!(draggable.isMovable() || draggable.isDeletable())) {\n        return;\n      }\n      if (this.dragSelection.has(draggable.id)) {\n        this.dragSelection.delete(draggable.id);\n        this.multiDraggable.removeSubDraggable_(draggable);\n        draggable.unselect();\n      } else {\n        this.dragSelection.add(draggable.id);\n        this.multiDraggable.addSubDraggable_(draggable);\n        draggable.select();\n      }\n    }\n  }\n\n\n  /**\n   * Update the multiple selection blocks status.\n   */\n  updateMultiselect() {\n    // Not in multiselect mode\n    if (!inMultipleSelectionModeWeakMap.get(this.workspace_)) {\n      // If clicking on different workspace, clear selected set\n      if (this.workspace_.id !== Blockly.getMainWorkspace().id) {\n        this.multiDraggable.clearAll_();\n        this.dragSelection.clear();\n      }\n\n      // If unselecting/clicking on workspace,\n      // clear selected set\n      if (!Blockly.getSelected()) {\n        this.lastSelectedElement_ = null;\n        // This is a workaround for a bug where holding shift\n        // selecting and going to another workspace without letting go of\n        // shift and selecting new blocks will still leave the original\n        // blocks highlighted. This can be removed if we figure out how\n        // to solve the real-time highlighting issue in the updateDraggables_\n        // function. However, a frame-delay related to events may be causing\n        // this issue (Blockly-side).\n        for (const draggable of this.multiDraggable.subDraggables) {\n          draggable[0].unselect();\n        }\n        this.multiDraggable.clearAll_();\n        this.dragSelection.clear();\n        Blockly.common.setSelected(null);\n      } else if (Blockly.getSelected() &&\n          !(Blockly.getSelected() instanceof MultiselectDraggable)) {\n        // Blockly.getSelected() is not a multiselectDraggable\n        // and selected block is not in dragSelection\n        for (const draggable of this.multiDraggable.subDraggables) {\n          draggable[0].unselect();\n        }\n        this.multiDraggable.clearAll_();\n        this.dragSelection.clear();\n        this.lastSelectedElement_ = Blockly.getSelected();\n        inPasteShortcut.set(this.workspace_, false);\n      }\n    } else {\n      // In multiselect mode\n      // Set selected to multiDraggable if dragSelection not empty\n      if (this.dragSelection.size && !(Blockly.getSelected() instanceof\n          MultiselectDraggable)) {\n        Blockly.common.setSelected(this.multiDraggable);\n      } else if (this.lastSelectedElement_ &&\n          !inPasteShortcut.get(this.workspace_)) {\n        this.updateDraggables_(this.lastSelectedElement_);\n        this.lastSelectedElement_ = null;\n        inPasteShortcut.set(this.workspace_, false);\n      } else if (!this.dragSelection.size && !(Blockly.getSelected() instanceof\n          MultiselectDraggable)) {\n        if (Blockly.getSelected() instanceof Blockly.BlockSvg &&\n            !Blockly.getSelected().isShadow()) {\n          Blockly.common.setSelected(null);\n        }\n        // TODO: Look into this after gesture has been updated at Blockly\n        // Currently, the setSelected is called twice even with selection of\n        // one block. This is most likely because of the handleBlockStart\n        // gesture. That is why it is separated from the if statement above.\n        if (Blockly.getSelected() instanceof Blockly.BlockSvg) {\n          this.justUnselectedBlock_ = Blockly.getSelected();\n        }\n      }\n    }\n  }\n\n  /**\n   * Enable the multiple select mode.\n   * @param {!boolean} byIcon Whether to simulate a keyboard event.\n   */\n  enableMultiselect(byIcon = false) {\n    // Ensure that we only restore drag to move the workspace behavior\n    // when it is enabled.\n    if (!this.hasDisableWorkspaceDrag_ &&\n      this.workspace_.options.moveOptions &&\n      this.workspace_.options.moveOptions.drag) {\n      this.workspace_.options.moveOptions.drag = false;\n      this.hasDisableWorkspaceDrag_ = true;\n    }\n    this.dragSelect_ = new DragSelect({\n      // TODO: Find a way to capture/query all types of draggables\n      selectables: this.workspace_.getInjectionDiv()\n          .querySelectorAll('g.blocklyDraggable:not(.blocklyInsertionMarker)' +\n              '> path.blocklyPath' + ', g.blocklyDraggable ' +\n              '> rect.blocklyCommentHighlight'\n          ),\n      area: this.workspace_.svgGroup_,\n      multiselectMode: true,\n      draggability: false,\n      usePointerEvents: true,\n      multiSelectKeys: this.multiSelectKeys_,\n    });\n    // Filter out the parent block when selecting child blocks\n    // to mitigate the invisible rectangles issue.\n    const filterParent = (list, rect) => {\n      const toRemove = [];\n      for (const [parent, parentRect] of list.entries()) {\n        for (const [child, childRect] of list.entries()) {\n          if (parent === child ||\n            !DragSelect.isCollision(childRect, parentRect, 0) ||\n                  parent.parentNode === null || child.parentNode === null ||\n                  parent.parentNode === child.parentNode) continue;\n          else if (parent.parentNode.contains(child.parentNode) &&\n                  // Continue to select if user draws a rectangle that\n                  // covers more than the child itself\n                  DragSelect.isCollision(rect, childRect, 1)) {\n            toRemove.push(parent);\n            break;\n          }\n        }\n      }\n      return toRemove;\n    };\n    this.dragSelect_.Selection.filterSelected = (\n        {selectorRect, select: _select, unselect: _unselect}) => {\n      const select = _select; const unselect = _unselect;\n      const toRemove = filterParent(select, selectorRect);\n      toRemove.forEach((el) => {\n        const rect = select.get(el);\n        select.delete(el);\n        unselect.set(el, rect);\n      });\n      return {select, unselect};\n    };\n\n    this.dragSelect_.subscribe('elementselect', (info) => {\n      const element = info.item.parentElement;\n      if (inMultipleSelectionModeWeakMap.get(this.workspace_) &&\n          element && element.dataset && element.dataset.id) {\n        this.updateDraggables_(\n            getByID(this.workspace_, element.dataset.id));\n      }\n    });\n    this.dragSelect_.subscribe('elementunselect', (info) => {\n      const element = info.item.parentElement;\n      if (inMultipleSelectionModeWeakMap.get(this.workspace_) &&\n          element && element.dataset && element.dataset.id) {\n        this.updateDraggables_(\n            getByID(this.workspace_, element.dataset.id));\n      }\n    });\n    if (byIcon) {\n      document.dispatchEvent(\n          new KeyboardEvent('keydown', {'key': this.multiSelectKeys_[0]}));\n    }\n    this.updateMultiselectIcon(true);\n    inMultipleSelectionModeWeakMap.set(this.workspace_, true);\n  }\n\n  /**\n   * Disable the multiple select mode.\n   * @param {!boolean} byIcon Whether to simulate a keyboard event.\n   */\n  disableMultiselect(byIcon = false) {\n    inMultipleSelectionModeWeakMap.set(this.workspace_, false);\n    if (this.dragSelect_) {\n      if (byIcon) {\n        document.dispatchEvent(\n            new KeyboardEvent('keyup', {'key': this.multiSelectKeys_[0]}));\n      }\n      this.dragSelect_.stop();\n      this.dragSelect_ = null;\n    }\n    // Ensure that Blockly selects multidraggable if\n    // our set is not empty.\n    if (this.dragSelection.size && !Blockly.getSelected()) {\n      Blockly.common.setSelected(this.multiDraggable);\n    }\n    if (this.hasDisableWorkspaceDrag_) {\n      this.workspace_.options.moveOptions.drag = true;\n      this.hasDisableWorkspaceDrag_ = false;\n    }\n    this.updateMultiselectIcon(false);\n  }\n\n  /**\n   * Updates the multi select icon.\n   * @param {boolean} enable Whether the multi select is enabled.\n   */\n  updateMultiselectIcon(enable) {\n    if (!this.multiselectGroup_) {\n      return;\n    }\n    this.enabled = enable;\n    if (enable) {\n      this.multiselectGroup_.firstElementChild.setAttributeNS(\n          Blockly.utils.dom.XLINK_NS, 'xlink:href', this.enabled_img);\n    } else {\n      this.multiselectGroup_.firstElementChild.setAttributeNS(\n          Blockly.utils.dom.XLINK_NS, 'xlink:href', this.disabled_img);\n    }\n  }\n}\n\n/**\n * CSS for multi select controls.  See css.js for use.\n */\nBlockly.Css.register(`\n.blocklyMultiselect>image, .blocklyMultiselect>svg>image {\n  opacity: .4;\n}\n\n.blocklyMultiselect>image:hover, .blocklyMultiselect>svg>image:hover {\n  opacity: .6;\n}\n\n.blocklyMultiselect>image:active, .blocklyMultiselect>svg>image:active {\n  opacity: .8;\n}\n`);\n","/**\n * @license\n * Copyright 2022 MIT\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * @fileoverview Plugin main class.\n */\n\nimport * as Blockly from 'blockly/core';\n\nimport * as ContextMenu from './multiselect_contextmenu';\nimport * as Shortcut from './multiselect_shortcut';\nimport {\n  dragSelectionWeakMap, inMultipleSelectionModeWeakMap,\n  hasSelectedParent,\n  multiselectControlsList, multiDraggableWeakMap,\n} from './global';\nimport {MultiselectControls} from './multiselect_controls';\nimport {MultiselectDraggable} from './multiselect_draggable';\n\n/**\n * Class for using multiple select blocks on workspace.\n */\nexport class Multiselect {\n  /**\n   * Initialize the class data structure.\n   * @param {!Blockly.WorkspaceSvg} workspace The workspace to sit in.\n   */\n  constructor(workspace) {\n    this.workspace_ = workspace;\n    this.origHandleWsStart_ = Blockly.Gesture.prototype.handleWsStart;\n\n    dragSelectionWeakMap.set(this.workspace_, new Set());\n    multiDraggableWeakMap.set(this.workspace_,\n        new MultiselectDraggable(this.workspace_));\n    this.dragSelection_ = dragSelectionWeakMap.get(this.workspace_);\n    inMultipleSelectionModeWeakMap.set(this.workspace_, false);\n    this.useCopyPasteCrossTab_ = true;\n    this.useCopyPasteMenu_ = true;\n    this.multiFieldUpdate_ = true;\n    this.multiSelectKeys_ = ['shift'];\n    this.registeredShortcut_ = true;\n  }\n\n  /**\n   * Bind the events and replace registration.\n   * @param {Object} options\n   * to set.\n   */\n  init(options) {\n    if (options.multiSelectKeys && options.multiSelectKeys.length > 0) {\n      this.multiSelectKeys_ = options.multiSelectKeys.map((key) => {\n        return key.toLocaleLowerCase();\n      });\n    }\n    const injectionDiv = this.workspace_.getInjectionDiv();\n    this.onKeyDownWrapper_ = Blockly.browserEvents.conditionalBind(\n        injectionDiv, 'keydown', this, this.onKeyDown_);\n    this.onKeyUpWrapper_ = Blockly.browserEvents.conditionalBind(\n        injectionDiv, 'keyup', this, this.onKeyUp_);\n    this.onFocusOutWrapper_ = Blockly.browserEvents.conditionalBind(\n        injectionDiv, 'focusout', this, this.onBlur_);\n    injectionDiv.addEventListener('mouseenter', () => {\n      if (options.workspaceAutoFocus === false ||\n          document.activeElement === this.workspace_.svgGroup_.parentElement ||\n          document.activeElement.nodeName.toLowerCase() === 'input' ||\n          document.activeElement.nodeName.toLowerCase() === 'textarea') {\n        return;\n      }\n      this.workspace_.svgGroup_.parentElement.focus();\n    });\n    this.eventListenerWrapper_ = this.eventListener_.bind(this);\n    this.workspace_.addChangeListener(this.eventListenerWrapper_);\n\n    this.eventListenerAllWrapper_ = this.eventListenerAll_.bind(this);\n    Blockly.Workspace.getAll().forEach((ws) => {\n      ws.addChangeListener(this.eventListenerAllWrapper_);\n    });\n\n    if (options.multiselectCopyPaste &&\n        options.multiselectCopyPaste.crossTab === false) {\n      this.useCopyPasteCrossTab_ = false;\n    }\n\n    if (options.multiselectCopyPaste &&\n        options.multiselectCopyPaste.menu === false) {\n      this.useCopyPasteMenu_ = false;\n    }\n\n    if (!Blockly.ContextMenuRegistry.registry.getItem('workspaceSelectAll')) {\n      ContextMenu.unregisterContextMenu();\n      ContextMenu.registerOurContextMenu(this.useCopyPasteMenu_,\n          this.useCopyPasteCrossTab_);\n      Shortcut.unregisterOrigShortcut();\n      Shortcut.registerOurShortcut(this.useCopyPasteCrossTab_);\n    }\n\n    this.controls_ = new MultiselectControls(\n        this.workspace_, options.multiselectIcon, this.multiSelectKeys_);\n    multiselectControlsList.add(this.controls_);\n    if (!options.multiselectIcon || !options.multiselectIcon.hideIcon) {\n      const svgControls = this.controls_.createDom();\n      this.workspace_.getParentSvg().appendChild(svgControls);\n    }\n    this.controls_.init(options.multiselectIcon.hideIcon,\n        options.multiselectIcon.weight);\n\n    if (options.useDoubleClick) {\n      this.useDoubleClick_(true);\n    }\n\n    if (options.multiFieldUpdate === false) {\n      this.multiFieldUpdate_ = false;\n    }\n\n    if (!options.bumpNeighbours) {\n      this.origBumpNeighbours = Blockly.BlockSvg.prototype.bumpNeighbours;\n      Blockly.BlockSvg.prototype.bumpNeighbours = function() {};\n    }\n\n    Blockly.browserEvents.conditionalBind(\n        injectionDiv, 'keydown', this, this.unbindMultiselectCopyPaste_\n    );\n\n    // This is for the keyboard navigation plugin and checks whether it puts\n    // the workspace into keyboard accessibility mode by default.\n    if (this.workspace_.keyboardAccessibilityMode) {\n      Shortcut.unregisterOurShortcut();\n      this.registeredShortcut_ = false;\n    }\n  }\n\n  /**\n   * Ignore multi-field updates within the given function.\n   * @param {Function} func The function to call.\n   */\n  static withoutMultiFieldUpdates(func) {\n    const oldGroup = Blockly.Events.getGroup();\n    // Note that this depends on the fact that\n    // eventListener_ will ignore events with a group ID.\n    if (!oldGroup) {\n      Blockly.Events.setGroup(true);\n    }\n    try {\n      func();\n    } finally {\n      Blockly.Events.setGroup(oldGroup);\n    }\n  }\n\n  /**\n   * Update the multiselect icon in runtime.\n   * @param {string} enabledIcon The icon for enabled state.\n   * @param {string} disabledIcon The icon for disabled state.\n   */\n  setMultiselectIcon(enabledIcon, disabledIcon) {\n    if (!this.controls_) {\n      return;\n    }\n    this.controls_.enabled_img = enabledIcon;\n    this.controls_.disabled_img = disabledIcon;\n    this.controls_.updateMultiselectIcon(this.controls_.enabled);\n  }\n\n  /**\n   * Unbind the events and replace with original registration.\n   * @param {boolean} keepRegistry Keep the context menu and shortcut registry.\n   */\n  dispose(keepRegistry = false) {\n    if (this.onKeyDownWrapper_) {\n      Blockly.browserEvents.unbind(this.onKeyDownWrapper_);\n      this.onKeyDownWrapper_ = null;\n    }\n    if (this.onKeyUpWrapper_) {\n      Blockly.browserEvents.unbind(this.onKeyUpWrapper_);\n      this.onKeyUpWrapper_ = null;\n    }\n    if (this.onFocusOutWrapper_) {\n      Blockly.browserEvents.unbind(this.onFocusOutWrapper_);\n      this.onFocusOutWrapper_ = null;\n    }\n    if (this.eventListenerWrapper_) {\n      this.workspace_.removeChangeListener(this.eventListenerWrapper_);\n      this.eventListenerWrapper_ = null;\n    }\n    if (this.eventListenerAllWrapper_) {\n      Blockly.Workspace.getAll().forEach((ws) => {\n        ws.removeChangeListener(this.eventListenerAllWrapper_);\n      });\n      this.eventListenerAllWrapper_ = null;\n    }\n    if (!keepRegistry) {\n      ContextMenu.unregisterContextMenu();\n      if (this.useCopyPasteMenu_) {\n        Blockly.ContextMenuRegistry.registry.unregister('blockCopyToStorage');\n        Blockly.ContextMenuRegistry.registry\n            .unregister('blockPasteFromStorage');\n      }\n      Blockly.ContextMenuRegistry.registry.unregister('workspaceSelectAll');\n      Blockly.ContextMenuRegistry.registry.unregister('copy_to_backpack');\n      ContextMenu.registerOrigContextMenu();\n\n      Shortcut.unregisterOrigShortcut();\n      Blockly.ShortcutRegistry.registry.unregister('selectall');\n      Shortcut.registerOrigShortcut();\n    }\n\n    if (this.controls_) {\n      multiselectControlsList.delete(this.controls_);\n      this.controls_.dispose();\n      this.controls_ = null;\n    }\n\n    this.useDoubleClick_(false);\n\n    if (this.origBumpNeighbours) {\n      Blockly.BlockSvg.prototype.bumpNeighbours = this.origBumpNeighbours;\n    }\n  }\n\n  /**\n   * Add double click to expand/collapse blocks (MIT App Inventor Supported).\n   * @param {!boolean} on Whether to turn on the mode.\n   * @private\n   */\n  useDoubleClick_(on) {\n    if (!on) {\n      Blockly.Gesture.prototype.handleWsStart = this.origHandleWsStart_;\n      return;\n    }\n\n    Blockly.Gesture.prototype.handleWsStart = (function(func) {\n      if (func.isWrapped) {\n        return func;\n      }\n\n      const wrappedFunc = function(e, ws) {\n        func.call(this, e, ws);\n        if (this.targetBlock && e.buttons === 1 &&\n            !inMultipleSelectionModeWeakMap.get(ws)) {\n          const preCondition = function(block) {\n            return !block.isInFlyout && block.isMovable() &&\n                block.workspace.options.collapse;\n          };\n\n          const selected = Blockly.getSelected();\n          const maybeCollapse = function(block, blockState) {\n            if (block && preCondition(block) &&\n                !hasSelectedParent(block)) {\n              block.setCollapsed(blockState);\n            }\n          };\n          if (ws.doubleClickPid_) {\n            clearTimeout(ws.doubleClickPid_);\n            ws.doubleClickPid_ = undefined;\n            // Case where selected is a\n            // block (not a multidraggable)\n            if (selected && selected instanceof Blockly.BlockSvg &&\n                preCondition(selected)) {\n              if (selected.id === ws.doubleClickBlock_) {\n                const state = !selected.isCollapsed();\n                Blockly.Events.setGroup(true);\n                if (selected) {\n                  maybeCollapse(selected, state);\n                }\n                Blockly.Events.setGroup(false);\n                return;\n              }\n            } else if (selected && selected instanceof MultiselectDraggable) {\n              // Case where the selected is a multidraggable instance\n              const dragSelection = dragSelectionWeakMap.get(ws);\n              if (dragSelection.size) {\n                // Checking whether any of the blocks in\n                // the dragSelection is not collapsed.\n                // If there are not collapsed blocks,\n                // set the maybeCollapse function to collapse\n                // those uncollapsed blocks.\n                // Otherwise, uncollapse all the collapsed blocks.\n                let notCollapsed = 0;\n                dragSelection.forEach((id) => {\n                  if (ws.getBlockById(id)) {\n                    if (!ws.getBlockById(id).isCollapsed() &&\n                        !hasSelectedParent(ws.getBlockById(id))) {\n                      notCollapsed += 1;\n                    }\n                  }\n                });\n                let state = false;\n                if (notCollapsed > 0) {\n                  state = true;\n                }\n\n                Blockly.Events.setGroup(true);\n                dragSelection.forEach(function(id) {\n                  const block = ws.getBlockById(id);\n                  if (block) {\n                    maybeCollapse(block, state);\n                  }\n                });\n                Blockly.Events.setGroup(false);\n                return;\n              }\n            }\n          }\n          if (!ws.doubleClickPid_) {\n            ws.doubleClickBlock_ = selected.id;\n            ws.doubleClickPid_ = setTimeout(function() {\n              ws.doubleClickPid_ = undefined;\n            }, 500);\n          }\n        }\n      };\n      wrappedFunc.isWrapped = true;\n      return wrappedFunc;\n    })(Blockly.Gesture.prototype.handleWsStart);\n  }\n\n  /**\n   * Handle binded workspace events.\n   * @param {!Event} e Blockly event.\n   * @private\n   */\n  eventListener_(e) {\n    // on Block field changed\n    if (this.multiFieldUpdate_ &&\n        this.dragSelection_.has(e.blockId) &&\n        (e.type === Blockly.Events.CHANGE &&\n            e.element === 'field' && e.recordUndo && e.group === '' ||\n            e.type === Blockly.Events.BLOCK_FIELD_INTERMEDIATE_CHANGE)) {\n      const currentGroup = Blockly.Events.getGroup();\n      if (!currentGroup) {\n        Blockly.Events.setGroup(true);\n        e.group = Blockly.Events.getGroup();\n      }\n      try {\n        const blockType = this.workspace_.getBlockById(e.blockId).type;\n        // Update the fields to the same value for\n        // the selected blocks with same type.\n        this.dragSelection_.forEach((id) => {\n          if (id === e.blockId) {\n            return;\n          }\n          const block = this.workspace_.getBlockById(id);\n          if (block && block.type === blockType) {\n            block.setFieldValue(e.newValue, e.name);\n          }\n        });\n      } catch (err) {\n        // Avoid errors when changing a block if it is\n        // no longer in the workspace.\n        // https://github.com/mit-cml/workspace-multiselect/issues/33\n        console.warn(err);\n      } finally {\n        Blockly.Events.setGroup(currentGroup);\n      }\n    }\n  }\n\n  /**\n   * Handle all workspaces events.\n   * @param {!Event} e Blockly event.\n   * @private\n   */\n  eventListenerAll_(e) {\n    // on Block Selected (must listen events of all workspaces\n    // to cover all possible selection changes)\n    if (e.type === Blockly.Events.SELECTED) {\n      multiselectControlsList.forEach((controls) => {\n        controls.updateMultiselect();\n      });\n    }\n  }\n\n  /**\n   * Handle a key-down on the workspace.\n   * @param {KeyboardEvent} e The keyboard event.\n   * @private\n   */\n  onKeyDown_(e) {\n    if (this.multiSelectKeys_.indexOf(e.key.toLocaleLowerCase()) > -1 &&\n        !inMultipleSelectionModeWeakMap.get(this.workspace_)) {\n      this.controls_.enableMultiselect();\n    }\n  }\n\n  /**\n   * Handle a keyboard navigation key-down on the workspace.\n   * @param {KeyboardEvent} e The keyboard event.\n   * @private\n   */\n  unbindMultiselectCopyPaste_(e) {\n    // TODO: Update this to re-register/unregister the original shortcuts after\n    //  Blockly/keyboard navigation plugin update\n    // This is to unregister the multiselect plugin's shortcuts\n    // when the user is in the keyboard navigation mode. Currently,\n    // when the user is in keyboard accessibility mode, they cannot\n    // use the normal copy/cut/paste functionalities.\n    // This is because the original (Blockly core) copy/cut/paste\n    // functions do not allow for collisions. This can be fixed\n    // either by allowing for collisions in the Blockly core\n    // copy/cut/paste functions or allowing for unregister/re-registering\n    // of the keyboard navigation plugin's copy/cut/paste functions.\n    if (this.workspace_.keyboardAccessibilityMode &&\n        this.registeredShortcut_) {\n      Shortcut.unregisterOurShortcut();\n      this.registeredShortcut_ = false;\n    } else if (!this.workspace_.keyboardAccessibilityMode &&\n        !this.registeredShortcut_) {\n      Shortcut.registerOurShortcut();\n      this.registeredShortcut_ = true;\n    }\n  }\n\n  /**\n   * Handle a key-up on the workspace.\n   * @param {KeyboardEvent} e The keyboard event.\n   * @private\n   */\n  onKeyUp_(e) {\n    if (this.multiSelectKeys_.indexOf(e.key.toLocaleLowerCase()) > -1) {\n      this.controls_.disableMultiselect();\n    }\n  }\n\n  /**\n   * Handle a blur on the workspace.\n   * @param {Event} e The blur event.\n   * @private\n   */\n  onBlur_(e) {\n    if (inMultipleSelectionModeWeakMap.get(this.workspace_)) {\n      // Revert last unselected block if the related target\n      // is a field related element, for accomodating field update\n      // directly while the multi-selection mode is on.\n      if (e.relatedTarget && (e.relatedTarget.tagName === 'INPUT' ||\n          e.relatedTarget.tagName === 'TEXTAREA' ||\n          e.relatedTarget.tagName === 'DIV' &&\n          e.relatedTarget.classList.value.indexOf(\n              'blocklyDropdownMenu') > -1)) {\n        this.controls_.revertLastUnselectedBlock();\n      }\n      this.controls_.disableMultiselect();\n    }\n  }\n}\n"],"names":["root","factory","exports","module","require","define","amd","a","i","this","__WEBPACK_EXTERNAL_MODULE__370__","ownKeys","object","enumerableOnly","keys","Object","getOwnPropertySymbols","symbols","filter","sym","getOwnPropertyDescriptor","enumerable","push","apply","_objectSpread2","target","arguments","length","source","forEach","key","_defineProperty","getOwnPropertyDescriptors","defineProperties","defineProperty","_classCallCheck","instance","Constructor","TypeError","_defineProperties","props","descriptor","configurable","writable","_toPropertyKey","_createClass","protoProps","staticProps","prototype","obj","value","_inherits","subClass","superClass","create","constructor","_setPrototypeOf","_getPrototypeOf","o","setPrototypeOf","getPrototypeOf","bind","__proto__","p","_isNativeReflectConstruct","Reflect","construct","sham","Proxy","Boolean","valueOf","call","e","_construct","Parent","args","Class","Function","_wrapNativeSuper","_cache","Map","undefined","fn","toString","indexOf","has","get","set","Wrapper","_assertThisInitialized","self","ReferenceError","_createSuper","Derived","hasNativeReflectConstruct","result","Super","NewTarget","_possibleConstructorReturn","_get","property","receiver","base","hasOwnProperty","_superPropBase","desc","_slicedToArray","arr","Array","isArray","_arrayWithHoles","_i","Symbol","iterator","_s","_e","_x","_r","_arr","_n","_d","next","done","err","return","_iterableToArrayLimit","_unsupportedIterableToArray","_nonIterableRest","_toConsumableArray","_arrayLikeToArray","_arrayWithoutHoles","iter","from","_iterableToArray","_nonIterableSpread","minLen","n","slice","name","test","len","arr2","arg","input","hint","prim","toPrimitive","res","String","Number","_toPrimitive","calc","_ref","operator","_ref2","x1","x","y1","y","x2","y2","rect2vect","rect","left","top","vect2rect","vect","dimension","right","bottom","width","height","addModificationObservers","nodes","cb","callback","window","addEventListener","observer","MutationObserver","el","observe","childList","attributes","cleanup","removeModificationObservers","debounce","func","wait","timeout","_len","_key","clearTimeout","setTimeout","documentScroll","_document$body","_document$documentEle","_document$body2","_document$documentEle2","document","body","scrollTop","documentElement","scrollLeft","getAllParentNodes","node","traverse","toWatch","_toWatch$index","index","parent","parentNode","getBoundingClientRect","elements","SelectableSet","POSITIVE_INFINITY","NEGATIVE_INFINITY","toArray","element","elementRect","getRect","Math","min","max","getCurrentScroll","area","Document","getOverflowEdges","containerRect","_ref$tolerance","tolerance","edges","getComputedTranslatePositions","position","computed","getComputedStyle","transform","_match","trim","match","_match$","values","split","parseInt","_match$2","_values","getStylePosition","useTranslate","style","_match$3","_split$","getTranslatedPositions","getTopLeftPosition","handleElementPositionAttribute","computedStyle","wrongTypeWarn","type","fallback","console","warn","concat","hydrateHelper","withFallback","isAvailable","forceFallback","expectedString","expectedNumber","isNaN","expectedObject","expectedBoolean","expectedArray","isFallback","assign","Set","map","v","id","size","isCollision","el1","el2","percent","element1","widthPoint","heightPoint","moveElement","posDirection","useTransform","elementPos","newPos","setStylePosition","includes","handleElementOverflow","modificationObserver","removeEventListener","disconnect","prevTransform","replace","items","HTMLElement","SVGElement","updateElementStylePos","pos","Area","_this","DS","reset","_node","PubSub","publish","item","_observers","parentNodes","event","_computedStyle","_rect","_computedBorder","_parentNodes","directions","multiplier","data","scroll_directions","scroll_multiplier","docEl","_element","scrollBot","scrollHeight","scrollRight","scrollWidth","scrollElement","setArea","stores","SettingsStore","s","subscribe","settings","start","borderTopWidth","borderBottomWidth","borderLeftWidth","borderRightWidth","HTMLNode","zoom","innerWidth","innerHeight","clientWidth","clientHeight","getAreaRect","Drag","_dragKeys","up","dragKeys","k","toLowerCase","down","_dragKeysFlat","keyboardDrag","SelectedSet","draggability","publishData","isDragging","isDraggingKeyboard","_elements","getSelection","dragAsBlock","_selectionRect","handleZIndex","shiftKey","keyboardDragSpeed","scrollDiff","canScroll","scrollCallback","increase","handleKeyboardDragPosDifference","KeyStore","currentValues","scroll","_scrollDiff","ScrollStore","limitDirection","SelectorArea","_ref3","_ref4","_prevCursorPos","_prevScrollPos","evt","isKeyboard","_ref5","_cursorDiff","direction","scrollAmount","delta","add","zIndex","assignDragkeys","stop","update","keyboardEnd","currentPointerVal","PointerStore","currentVal","cursorDiff","currentScrollVal","DropZone","droppables","action","isDestroyed","selectedEls","classList","Settings","droppableClass","dropZoneReadyClass","_this$_itemsDropped","remove","droppedTargetClass","_itemsDropped","dropZoneTargetClass","_this$droppables","_this$_itemsDropped2","_this$_itemsDropped3","isAnyInside","itemsInside","droppedInsideClass","className","dropZoneInsideClass","setReadyClasses","handleItemsInsideClasses","itemsDropped","dropZoneClass","refreshMemoryRate","_this2","unsubscribe","_itemsInside","_this3","flatMap","rects","dropInsideThreshold","_timeout","_droppables","DropZones","dropZones","_zones","zone","destroy","_zoneByElement","_zoneById","droppable","zones","_zonesByDroppable","handleNoDrop","handleDrop","il","dropTargetThreshold","getTarget","_handleDrop","zoneId","addClasses","coordinates","_this$_zones","elementsFromPoint","_getZoneByElementsFromPoint","setDropZones","Interaction","usePointerEvents","passive","preventDefault","_canInteract","isInteracting","isDragEvent","clickedElement","closest","selectableClass","isMultiSelectKeyPressed","immediateDrag","clear","detail","_this$DS","_this$DS$stores","toggle","init","onClick","_ref6","_start","_init","_ref7","_reset","isKeyboardClick","clientX","clientY","button","isInside","isClicked","eventName","subscribers","splice","_publish","_handlePrePublish","_handlePublish","stopped","_Set","_super","selectables","_rects","_onClick","_onPointer","hoverClass","selectedClass","deleted","Selection","_storePrevious","_handleInsideSelection","force","_step","Selector","multiSelectionToggle","multiSelectToggling","selectionThreshold","elRects","selectorRect","select","unselect","_iterator","allowArrayLike","it","F","f","normalCompletion","didErr","step","_createForOfIteratorHelper","_step$value","_this$filterSelected","filterSelected","filteredSelect","filteredUnselect","_","hoverClassName","contains","handleSelection","PrevSelectedSet","inSelection","inPrevSelection","handleUnSelection","_prevSelectedSet","_this$DS2","_this$DS$SelectorArea","_this$DS$SelectorArea2","customStyles","selector","removeChild","createElement","background","border","display","pointerEvents","selectorClass","appendChild","pPos","initialValArea","initialPointerPos","pointerPos","selectorPos","getSelectorPosition","currentValArea","attachSelector","applyElements","updatePos","method","methodName","computedBorder","stopAutoScroll","currentEdges","_scrollInterval","setInterval","handleAutoScroll","overflowTolerance","autoScrollSpeed","clearInterval","overflow","selectorAreaClass","startAutoScroll","initialVal","getPointerPosition","control","shift","meta","keydown","keyup","_currentValues","multiSelectMode","multiSelectKeys","toLocaleLowerCase","some","_keyMapping","getPointerPos","_normalizedEvent","_isMouseInteraction","lastVal","_lastTouch","touches","_initialValArea","_currentValArea","_lastValArea","_initialVal","_currentVal","_lastVal","_canScroll","zoomScroll","_settings2","_settings","hydrateSettings","_loop","_settings4","_Object$entries$_i","_Object$entries","newValue","entries","_update","DragSelect","lastValArea","_this$DropZones$getTa","toObject","getItemsDroppedById","getItemsInsideById","mapping","condition","extraData","dropTarget","sub_name","pubs","filler","pub","subscriberAliases","fromSelection","triggerCallback","dontAddToSelectables","addAll","addSelectables","removeFromSelectables","deleteAll","removeSelectables","removeSelection","addSelection","clearSelection","addToSelection","els","removeFromSelection","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","__webpack_modules__","getter","__esModule","d","definition","prop","r","toStringTag","multiDraggableWeakMap","WeakMap","dragSelectionWeakMap","inMultipleSelectionModeWeakMap","multiselectControlsList","copyData","inPasteShortcut","connectionDBList","registeredContextMenu","registeredShortcut","timestamp","shortcutNames","freeze","MULTIDELETE","MULTICOPY","MULTICUT","MULTIPASTE","hasSelectedParent","block","move","getParent","getSurroundParent","workspace","getByID","getBlockById","getCommentById","dataCopyToStorage","storage","Date","now","localStorage","setItem","JSON","stringify","dataCopyFromStorage","parse","getItem","connection","time","blockNumGetFromStorage","useCopyPasteCrossTab","MultiselectDraggable","idGenerator","genUid","subDraggables","topSubDraggables","loc","Coordinate","dragSelection","clearAll_","subDraggable","removeSubDraggable_","addSubDraggable_","addPointerDownEventListener_","getRelativeToSurfaceXY","removePointerDownEventListener_","delete","handler","pointerDownEventHandler_","pointerDownHandler","getSvgRoot","setSelected","isMovable","startDrag","inGroup","getGroup","setGroup","draggable","isShadow","parentBlock","getNextBlock","nextConnection","previousConnection","drag","newLoc","sum","endDrag","connectionDB","connect","revertDrag","isDeletable","dispose","setDeleteStyle","enable","getBoundingRectangle","Rect","Infinity","coord","boundingBox","toFlyoutInfo","flyoutList","draggableFlyoutInfo","registerDuplicate","duplicateOption","displayText","scope","workableBlocksLength","check","preconditionFn","isInFlyout","isDuplicatable","duplicatedBlocks","multiDraggable","newId","blockCopyData","toCopyData","blockState","paste","origBlock","origParentBlock","scopeType","ScopeType","BLOCK","weight","registry","unregister","register","registerBlockComment","commentOption","state","hasIcon","CommentIcon","TYPE","userAgent","IE","options","comments","isCollapsed","isEditable","hasCommentIcon","setCommentText","registerInline","inlineOption","getInputsInline","inputList","inputTypes","STATEMENT","setInputsInline","registerCollapseExpandBlock","collapseExpandOption","collapse","setCollapsed","registerDisable","disableOption","isEnabled","disable","getInheritedDisabled","setEnabled","registerDelete","deleteOption","descendantCount","getDescendants","subBlocks","nextBlock","isFlyout","hideChaff","outputConnection","selected","getSelected","registerCommentDelete","count","comment","RenderedWorkspaceComment","COMMENT","registerCommentDuplicate","duplicatedComments","commentCopyData","commentState","unregisterContextMenu","registerShortcutDelete","deleteShortcut","readOnly","inProgress","getRegistry","addKeyMapping","KeyCodes","DELETE","BACKSPACE","copyShortcut","blockList","ctrlC","createSerializedKey","C","CTRL","altC","ALT","metaC","META","registerCut","cutShortcut","elementList","ctrlX","X","altX","metaX","pasteShortcut","stringData","targetWorkspace","typeCounts","isCapacityAvailable","ctrlV","V","altV","metaV","unregisterOrigShortcut","names","COPY","CUT","PASTE","unregisterOurShortcut","registerOurShortcut","ListNoParameter","selectAllShortcut","getTopBlocks","b","isInsertionMarker","ctrlA","A","altA","metaA","MultiselectControls","enabled_img","disabled_img","workspace_","enabled","multiSelectKeys_","onMultiselectWrapper_","multiselectGroup_","initialized_","hasDisableWorkspaceDrag_","justUnselectedBlock_","lastSelectedElement_","enabledIcon","disabledIcon","origHandleBlockStart","handleBlockStart","createDom","svgGroup_","dom","createSvgElement","Svg","G","createMultiselectSvg_","hideIcon","weightValue","getComponentManager","addComponent","component","capabilities","Capability","POSITIONABLE","resize","disableMultiselect","removeComponent","removeNode","unbind","top_","left_","metrics","savedPositions","cornerPosition","getCornerOppositeToolbox","startRect","getStartPositionRect","Size","bumpDirection","vertical","verticalPosition","TOP","DOWN","UP","positionRect","bumpPositionRect","setAttribute","revertLastUnselectedBlock","updateDraggables_","IMAGE","setAttributeNS","XLINK_NS","conditionalBind","switchMultiselect_","markFocused","enableMultiselect","clearTouchIdentifier","stopPropagation","pathObject","updateSelected","bringToFront","updateMultiselect","byIcon","moveOptions","dragSelect_","getInjectionDiv","querySelectorAll","multiselectMode","_select","_unselect","list","toRemove","parentRect","child","childRect","filterParent","info","parentElement","dataset","dispatchEvent","KeyboardEvent","updateMultiselectIcon","firstElementChild","Multiselect","origHandleWsStart_","handleWsStart","dragSelection_","useCopyPasteCrossTab_","useCopyPasteMenu_","multiFieldUpdate_","registeredShortcut_","injectionDiv","onKeyDownWrapper_","onKeyDown_","onKeyUpWrapper_","onKeyUp_","onFocusOutWrapper_","onBlur_","workspaceAutoFocus","activeElement","nodeName","focus","eventListenerWrapper_","eventListener_","addChangeListener","eventListenerAllWrapper_","eventListenerAll_","getAll","ws","multiselectCopyPaste","crossTab","menu","useCopyPasteMenu","copyOptions","registerCopy","pasteOption","workableDraggableLength","WORKSPACE","registerPaste","workableCommentsLength","comm","registerCommentCopy","blockDuplicate","blockComment","blockInline","blockCollapseExpand","blockDisable","blockDelete","commentDelete","commentDuplicate","selectAllOption","registerSelectAll","disablePreconditionContainsCheck","copyToBackpack","getBackPack","getComponent","backpack","containsBlock","backpackCount","getCount","addBlock","updateToMultiCopyToBackpack","controls_","multiselectIcon","svgControls","getParentSvg","useDoubleClick","useDoubleClick_","multiFieldUpdate","bumpNeighbours","origBumpNeighbours","unbindMultiselectCopyPaste_","keyboardAccessibilityMode","withoutMultiFieldUpdates","oldGroup","setMultiselectIcon","keepRegistry","removeChangeListener","registerComment","on","isWrapped","wrappedFunc","targetBlock","buttons","preCondition","maybeCollapse","doubleClickPid_","doubleClickBlock_","notCollapsed","blockId","CHANGE","recordUndo","group","BLOCK_FIELD_INTERMEDIATE_CHANGE","currentGroup","blockType","setFieldValue","SELECTED","controls","relatedTarget","tagName"],"sourceRoot":""}